!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Eventics=e()}}(function(){return function a(o,s,c){function l(n,e){if(!s[n]){if(!o[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(d)return d(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var r=s[n]={exports:{}};o[n][0].call(r.exports,function(e){return l(o[n][1][e]||e)},r,r.exports,a,o,s,c)}return s[n].exports}for(var d="function"==typeof require&&require,e=0;e<c.length;e++)l(c[e]);return l}({1:[function(e,n,t){n.exports=function(n){var r,a=["ironBeastEventicsProvider"],o=[],s={},c={},t=this,l=[],e=(n=n||1,"undefined"!=typeof jQuery?jQuery:{}),i=void 0!==window.angular?window.angular:{};function d(e){for(var n=o.length,t=0;t<n;t++)e(o[t])}function u(e){t.extend(c||{},e)}return t.extend=e.extend||i.extend||function(){for(var e,n,t=arguments.length,i=1,r=arguments[0]||{};i<t;i++)if(null!=(e=arguments[i]))for(n in e)void 0!==e[n]&&(r[n]=e[n]);return r},t.trackEvent=function(n,t,i){n&&(i=extend(i||{},c),r?d(function(e){e.trackEvent(n,t,i)}):l.push({eName:n,label:t,data:i,eType:"event"}))},t.trackTiming=function(n,t,i){n&&0<=parseInt(t)&&(i=extend(i||{},c),r?d(function(e){e.trackTiming(n,t,i)}):l.push({eName:n,time:t,data:i,eType:"timing"}))},{setProvidersHandlers:function(e){if(e){"string"==typeof e&&(e=[e]),a=[];for(var n=e.length,t=0;t<n;t++)a.push(e[t])}},setProvidersConfig:function(e){s=e},init:function(e){r||(e&&u(e),function(){o=[];for(var e=a.length,n=0;n<e;n++){var t=a[n];if("function"==typeof window[t]){var i=new window[t];i.init(s),o.push(i)}}}(),r=!0,function(){for(var e in l){var n=l[e]||{};"event"===n.eType?t.trackEvent(n.eName,n.label,n.data):"timing"===n.eType&&t.trackTiming(n.eName,n.time,n.data)}l=[]}())},updateBaseData:u,createEventic:function(e){return(e=e||{}).userChance=n,new f(t,e)},updateUserChance:function(e){n=e}}};var f=e("./eventicsHelper.js");window.ironBeastEventicsProvider=e("./providers/ironBeastEventicsProvider.js"),window.QAEventicsProvider=e("./providers/QAEventicsProvider.js"),window.KuduEventicsProvider=e("./providers/KuduEventicsProvider.js")},{"./eventicsHelper.js":2,"./providers/KuduEventicsProvider.js":3,"./providers/QAEventicsProvider.js":4,"./providers/ironBeastEventicsProvider.js":5}],2:[function(e,n,t){n.exports=function(e,n){var t=void 0!==(n=n||{}).productChance?n.productChance:1,i=void 0!==n.userChance?n.userChance:1,s=e||{},c=n.baseData||{},l={},d=s.extend,r={};function u(e){return e&&e.name&&e.id}return r.trackEvent=function(e,n,t){if(!u(e))return!1;var i=e.name,r=e.id;t||(t={}),t.eventId=r,t=d({},c,t||{}),s.trackEvent(i,n,t)},r.trackTimingStart=function(e,n){if(!u(e))return!1;var t=e.name;return n=n||Date.now(),l[t]=n,!0},r.trackTimingStop=function(e,n){if(!u(e))return!1;var t,i,r=e.name;if(n||(n={}),n.eventId=e.id,n&&n.timeStamp?(i=n.timeStamp,delete n.timeStamp):i=Date.now(),n&&n.eNameStart&&n.eNameStart.name?(t=l[n.eNameStart.name],delete n.eNameStart):l[r]&&(t=l[r],l[r]=null),t){var a=i-t,o=d({},c);return n=d(o,n||{}),s.trackTiming(r,a,n),!0}},r.updateBaseData=function(e){for(var n in e)c[n]=e[n];return!0},r.resetBaseData=function(e){for(var n=0;n<e.length;n++)r.unsetParamFromBaseData(e[n])},r.unsetParamFromBaseData=function(e){c.hasOwnProperty(e)&&delete c[e]},r.incrementSessionNumber=function(){return c.sessionDepth?c.sessionDepth++:c.sessionDepth=1,!0},0<i&&i<=t?r:function(){var e={};for(var n in r)"function"==typeof r[n]&&(e[n]=function(){});return e}()}},{}],3:[function(e,n,t){n.exports=function(){var t,i,r="https://logs.supersonic.com/logs",a={table:"supersonic.adunitanalytics.ad_unit_events"},o=["generalmessage","emptyowreason","landingid"];function s(e,n){switch(e){case"landingid":n=parseInt(n);break;case"generalmessage":case"emptyowreason":n=t=void 0===(t=n)?"undefined":null===t?"null":t.toString()}var t;return n}function c(e){if(e){e=function(e){if(!e)return e;for(var n=Object.keys(e),t=n.length;t--;){var i=n[t],r=i.toLowerCase(),a=e[i];-1!==o.indexOf(r)&&(a=s(r,a)),e[r]=a,i!==r&&delete e[i]}return e}(e);var n={table:a.table,data:e};i(n)}}function n(e){var n=new XMLHttpRequest;n.open("POST",t,!0),n.onerror=function(){e&&0<=e.retry&&e.retry<2&&(e.retry++,i(e))},n.send(JSON.stringify(e))}function l(n){var t;try{t=btoa(JSON.stringify(n))}catch(e){n.data.applicationUserId="badName",n.data.userId="badName",n.data.eventName="errorEvent",t=btoa(JSON.stringify(n))}var e=r+"?data="+t,i=new XMLHttpRequest;i.open("GET",e,!0),i.send()}return{init:function(e){i=e&&"POST"===e.method?(t="https://postlog.supersonic.com/logs",n):(t=r,l)},trackEvent:function(e,n,t){if(e){if(n&&"object"==typeof n){var i=Object.keys(n)[0];i&&(t[i]=n[i])}t.eventName=e,c(t)}},trackTiming:function(e,n,t){e&&0<=parseInt(n)&&(t.eventName=e,t.timingValue=n,c(t))}}}},{}],4:[function(e,n,t){n.exports=function(){var i,r={};function a(e){if(e){r.data=e;var n=function e(n,t){var i=[];for(var r in n)if(n.hasOwnProperty(r)){var a=t?t+"["+r+"]":r,o=n[r];i.push("object"==typeof o?e(o,a):encodeURIComponent(a)+"="+encodeURIComponent(o))}return i.join("&")}(r);delete r.data,(t=i+"?"+n)&&((new Image).src=t)}var t}return{init:function(e){i="http://qa.eventics.qa"},trackEvent:function(e,n,t){if(e){if(n&&"object"==typeof n){var i=Object.keys(n)[0];i&&(t[i]=n[i])}t.eventName=e,a(t)}},trackTiming:function(e,n,t){e&&0<=parseInt(n)&&(t.eventName=e,t.timingValue=n,a(t))}}}},{}],5:[function(e,n,t){n.exports=function(){var i,r={table:"supersonic.adunitanalytics.ad_unit_events"};function a(e){if(e){var n;r.data=e;try{n=btoa(JSON.stringify(r))}catch(e){r.data.applicationUserId="badName",r.data.userId="badName",r.data.eventName="errorEvent",n=btoa(JSON.stringify(r))}delete r.data,(t=i+"?data="+n)&&((new Image).src=t)}var t}return{init:function(e){i=e.isSecured?"https://secure.ironbeast.io":"http://supersonic.ironbeast.io"},trackEvent:function(e,n,t){if(e){if(n&&"object"==typeof n){var i=Object.keys(n)[0];i&&(t[i]=n[i])}t.eventName=e,a(t)}},trackTiming:function(e,n,t){e&&0<=parseInt(n)&&(t.eventName=e,t.timingValue=n,a(t))}}}},{}]},{},[1])(1)}),function a(o,s,c){function l(n,e){if(!s[n]){if(!o[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(d)return d(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var r=s[n]={exports:{}};o[n][0].call(r.exports,function(e){return l(o[n][1][e]||e)},r,r.exports,a,o,s,c)}return s[n].exports}for(var d="function"==typeof require&&require,e=0;e<c.length;e++)l(c[e]);return l}({1:[function(e,n,t){n.exports=function(e){var n={v:1,controllerId:1,applicationKey:1,applicationUserId:0,debug:0,language:0,disableCache:0,applicationUserGender:0,applicationUserAgeGroup:0,demoCampaigns:0,appOrientation:1,mobileCarrier:0,connectionType:1,iphoneAppOnIpadDevice:0,deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceOEM:0,deviceVolume:0,immersiveMode:0,"deviceIds[IFA]":0,"deviceIds[IDFV]":0,"deviceIds[SERIAL]":0,"deviceIds[AndroidID]":0,"deviceIds[IMEI]":0,"deviceIds[AID]":0,displaySizeWidth:0,displaySizeHeight:0,deviceWidthDP:0,deviceHeightDP:0,deviceScreenScale:0,deviceLanguage:0,deviceModel:0,diskFreeSize:1,country:0,campaignId:0,customParams:0,isLimitAdTrackingEnabled:0,SDKPluginType:0,bundleId:0,jb:0,gpi:0,allowArbitraryLoads:0,allowArbitraryLoadsInWebContent:0,mcc:0,mnc:0,appVersion:0,batteryLevel:0,maxVideoLength:0,itemName:0,itemCount:0,timestamp:0,localTime:0,timezoneOffset:0,itemSignature:0,showDeliveryLimitationsLog:0,minimumOfferCommission:0,minimumOfferCommissionSignature:0,applicationUserCreationDate:0,applicationUserCreationDateSignature:0,mraid:0,numOfCampaigns:0,androidIsVersion:0,cdnCn:0,sdkAbName:0,segmentId:0,segmentName:0,consent:0,moatSupported:0,omidSupported:0,omidVersion:0,omidPartnerVersion:0};return{init:function(){"android"===e.getConfig().mobileSDKSettings.deviceOs&&(n.deviceApiLevel=0)},getCommonRequiredData:function(){return n}}}},{}],2:[function(e,n,t){n.exports=function(c,l,d){var u=l.appInfo.orientation.portrait,f=l.appInfo.orientation.landscape,g={android:function(e,n,t){return e.ext.forceOrientation.toLowerCase()},ios:function(e,n,t){return i=e,r=n.getABTestConfiguration(i.productType,i.ext.landingId).ignoreAppOrientationInForceCampaigns||!1,c.log("shouldIgnoreAppOrientationInForcedCampaign: "+Boolean(r),c.LogLevels.verbose),!r&&d.getOrientation()&&d.isAppOrientation(e.ext.forceOrientation.toLowerCase())?(c.log("forced campaign | application is locked on the same orientation - sending  default: "+t,c.LogLevels.verbose),t):e.ext.forceOrientation.toLowerCase();var i,r}};function p(e){return e&&e.controllerConfig&&("499b4845"===e.controllerConfig.applicationKey||"406ff65d"===e.controllerConfig.applicationKey)}return{getAdDisplayOrientation:function(e,n,t){if(t){var i,r,a,o="undefined",s=l.defaultOrientation[t.productType];return p(e)&&t.settings&&(t.settings.orientation=u),r=e,(a=t).ext&&a.ext.forceOrientation&&(!p(r)||p(r)&&a.ext.forceOrientation.toLowerCase()===f)?o=s=g[e.mobileSDKSettings.deviceOs](t,n,s):s=(i=t).settings&&i.settings.orientation?t.settings.orientation:d.getOrientation(),s.toLowerCase()===l.appInfo.orientation.none&&(s=l.defaultOrientation[t.productType]),c.log("adOrientation | forceByCampaign:"+o+" , forceBySession:"+t.settings.orientation+" ,forceByNative:"+d.getOrientation()+" , ChosenOrientation:"+s,c.LogLevels.info),s.toLowerCase()}}}}},{}],3:[function(e,n,t){n.exports=function(o,s,r){var t=e("../components/Constants.js"),c="MRAID",l="VAST",d="EXTERNAL",u="INTERNAL",f="PLAYABLE",g="HYBRID",p="IMAGE_INTERSTITIAL",v="STATIC_BANNER",m="OTHER",i={};function a(e){if(e)return e.id||S(e,b(e),h(e)),e.id&&e.id.toString()}function b(e){if(e){var n=e.crid||e.bannerId||e.bannerID;return n&&n.toString()}}function h(e){if(e){var n=e.creativeId||"0";return n&&n.toString()}}function S(e,n,t){e.id=n+"_"+t}function y(e,n){if(!e)return"";var t=C(e,n);return i[t]||i.other}i[c]="MR",i[l]="VA",i[d]="EX",i[u]="AT",i[f]="PL",i[g]="HY",i[p]="IM",i[v]="SB",i[m]="OT";var C=function(e,n){var t,i,r=e&&e.ext,a="";return r?a=(i=r)&&i.type&&"imageInterstitial"===i.type?p:o.VastUtils.isVastCampaign(e)?l:s.HybridService.isHybridCampaign(e,n)?g:A(r)?f:D(r)?c:I(r)?d:w(r)?u:(t=r)&&t.type&&"staticBanner"===t.type?v:m:a};function A(e){return e&&e.type&&"playableAd"===e.type}function D(e){return e&&e.type&&"MRAID"===e.type}function I(e){return e&&e.videoData&&e.videoData.videoType&&"ssa-external-video-player"===e.videoData.videoType}function w(e){return e&&e.videoData&&e.videoData.videoType&&"ssa-internal-video-player"===e.videoData.videoType}function P(e){var n={};return n.id=a(e),n.title="",n.credits=e.credits,n.staticContent=o.AdAssets.extractStaticFiles(e,L(e)),n.lastUpdateTime=e.lastUpdateTime,n.inventoryIndex=e.inventoryIndex,n.isCacheable=e.isCacheable=0<n.staticContent.length,n}function L(e){var n=e.ext;return A(n)&&n.videoData&&n.videoData.videoSource&&n.videoData.videoSource.html&&-1<n.videoData.videoSource.html.indexOf(o.AdAssets.getPlayableCacheFlag())}function T(e){var n=s.getApiData({deviceOs:1}).deviceOs;e.standaloneView=n===t.deviceOs.ios,e.translucentView=n===t.deviceOs.android}function O(e,n){var t={};return n&&n.ext&&n.ext.opportunityID&&(t.opportunityId=n.ext.opportunityID),e&&e.requestID&&(t.requestId=e.requestID),t}return{getAdId:a,getBannerId:b,getCreativeId:h,getAdType:y,formatParamsToAdId:function(e){if(e){if(!e.id){var n=b(e);n&&S(e,n,t.legacyCreativeId)}return e}},formatAdsForPrecache:function(e){var i=[];return r.each(e,function(e,n){var t=P(n);t.isCacheable&&i.push(t)}),i},isCacheableAd:function(e){return e&&e.isCacheable},getStoreAppId:function(e){if(e.ext.clickTags.storeAppId)return e.ext.clickTags.storeAppId;var n,t="",i=e.ext.clickTags.clickURL;return i&&((n=i.match(/id\d+/g))&&(n=(n=(n=n[n.length-1]).match(/\d+/g))[0]),t=n)&&(e.ext.clickTags.storeAppId=t),t},formatVastAdForPrecache:function(e,n){var t;return(t=P(e)).preProcessing=n,t.isCacheable=e.isCacheable=!0,t},setViewType:function(e,n,t){var i;n&&n.ext&&(i=n.ext)&&i.layoutData&&(i.layoutData.portrait&&i.layoutData.portrait.frameUrl&&i.layoutData.portrait.closeButtonUrl||i.layoutData.landscape&&i.layoutData.landscape.frameUrl&&i.layoutData.landscape.closeButtonUrl)&&T(e),t&&(e.viewType=t)},getViewType:function(e){return e&&e.settings?e.settings.viewType:null},getRequestOppParams:O,updateEventWithAdParams:function(e,n,t){return n&&(r.extend(t,O(e,n)),t.bannerId=b(n),t.creativeId=h(n),t.campaignType=y(n,e)),t},isPlayableCampaign:A,isPlayablePrecachedAd:L,isInternalCampaign:w,isMRAIDCampaign:D,isExternalCampaign:I,isCampaignShouldStartMuted:function(e,n){return!(!e||!e[t.sspProductNames[n]]||!0!==e[t.sspProductNames[n]].startVideoOnMute)},extendAdObjectWithConfig:function(e,n,t,i){n.settings=r.extend(!0,n.settings,i),n.ext&&n.ext.forceOrientation&&(n.settings.orientation=n.ext.forceOrientation.toLowerCase()),r.extend(!0,n,t,{url:e})},extendSettingsWithStandaloneViewSupport:T,getIntegrationType:function(e){if(e&&e.productType){var n=s[e.productType];if(e.demandSourceName&&n)return n[e.demandSourceName].getIntegrationType()}return null}}}},{"../components/Constants.js":9}],4:[function(n,e,t){e.exports=function(t,r,e){var a=n("./NativeLifeCycleEventsConstants.js"),o=r.jQuery(),s={};function c(e){r.log("AndroidLifeCycleEventHandlers | handleOnDestroy:",r.LogLevels.verbose);var n={};e&&(n.eventParams=e),t.PubSub.publish(a.serviceCallback+"."+a.AndroidEvents.onDestroy,[n])}return{publishEvent:function(e,n){var t,i;r.log("AndroidLifeCycleEventHandlers | _handleEvent:",r.LogLevels.verbose),s[a.AndroidEvents.onDestroy]=c,t=e,i=Object.keys(s),r.log("AndroidLifeCycleEventHandlers | _isEventSupported: "+t+" supportedEvents: "+i,r.LogLevels.verbose),t&&-1<o.inArray(t,i)&&s[e](n)}}}},{"./NativeLifeCycleEventsConstants.js":30}],5:[function(e,n,t){n.exports={eventicsCategories:{nomediaFileDownloadFail:{name:"nomediaFileDownloadFail",id:210},nomediaFileDownloadSuccess:{name:"nomediaFileDownloadSuccess",id:211}},noMediaFileUrl:"/users/android/.nomedia",logMessage:{tag:"AndroidNomediaFileHandler | ",fileInCache:"nomedia file already in cache",saveFileToCache:"save nomedia file to cache"},errorMessage:{fileAlreadyExist:"file_already_exist"}}},{}],6:[function(e,n,t){n.exports=function(r){var a,o=e("./AndroidNomediaFileConstants.js"),s=o.noMediaFileUrl;return{init:function(e){a=e},updateNomediaFileToCache:function(){var e,n=r.getConfig(),t=r.Cache.getRootCacheStructure(),i=(e=n).mobileSDKSettings.protocol+"//"+e.mobileSDKSettings.cdn+s;t&&-1!==r.Cache.getFileIndexInCache(t.cache,i)?r.log(o.logMessage.tag+o.logMessage.fileInCache):(r.log(o.logMessage.tag+o.logMessage.saveFileToCache),r.saveFileToCache("./",i).then(function(){a.trackEvent(o.eventicsCategories.nomediaFileDownloadSuccess)},function(e){e!==o.errorMessage.fileAlreadyExist&&a.trackEvent(o.eventicsCategories.nomediaFileDownloadFail,{generalMessage:e})}))}}}},{"./AndroidNomediaFileConstants.js":5}],7:[function(e,n,t){n.exports=function(n){var r={},t=!1;function a(e,n){var t=r[e],i=[];return t&&t[n]?i=t[n]:t[n]=i,i}return{init:function(e){t||(r[n.RV]={},r[n.IS]={},r[n.BN]={},t=!0)},addToBlacklistedCampaigns:function(e,n,t){if(e&&n&&t){var i=a(e,n);i&&-1===i.indexOf(t)&&i.push(t)}},getBlacklistedCampaigns:function(e,n){var t=[];return e&&n&&(t=a(e,n)),t},isEmpty:function(e,n){var t=a(e,n);return!t||0===t.length}}}},{}],8:[function(e,n,t){n.exports=function(l,u){var t,f,d="NativeCallback",i={deviceOs:1,"deviceIds[IFA]":0,"deviceIds[AID]":0},g=1500,p=l.Utils;function n(e){var n,t,i,r=new jQuery.Deferred,a="checkInstalledAppsSuccess",o="checkInstalledAppsFailed",s={appIds:e,requestId:Date.now().toString()},c=function(){l.PubSub.unsubscribe(n),l.PubSub.unsubscribe(t)};return n=l.PubSub.subscribe(d+"."+a,function(e){e.requestId===s.requestId&&(clearTimeout(i),c(),u.log("successfully check apps installed "+JSON.stringify(e.result),u.LogLevels.info),r.resolve(e.result))}),t=l.PubSub.subscribe(d+"."+o,function(e){clearTimeout(i),c(),u.log("failed to check apps installed."+JSON.stringify(e),u.LogLevels.info),r.reject()}),i=setTimeout(function(){c(),r.reject("SDK check apps installed timeout request")},g),u.callSDKFunction("checkInstalledApps",s,a,o),r.promise()}function o(e){var a={deviceId:"ios"===(t=u.getApiData(i)).deviceOs?t["deviceIds[IFA]"]:t["deviceIds[AID]"],os:t.deviceOs,campaignIds:{}},n=f.urlPaths&&f.urlPaths.campaignsStatus;n?(jQuery.each(e,function(e,n){var t,i,r;a.campaignIds[n.campaignId]=(t=n.isInstalled,r=t?(i=50,100):(i=0,50),Math.floor(Math.random()*(r-i))+i)}),jQuery.ajax({url:n,data:a,type:"GET",dataType:"jsonp",success:function(e){u.log("Success update campaigns status to server",u.LogLevels.verbose)},error:function(e,n){u.log("Success update campaigns status to server: response:"+e+".status: "+n,u.LogLevels.verbose)}})):u.log("No url in settings to update server on campaigns status",u.LogLevels.verbose)}function v(e,n){var t=!0;return e||(u.log("filter apps installed flag is false",u.LogLevels.verbose),t=!1),n&&0!==n.length||(u.log("get 0 campaigns to filter",u.LogLevels.verbose),t=!1),u.isLegacy({ios:"5.14",android:"5.16"})&&(u.log("NewController: Old controller version. filter campaigns by app installed is not supported in this version of SDK.",u.LogLevels.verbose),t=!1),t}function m(i,r,e){var a=new jQuery.Deferred;return jQuery.isEmptyObject(r)?a.resolve():n(e).then(function(e){jQuery.each(e,function(e,n){var t=r[e];t&&(n.bannerIds=t)});var o,n,s,t=(o=i,n=e,s=[],jQuery.each(n,function(e,n){if(n.isInstalled){for(var t=[],i=0;i<o.length;i++){var r=u.AdUtils.getAdId(o[i]);n.bannerIds&&-1===n.bannerIds.indexOf(r)?t.push(o[i]):s.push(o[i])}for(var a=o.length=0;a<t.length;a++)o.push(t[a])}}),u.log("Campaigns after filtering: "+JSON.stringify(o),u.LogLevels.verbose),{newCampaigns:o,installedCampaigns:s});return i=t.newCampaigns,a.resolve(t.installedCampaigns),e}).then(o).fail(function(e){u.log("failed filter campaigns by app installed. "+e,u.LogLevels.verbose),a.resolve()}),a.promise()}function r(e,n,t){if(t=t||[],!v((f=n).filterAppsInstalled,e))return p.returnResolvedPromise();for(var i={},r=e.length,a=[],o=0;o<r;o++){var s=e[o],c=u.AdUtils.getAdId(s),l=s&&s.ext,d=l&&l.appData;l&&d&&d.appId&&(0===t.length||-1===t.indexOf(l.type))&&(i[d.appId]||(i[d.appId]=[]),i[d.appId].push(c),-1===a.indexOf(d.appId)&&a.push(d.appId))}return m(e,i,a)}function a(e,n){if(f=n,!v(!0,e))return p.returnResolvedPromise();for(var t={},i=e.length,r=[],a=0;a<i;a++){var o=e[a],s=u.AdUtils.getAdId(o),c=o.appData;c&&c.filterIfInstalled&&c.appId&&(t[c.appId]||(t[c.appId]=[]),t[c.appId].push(s),-1===r.indexOf(c.appId)&&r.push(c.appId))}return m(e,t,r)}return{factory:function(e){return t=u.getApiData(i),"RewardedVideo"===e||"BrandConnect"===e||"Interstitial"===e||"Banner"===e?{filterByAppInstalled:r}:"OfferWall"===e?{filterByAppInstalled:a}:"Controller"===e?{checkIfAppInstallOnDevice:n}:void 0}}}},{}],9:[function(e,n,t){var i=e("../constants/featureCompatibilityMap");n.exports={CB:"NativeCallback",WebControls:"WebControls",BC:"BrandConnect",RV:"RewardedVideo",OW:"OfferWall",IS:"Interstitial",BN:"Banner",RIS:"RIS",taskManager:"TaskManagerDS",libs:"libs",fakeOWLoader:"fakeOWLoader",timeunit:6e4,closeAndBackDisabledTimer:1e4,closeAndBackDisabledTimerOW:8e3,vastResponseTimeout:8e3,vastMinimumResponseTimeout:500,legacyCreativeId:0,domainUrls:{local:"local.ssacdn.com",prod:"www.supersonicads.com"},environment:{develop:"dev",production:"prod",stage:"stage"},errors:{missing:"Missing required parameter: ",invalid:"Invalid parameter: ",unknown:"Unknown parameter: ",appInfo:"Failed to retrieve application info",device:"Failed to retrieve device status",filemap:"Failed to retrieve file map",showAdFailedReasons:{preloadNoAd:"No ad on preload function",showNoAd:"No ad on show function",taskManagerPreload:"taskManager failed to preload",taskManagerEngage:"taskManager failed to engage"}},noMoreOffersReason:{refreshFeedAfterClosingAd:"Refresh Feed after closing ad",noMoreOffersToShowInFeed:"Finish view all campaigns (engageEnd)"},DebugLevels:{0:"NONE",1:"ERROR",2:"INFO",3:"VERBOSE"},videoStates:{none:0,play:1,stop:2},confirmCloseMsg:{close:"Are you sure you want to quit the offer?",yes:"OK",no:"Cancel"},confirmCloseMsgMap:{0:"during",1:"after"},protocol:{http:"http:",https:"https:",file:"file:"},styleAccordingToProtocol:{secured:"secured",unsecured:"unsecured"},labels:{noInternet:"No internet connection. Please connect and try again.",noOffers:"Sorry, There are no offers at the moment"},closeButtonStates:{close:"close",confirm:"confirm",back:"back",confirmNextFrame:"confirmNextFrame",nextFrame:"nextFrame",ignore:"ignore"},openUrlMethods:{storeKit:"storeKit",external_browser:"external_browser",store:"store",webview:"webview"},deviceOs:{android:"android",ios:"ios"},deviceOEM:{amazon:"amazon"},nativeInterfaceMethod:{displayWebView:"displayWebView"},nativeCallBacks:{hideSuccess:"onHideSuccess",hideFailed:"onHideFailed"},offerWallSetting:{immersive:"immersive",OLXD:"OLXD"},appInfo:{orientation:{landscape:"landscape",portrait:"portrait",none:"none"}},sspProductNames:{RewardedVideo:"rewardedVideo",Interstitial:"interstitial",OfferWall:"offerWall",Banner:"banner"},demandSourceType:{demandSource:"demandSource",instance:"instance"},demandSourceStates:{notInitiated:0,initFail:1,initiated:2,available:3,notAvailable:4,exhausted:5,cappedPerSession:6,initPending:7,loadPending:8},templateStyle:{template4:{minDialogBtnWidth:187,baseDialogBtnWidth:187,maxDialogBtnWidth:187,maxDialogBtnTextWidth:165},defaultTemplate:{minDialogBtnWidth:75,baseDialogBtnWidth:100,maxDialogBtnWidth:133,maxDialogBtnTextWidth:115}},viewsStates:{hybrid:2,normal:0},hybridViews:[{viewType:"controller",screenRatio:.999},{viewType:"store",screenRatio:.001}],baseDataKeys:["bannerId","creativeId","campaignType","opportunityId","requestId"],iphoneXDeviceModels:["iPhone10,3","iPhone10,6","iPhone11,6","iPhone11,4","iPhone11,2","iPhone11,8","iPhone12,1","iPhone12,3","iPhone12,5"],iphoneXDeviceResolution:{type1:{width:375,height:812},type2:{width:414,height:896}},notchSettings:{safeAreaInsetsMin:24,viewportCounter:10},requiredDeviceInfo:["appOrientation","connectionType","deviceOs","SDKVersion","deviceOSVersion","deviceModel","diskFreeSize"],requiredAppInfo:["applicationKey","applicationUserId"],optionalAppInfo:["campaignId","showDeliveryLimitationsLog","numOfCampaigns","disableCache","disableSession","country","language","itemName","itemCount","itemSignature","timestamp","demoCampaigns","mraid","admin","page","pageSize","landingId","maxVideoLength","minimumOfferCommission","minimumOfferCommissionSignature","useClientSideCallbacks","applicationUserGender","applicationUserAgeGroup","applicationUserCreationDate","applicationUserCreationDateSignature","placementId","SDKPluginType"],abTests:{CnCcCdn:"CC2",CnNonCcCdn:"NCC2",CnUser:"CN",NonCnUser:"NCN",WithoutCC:"WOCC",abt:"abt",controllerConfigGroup:"controllerConfigGroup"},abtParamByProductType:{RewardedVideo:"rewardedVideo",Interstitial:"interstitial",Banner:"banner",OfferWall:"offerwall"},deviceLimitations:["iPod5,1","iPad2,1","iPad4,8","iPad3,5","iPad3,6","iPad4,5","iPhone4,1","iPhone7,1","iPad4,4","iPad4,2","iPad2,2","iPad2,5","iPad4,1","iPad3,4","iPad3,3","iPad4,7","iPad3,1","iPad2,4"],applicationsLimitations:["49726195"],moat:{disabled:"off"},MOAT_PC:"ironsourceinappvideo555077879249",testAppBundleIds:["com.supersonic.mediation.test","com.ironsrcmobile.UltraApp","com.ironsrcmobile.UltraApp-enterprise","com.supersonic.automationapp","com.ironsrcmobile.Bridge","com.ironsource.othermediationtester","com.ironsrc.ISMedAdapters"],defaultOrientation:{BrandConnect:"application",RewardedVideo:"application",Interstitial:"application",OfferWall:"application",Banner:"application",general:"device",undefined:"application"},vastRequestPlaceholders:{moatEnabled:"{MT_ENABLED}",requestId:"{REQ_ID}",opportunityId:"{OPP_ID}"},featureCompatibilityMap:i,blockedProductsPerApiLevel:{BrandConnect:{android:/^10/,ios:/^7/},RewardedVideo:{android:/^10/,ios:/^7/},OfferWall:{android:/^10/,ios:/^7/},Interstitial:{android:/^10/,ios:/^7/},Banner:{android:/^10/,ios:/^7|8|9/}},storeSearchKeys:{ios:["itunes.apple.com"],android:["market://","play.google.com"]},gatewayDestinationMap:{RV:{production:"//rv-gateway.supersonicads.com/gateway/sdk/request",staging:"//staging-rv-gateway.sonic-us.supersonicads.com/gateway/sdk/request"},IS:{production:"//is-gateway.supersonicads.com/gateway/sdk/request/",staging:"//staging-is-gateway.sonic-us.supersonicads.com/gateway/sdk/request/"},OW:{production:"//ow-gateway.supersonicads.com/gateway/offerwall/request",staging:"//staging-ow-gateway.sonic-us.supersonicads.com/gateway/offerwall/request"},BN:{production:"//banner-gateway.supersonicads.com/gateway/sdk/request",staging:"//staging-banner-gateway.sonic-us.supersonicads.com/gateway/sdk/admin/request"}},appConfigPath:"/delivery/mobile/adUnit/getAppConfig.php",appExtConfigPath:"/users/microjob/sdkconfig.json",appExtConfigPathStaging:"/users/microjob/sdkconfig_staging.json",requiredSDKDataKeys:{applicationKey:"applicationKey",applicationUserId:"applicationUserId",appOrientation:"appOrientation",deviceLanguage:"deviceLanguage",bundleId:"bundleId",sdkAbName:"sdkAbName"},HTTPMethods:{GET:"GET",POST:"POST"},adClosedErrorReason:{unexpectedCloseActivityDestroy:"unexpectedClose_ActivityDestroy"},viewTypes:{externalView:"external"},integrationType:{manual:"M",automatic:"A"},assetType:{adunitAsset:"adunitAsset",adAsset:"adAsset"},DEFAULT_AMOUNT_OF_INVENTORIES:1,iOS_UIModalPresentationFullScreen:0}},{"../constants/featureCompatibilityMap":64}],10:[function(e,n,t){n.exports=function(i,r,t){function a(e){var n=e?e.productType:null;return!n||r.isLegacy(r.featureMap.MDS[n])}function o(e,n){return n=n||{},e&&e.demandSourceName&&!r.isLegacy(r.featureMap.MDS[t.RV])&&(n.demandSourceName=e.demandSourceName,n.demandSourceId=e.demandSourceId,n.isInAppBidding=e.isInAppBidding,n.integrationType=e.integrationType),n}return{isLegacy:a,extendCallbackParamsWithDemandConfig:o,extendCallbackParamsWithProductConfig:function(e,n){return n=o(e,n),e&&e.productType&&(n.productType=e.productType),n},extendCallbackParamsWithParentProductConfig:function(e,n){if(n=o(e,n),e&&e.productType){var t=r[e.productType];t&&(n.productType=i.Utils.isFunction(t.getProductType)?t.getProductType():e.productType)}return n},shouldReceiveMessage:function(e,n){return!(!e||!n)&&!(!e.productType||!e.demandSourceName)&&n.productType===e.productType&&(a(e)||n.demandSourceName===e.demandSourceName)},isManualRewardedVideoIntegration:function(){return r.RewardedVideo&&!0===r.RewardedVideo.isManualIntegration},setManualRewardedVideoTypeForNative:function(e){return e&&e.productType&&e.productType===t.RV&&(e.productType=t.IS),e}}}},{}],11:[function(e,n,t){n.exports=function(n){var t=null;return{set:function(e){t=e},get:function(){return t||null},reset:function(){t=null},getDisplayedAdType:function(){return t?t.productType:null},getDisplayedAdDemandName:function(){return t?t.demandSourceName:null},getDisplayedAdSettings:function(){return t?t.settings:null},isDisplayed:function(){return null!==t},isAdDisplayed:function(e){return t&&e&&n.getAdId(t)===n.getAdId(e)}}}},{}],12:[function(e,n,t){n.exports=function(){var a={};return{getABTestConfiguration:function(e,n){var t=a[e]&&a[e].abtest&&a[e].abtest.default,i=a[e]&&a[e].abtest&&a[e].abtest[t]||{},r=a[e]&&a[e].abtest&&a[e].abtest[n]||{};return jQuery.extend(i,r)},setConfig:function(e){a=e||{}},getExtConfig:function(){return a},getGeneralConfig:function(){return a.general},reset:function(){a={}}}}},{}],13:[function(e,n,t){n.exports=function(i,r,a,o,t){return{isFeatureSupportedInNativeSDK:function(e){var n=!1;return e&&t&&t.nativeFeatures&&(n=Array.isArray(t.nativeFeatures)&&-1<t.nativeFeatures.indexOf(e)),r.log("isFeatureSupportedInNativeSDK | feature: "+e+" is "+(n?"supported":"not supported"),r.LogLevels.info),n},isFeatureSupportedInFeaturesMap:function(e){var n=-1;try{var t="android"===a?e.android:e.ios;n=i.Utils.versionCompare(o,t)}catch(e){r.log(e,r.LogLevels.error)}return n<0}}}},{}],14:[function(e,n,t){n.exports=function(e,i,n){var r,a=e||"",o=n||6e4,s="Invalid API response",c=function(n){var t=!0;return jQuery.each(i,function(e){t=t&&void 0!==n[e]}),t};return{getInventory:function(e,n,t){r=new jQuery.Deferred;var i=n||a;return jQuery.ajax({url:i,data:e,type:"GET",dataType:t||"jsonp",timeout:o}).then(function(e){e&&e.errorCode&&e.errorMessage?r.reject({errorMessage:e.errorMessage,errorCode:e.errorCode}):c(e)?r.resolve(e):r.reject({errorMessage:s})},function(e,n,t){var i={errorMessage:"Error fetching inventory. Error data: "+n};r.reject(i)}),r.promise()},isValidResponseStructure:c}}},{}],15:[function(e,n,t){n.exports=function(o,s){var c,i={hit:1,miss:2,eventResult:"eventResult",resultReason:"resultReason"};function n(e){function a(e,n){var t;return e&&e.url&&(t={url:function(e,n){if(!e)return"";if(n)for(var t=n.length,i=0;i<t;i++)e=e.replace("{{"+n[i].key+"}}",encodeURIComponent(n[i].value));return e=e.replace(/\{\{[\w\d\s]*\}\}/g,"ok")}(e.url,n),type:e.type}),t}function t(e,n){var t,i,r=c[e];"object"==typeof r&&(0<r.length&&(r=r[0]),(t=a(r,n))&&(i=t,s.firePixel(i),o.log("Callback: "+JSON.stringify(i),o.LogLevels.info)))}return c=e,{track:function(e){var n;if(e&&c)switch(e.trackingType){case"request":t("requestTracking",null);break;case"responseHit":t("responseTracking",[{key:i.eventResult,value:i.hit}]);break;case"responseMiss":n=e.data,t("responseTracking",[{key:i.eventResult,value:i.miss},{key:i.resultReason,value:n}])}}}}return{init:function(e){return new n(e)}}}},{}],16:[function(e,n,t){n.exports=function(){var n=[];return{addToFilteredListCampaigns:function(e){e&&-1===n.indexOf(e)&&n.push(e)},getFilteredListCampaigns:function(){return n}}}},{}],17:[function(e,n,t){n.exports=function(e,i,n){function t(){var e=n("#displayedFrame");return e&&0<e.length?e:null}return{getDisplayedAdFrame:t,isFrameDisplayed:function(e){var n=t();return e&&n&&e[0]===n[0]},getAdUnitClassObj:function(e){var n="ssaAdUnit",t={class:n+" ",selector:"."+n};return e&&e.productType?(t.class+=e.productType+" ",t.selector+="."+e.productType,e.demandSourceName&&(t.class+=e.demandSourceName+" ",t.selector+="."+e.demandSourceName)):i.log("In getAdUnitClass with no ad",i.LogLevels.error),t},hideFrame:function(){var e=t();e&&e.addClass("hidden")},displayFrame:function(){var e=t();e&&e.removeClass("hidden")}}}},{}],18:[function(e,n,t){n.exports={NativeAPI:{updateConsentInfo:".updateConsentInfo"}}},{}],19:[function(s,e,n){e.exports=function(n,t,e){var i=s("./GDPRConstants.js"),r=!1,a=e.CB;function o(e){"string"!=typeof e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(t.getConfig().applicationSettings.consent=e)}return{init:function(e){e&&!r&&(n.PubSub.subscribe(a+i.NativeAPI.updateConsentInfo,function(e){if(e&&e.gdprConsentStatus)return t.log("updateConsentInfo | controller | params: "+JSON.stringify(e),t.LogLevels.info),void o(e.gdprConsentStatus);t.log("updateConsentInfo | controller | without params or gdprConsentStatus key",t.LogLevels.info)}),r=!0)},setConsent:o,getConsent:function(){return t.getConfig().applicationSettings.consent}}}},{"./GDPRConstants.js":18}],20:[function(e,n,t){function i(r,o){var e="NativeCallback",n=!1,a=[],t={GET:"GET",POST:"POST"},s={requestUnknown:"requestUnknown",requestStarted:"requestStarted",responseReceived:"responseReceived",requestError:"requestError"};function i(){r.PubSub.subscribe(e+".httpRequestStatusChanged",function(e){o.checkRequiredCallbackParams(["identifier","status"],e,"httpRequestStatusChanged").didSucceed&&c(e)})}function c(e){o.log("HTTPService - request status changed",o.LogLevels.verbose);var n=g(e.identifier,a);if(e.status===s.requestStarted)l(n);else if(e.status===s.responseReceived){var t={headers:e.responseParams.headers,statusCode:e.responseParams.statusCode,ranOnNative:!0},i=e.data;e.data&&(i=decodeURIComponent(i)),d(n,i,t)}else u(n,e.errMsg)}function l(e){o.log("onRequestStarted "+e.identifier,o.LogLevels.verbose),r.Utils.isFunction(e.onRequestStarted)&&e.onRequestStarted()}function d(e,n,t){o.log("_onResponseReceived "+e.identifier,o.LogLevels.verbose),f(e),r.Utils.isFunction(e.onResponseReceived)&&e.onResponseReceived(n,t)}function u(e,n){o.log("onRequestError "+n,o.LogLevels.verbose),f(e),r.Utils.isFunction(e.onRequestError)&&e.onRequestError(n)}function f(e){if(e){var n=a.indexOf(e);-1<n&&a.splice(n,1)}}function g(n,e){var t=jQuery.grep(e,function(e){return e.identifier===n});return 1!==t.length?null:t[0]}function p(){return+new Date+""+Math.random()}function v(e){return(!r.Utils.isDefined(e.allowNative)||e.allowNative)&&n}function m(e,n){return jQuery.extend(n,{url:e},{identifier:p()}),r.Utils.isDefined(n.background)||(n.background=!1),n}function b(e){o.log("_sendNativeEngineRequest",o.LogLevels.verbose);var i={};jQuery.each(e,function(e,n){if(!r.Utils.isFunction(n)){var t={};t[e]=n,jQuery.extend(i,t)}}),o.callSDKFunction("sendHttpRequest",i,"httpRequestStatusChanged","httpRequestStatusChanged")}function h(i){var r;o.log("_sendWebEngineRequest",o.LogLevels.verbose);var e=i;l(i);var a=function(e,n){var t={headers:e.getAllResponseHeaders(),statusCode:e.status,ranOnNative:!1};d(i,n,t)},n=jQuery.ajax(e);n.done(function(e,n,t){var i=t.responseText;a(t,i)}),n.fail(function(e,n,t){r=t,0===e.status?u(i,r&&""!==r?r:"unknown error"):a(e)})}function S(e){a.push(e),v(e)?b(e):h(e)}function y(e,n){n||(n={}),n.type=t.GET,S(m(e,n))}function C(e,n){n||(n={}),n.type=t.POST,S(m(e,n))}function A(){return a}function D(){return n}function I(e){n=e,i()}var w={GETRequest:y,POSTRequest:C,getPendingRequests:A,getIsNativeEngineExist:D,init:I};return w}n.exports=i},{}],21:[function(e,n,t){n.exports=function(d,u){var f="NativeCallback",g=!1;return{isHybridCampaign:function(e,n){return!u.isLegacy(u.featureMap.hybrid)&&"ios"===u.getApiData({deviceOs:1}).deviceOs&&e&&e.ext&&d.Utils.isDefined(e.ext.features)&&(n&&n.hybridOnClick&&!e.ext.forceOrientation||e.ext.features.allowHybrid&&!e.ext.forceOrientation||e.ext.isHybridFlow&&e.ext.forceOrientation)&&e.ext.clickTags&&u.AdUtils.getStoreAppId(e)&&e.ext.clickTags.pixelURL&&"CPVI"===e.ext.type},clearAppPage:function(e){e&&u.callSDKFunction("clearAppPage",{viewUniqueId:e})},loadHybridCampaign:function(e,s){var c=new jQuery.Deferred;if(u.isLegacy(u.featureMap.hybrid))c.reject();else{u.callSDKFunction("preLoadAppPage",{appId:e,viewUniqueId:s});var l=d.PubSub.subscribe(f+".appStoreInsideLoaded",function(e){var i,t,r,n,a,o;e&&"object"==typeof e&&e.viewUniqueId&&e.viewUniqueId===s&&(d.PubSub.unsubscribe(l),e.isLoaded?(i=s,t=d.PubSub.subscribe(f+".appStoreInsideClosed",function(e){if(e.viewUniqueId===i){var n=jQuery.extend({name:"appStoreInsideClosed"},e);d.PubSub.unsubscribe(t),g&&d.PubSub.publish("ViewsManager.viewClosed"),u.postAdUnitEvent(JSON.stringify(n))}}),r=d.PubSub.subscribe(f+".appStoreInsideDisplayHybrid",function(e){if(e.viewUniqueId===i){var n=jQuery.extend({name:"appStoreInsideDisplayHybrid"},e);d.PubSub.unsubscribe(r),u.postAdUnitEvent(JSON.stringify(n))}}),n=d.PubSub.subscribe(f+".appStoreInsideHideHybrid",function(){d.PubSub.publish("SDKController.HybridAdDidClosed"),d.PubSub.unsubscribe(n)}),a=d.PubSub.subscribe("SDKController.HybridChangeRatio",function(e){var n=e.hybridJson,t=e.viewUniqueId;t===i&&(0===n[0].screenRatio?(d.PubSub.unsubscribe(a),g=!0):1===n[0].screenRatio&&(d.PubSub.unsubscribe(a),d.PubSub.publish("ViewsManager.viewClosed")),u.callSDKFunction("hybridChangeRatio",{hybridJson:JSON.stringify(n),viewUniqueId:t}))}),o=d.PubSub.subscribe("HybridService.closeHybridFlow",function(e){e.viewUniqueId!==i&&(d.PubSub.unsubscribe(o),d.PubSub.unsubscribe(t),d.PubSub.unsubscribe(r),d.PubSub.unsubscribe(a),d.PubSub.unsubscribe(n))}),c.resolve()):c.reject())})}return c.promise()},createHybridId:function(e,n){var t="";return void 0!==n.demandSourceName&&(t=n.demandSourceName),t+=n.productType+u.AdUtils.getAdId(e)+u.AdUtils.getStoreAppId(e)}}}},{}],22:[function(e,n,t){n.exports=function(a,i,o,r,s,c,l){function d(e,n,t,i){r.extendAdObjectWithConfig(n,e,t,i),a.getNotchService().onSetConfig(e)&&(e.settings.isTransparentLayout=!0),c.isInitiated()&&(e.settings.ringerMuteOnStart=!0),a.log("Extended ad object, ad is "+JSON.stringify(e),a.LogLevels.verbose)}function u(e){var n="ssaAdUnit",t={class:n+" ",selector:"."+n};return e&&e.productType?(t.class+=e.productType+" ",t.selector+="."+e.productType,e.demandSourceName&&(t.class+=e.demandSourceName+" ",t.selector+="."+e.demandSourceName)):a.log("In getAdUnitClass with no ad",a.LogLevels.error),t}function f(e){var n,t=r.getAdId(e),i=null;return n=u(e).selector,o.each(o(n),function(){return o(this).data("id")!=t||(i=o(this),!1)}),i}function g(e,n,t,i){d(e,n,t,i),a.log("line[2717]: load ad unit url",a.LogLevels.verbose),f(e)||function(e,n){a.log("SDKController | loading ad to frame: "+r.getAdId(e)+e.productType,a.LogLevels.verbose);var t=u(e).class;n&&(t+="hidden "),o("<iframe />",{class:t,src:e.url}).data("id",r.getAdId(e)).data("close",!0).appendTo("body")}(e,i.preload)}function p(){var e=o(".loaderOW");e.addClass("loaderOWFadeOut"),setTimeout(function(){a.log("enter timeOut",a.LogLevels.verbose),o(".loaderOW").addClass("hidden"),e[0].offsetWidth=e[0].offsetWidth},600),o("#ssaLoaderWrap").addClass("hidden")}function v(e,n,t,i){p(),t(!1),l.set(n),e.removeClass("hidden").attr("id","displayedFrame"),i()}function m(e){e===i.OW?o(".loaderOW").removeClass("loaderOWFadeOut hidden"):o("#ssaLoaderWrap").removeClass("hidden")}return{createAndLoadAdUnitFrame:g,updateAdUnitUrl:function(e,n,t,i){var r;d(e,n,t,i),(r=f(e))?(a.log("line[3054]: updated iframe url for product "+t.productType,a.LogLevels.verbose),r[0].src=e.url):i.forceCreation?(a.log("Cannot find iframe to update, creating new one",a.LogLevels.verbose),g(e,n,t,i)):a.log("line[3051]: cannot find iframe to update url",a.LogLevels.verbose)},displayAdUnitFrame:function(e,n,t,i){var r=f(e);r.data("loaded")?(a.log("display frame",a.LogLevels.verbose),o.when(i(e,!1)).done(function(){v(r,e,n,t)})):(a.log("display frame with loader",a.LogLevels.verbose),l.set(e),o.when(i(e,!0)).done(function(){!function(e,n,t,i){if(e.data("loaded"))return v(e,n,t,i);t(!0),a.log("SDKController | Display with loader, frame "+e.data("id"),a.LogLevels.verbose),n&&n.productType&&(m(n.productType),e.attr("id","displayedFrame"))}(r,e,n,t)}))},handleScreenVisible:function(e,n,t){e&&m(t.productType),n&&(a.log("ad unit open error",a.LogLevels.verbose),n.addClass("hidden").attr("id",""))},unloadAdUnitFrame:function(t){a.log("SDKController | unloading ad from frame: "+r.getAdId(t)+t.productType,a.LogLevels.verbose),o.each(o(s.getAdUnitClassObj(t).selector),function(e,n){return o(n).data("id")!==r.getAdId(t)||(t.engaged=s.isFrameDisplayed(o(n)),t.engaged&&n.removeAttribute("id"),t.productType===i.OW?setTimeout(function(){n&&n.parentNode&&n.parentNode.removeChild(n)},0):n&&n.parentNode&&n.parentNode.removeChild(n),!1)})},displayLoader:m,hideLoader:p,hideFrame:s.hideFrame,displayFrame:s.displayFrame,isContainerLoaded:function(e){return!!f(e)},onAdUnitLoaded:function(e,n,t){var i=f(e);if(i)if(i.data("loaded"))a.log("SDKController | We already received the loaded event for this frame",a.LogLevels.verbose);else{i.data("loaded",!0);var r=s.isFrameDisplayed(i);a.log("SDKController | ad loaded: "+a.AdUtils.getAdId(e)+"|"+r?"frame Displayed: true":"frame Displayed: false|"+u(e).selector,a.LogLevels.verbose),r&&v(i,e,n,t)}},getAdFrameByProductAndId:f}}},{}],23:[function(e,n,t){n.exports=function(r){var e=[];function a(n){return function(e){return e.demandSourceName===n.demandSourceName&&e.productType===n.productType}}function t(e){for(var n=0,t=0;t<e.length;t++)n+=e[t].counter;return n}function o(e){var n;return t(s().filter((n=e,function(e){return e&&e.productType===n})))}function n(e){var n;return t(s().filter((n=e,function(e){return e&&e.productType===n&&!0===e.isBiddingInstance})))}function i(e){var n,t,i=s().filter(a(e));return 0<i.length?i[0]:(t={demandSourceName:(n=e).demandSourceName,productType:n.productType,isBiddingInstance:n.isInAppBidding,counter:0},s().push(t),t)}function s(){return e}return{getTokenCounters:function(){return{biddingRVImpressions:n(r.RV),biddingISImpressions:n(r.IS),totalRVSessionImpressions:o(r.RV),totalISSessionImpressions:o(r.IS)}},getPayloadCounters:function(e){return{instanceImpressions:(n=e,t=0,i=s().filter(a(n)),0<i.length&&(t=i[0].counter),t),totalRVSessionImpressions:o(r.RV),totalISSessionImpressions:o(r.IS)};var n,t,i},setInstanceImpressionsCounter:function(e){var n=i(e);n&&n.counter++}}}},{}],24:[function(e,n,t){function i(e){var n=e,r=[],i=-1,t;function a(){return r.length}function o(){return r}function s(e){Array.isArray(e)&&(i=0,r=e)}function c(){return r[i]}function l(){return t}function d(e){t=e}function u(e){var n,t=p(e);return-1<t&&(n=r.splice(t,1)[0])&&(m()?i=-1:i<t?i=(i+1)%a():t<i&&i--),n}function f(e){var n=p(e);if(-1<n)return r[n]}function g(e,n){var t=p(n);if(-1<t)return r[t]=e,r[t]}function p(e){if(void 0===e)return-1;for(var n=0,t=a(),i=e.toString();n<t&&e;n++)if(r[n].id===i)return n;return-1}function v(){return!m()&&(i+1)%a()!==i}function m(){return 0===a()}function b(){r=[],i=-1,t=null}var h={getOffers:o,getCurrentOffer:c,getOfferById:f,getBackfillOffer:l,setOffers:s,setBackfillOffer:d,removeOfferById:u,replaceOfferById:g,isNextOfferAvailable:v,isEmpty:m,size:a,reset:b};return h}n.exports=i},{}],25:[function(e,n,t){n.exports=function(i,r){var a=0,o=0;function n(){return a}return{setLastDisplayedAdCampaignId:function(e,n,t){i.getApplicationExternalConfig().getABTestConfiguration(t,n).sendLastCampaignId&&t===r.IS&&(a=e,o=n)},getLastDisplayedAdCampaignId:n,shouldAddLastDisplayedAdCampaignIdToPayload:function(e){return i.getApplicationExternalConfig().getABTestConfiguration(e,o).sendLastCampaignId&&e===r.IS&&0!==n()}}}},{}],26:[function(e,n,t){function i(a){var o,s,c,l,d,u,r={none:0,error:1,info:2,verbose:3},f={0:"NONE",1:"ERROR",2:"INFO",3:"VERBOSE"};function g(e,n){var t=a.isDefined(e)?e:"Controller",i=a.isDefined(n)?f[n]:f[c];return c?"SupersonicAds "+t+" ["+i+"] :":""}return{init:function(e,n,t,i){d=window.console||{},o=e,l=n,u=i,(c=t)?(s=d.log,d.log=function(e){this.log(e,r.verbose)}):d.log=function(){}},log:function(e,n,t){var i,r;(window.productionDebug&&u&&u({url:"http://iron-debug-controller.com?log="+e,type:"pixel"}),n&&c<n)||(a.isString(e)||(e=JSON.stringify(e)),a.isFunction(s)&&"android"===o?s.call(d,g(t,n)+e):"android"!==o&&(i=g(t,n)+e,(r={eventName:"log",prefix:"logmessage"}).parameters={message:i,acknowledgeWith:"acknowledgeMessage",declineWith:"errorTest"},l&&l.postMessage(r)))},debugMsg:g,LogLevels:r,DebugLevels:f}}var r;n.exports=function(e){return r||(r=new i(e)),r}},{}],27:[function(f,e,n){e.exports=function(e,t){var i=f("./Constants.js"),r="moatAPI",n="moatStartTrackingSuccess",a="moatStartTrackingFail",o="moatStopTrackingSuccess",s=!1,c=!1,l=!1;function d(){return s}function u(){return c}return{initWithOptions:function(e){u()&&t.log("MOATService - initWithOptions MOAT is already initialized",t.LogLevels.verbose),l||(t.setAllowFileAccessFromFileURLs(!0),l=!0);var n=e||{};n.loggingEnabled="prod"!==t.getEnv()&&(t.getConfig().mobileSDKSettings.deviceOs!==i.deviceOs.ios||"true"),t.getConfig().mobileSDKSettings.deviceOs===i.deviceOs.android&&(n.disableAdIdCollection=!0),t.callSDKFunction(r,{moatFunction:"initWithOptions",moatParams:n}),c=!0},containsMOATData:function(e){return!!(e.ext&&e.ext.ivt&&e.ext.ivt.mt)},vastContainsMOATData:function(e){return e.ext&&e.ext.videoData&&e.ext.videoData.videoSource&&e.ext.videoData.videoSource.vast&&-1!==e.ext.videoData.videoSource.vast.indexOf("mt=")},createAdTracker:function(){d()&&t.callSDKFunction(r,{moatFunction:"createAdTracker"})},startTracking:function(){d()&&(e.PubSub.subscribe(i.CB+"."+n,function(e){t.log(r+" Start tracking success: "+JSON.stringify(e),t.LogLevels.verbose)}),e.PubSub.subscribe(i.CB+"."+a,function(e){t.log(r+" Start tracking fail: "+JSON.stringify(e),t.LogLevels.verbose)}),t.callSDKFunction(r,{moatFunction:"startTracking"},n,a))},stopTracking:function(){d()&&(e.PubSub.subscribe(i.CB+"."+o,function(e){t.log(r+"Stop tracking success: "+JSON.stringify(e),t.LogLevels.verbose)}),t.callSDKFunction(r,{moatFunction:"stopTracking"},o))},isTrackingEnabled:d,isInitialized:u,enableTracking:function(){s=c},disableTracking:function(){s=!1},extractMoatDataFromAd:function(e){var n={};return n.ids=e.ext.ivt.mt||{},n.publisherCode=e.ext.ivt&&e.ext.ivt.mtpcode?e.ext.ivt.mtpcode:i.MOAT_PC,n}}}},{"./Constants.js":9}],28:[function(e,n,t){function i(){var e,n={init:function(n,t,e){return this.receiveMessage(function(e){t.call(n,e)},e),this},postMessage:function(e,n,t){n&&(t=t||parent).postMessage(e,n.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))},receiveMessage:function(n,t){n&&(e=function(e){"string"==typeof t&&e.origin!==t||"[object Function]"===Object.prototype.toString.call(t)&&!1===t(e.origin)||("function"!=typeof t||t(e.data))&&n(e)}),window.addEventListener?window[n?"addEventListener":"removeEventListener"]("message",e,!1):window[n?"attachEvent":"detachEvent"]("onmessage",e)}};return n}n.exports=i},{}],29:[function(O,e,n){function t(){var e=O("./Inventory.js"),r={},n=[],t,i;function a(){i=4}function o(){if(I())return Math.max(1,t-1)}function s(){if(0!==Object.keys(r).length)return r[o()]}function c(e){return I()&&w()?e?r[e].size():r[o()].size():0}function l(e){return I()&&w()?e?r[e].getOffers():r[o()].getOffers():[]}function d(){Array.isArray(n)&&n.length>i&&delete r[n.shift()]}function u(e,n){if(Array.isArray(e)&&0!==e.length){var t=void 0!==n?n:D();void 0===r[t]&&(t=D());for(var i=0;i<e.length;i++)e[i].inventoryId=t;return r[t].setOffers(e),t}}function f(e,n){if(e){var t=void 0!==n?n:D();return void 0===r[t]&&(t=D()),e.inventoryId=t,r[t].setBackfillOffer(e),t}}function g(e){if(I()&&w())return e?r[e].getCurrentOffer():r[o()].getCurrentOffer()}function p(e){if(I()&&w())return e?r[e].getBackfillOffer():r[o()].getBackfillOffer()}function v(e,n){if(I()&&w())return n?r[n].removeOfferById(e):r[o()].removeOfferById(e)}function m(e,n){if(I()&&w())return n?r[n].getOfferById(e):r[o()].getOfferById(e)}function b(e,n,t){if(I()&&w())return t?r[t].replaceOfferById(e,n):r[o()].replaceOfferById(e,n)}function h(e){return!(!I()||!w())&&(e?r[e].isNextOfferAvailable():r[o()].isNextOfferAvailable())}function S(e){return!I()||!w()||(e?r[e].isEmpty():r[o()].isEmpty())}function y(){n=[],r={},t=void 0}function C(e){var n=void 0!==e?e:o();n&&r[n]&&(delete r[n],t--)}function A(){return r}function D(){return void 0===t&&(t=1),r[t]=new e(t),n.push(t),t++,d(),t-1}function I(){return 0!==n.length&&void 0!==t}function w(){return void 0!==r[o()]}function P(){return i}function L(){return t}a();var T={getOffers:l,getCurrentOffer:g,getOfferById:m,getBackfillOffer:p,setOffers:u,setBackfillOffer:f,removeOfferById:v,replaceOfferById:b,isNextOfferAvailable:h,isEmpty:S,size:c,reset:y,getActiveInventoryId:o,getActiveInventory:s,removeInventory:C,getInventories:A,getAmountOfInventoriesAllowed:P,getAvailableInventoryId:L};return T}e.exports=t},{"./Inventory.js":24}],30:[function(e,n,t){n.exports={CB:"NativeCallback",serviceCallback:"serviceCallback",NativeAPI:{onNativeLifeCycleEvent:"onNativeLifeCycleEvent"},AndroidEvents:{onStart:"onStart",onPause:"onPause",onResume:"onResume",onDestroy:"onDestroy"}}},{}],31:[function(l,e,n){e.exports=function(e,i,n){var t=l("./NativeLifeCycleEventsConstants.js"),r=i.jQuery(),a=[],o=new(l("./AndroidLifeCycleEventHandlers.js"))(e,i,n);function s(){e.PubSub.subscribe(t.CB+"."+t.NativeAPI.onNativeLifeCycleEvent,function(e){var n,t;i.log("LifeCycleEventsService | received new event: "+JSON.stringify(e),i.LogLevels.info),e&&(n=e.lifeCycleEvent,t=e,c(n)&&o.publishEvent(n,t))})}function c(e){return e&&-1<r.inArray(e,a)}return{init:function(){s()},startNotify:function(e){i.log("LifeCycleEventsService | startNotify | event: "+e,i.LogLevels.info),c(e)||a.push(e)},stopNotify:function(e){i.log("LifeCycleEventsService | stopNotify | event: "+e,i.LogLevels.info),c(e)&&a.splice(r.inArray(e,a),1)}}}},{"./AndroidLifeCycleEventHandlers.js":4,"./NativeLifeCycleEventsConstants.js":30}],32:[function(r,e,n){e.exports=function(t,i){return{create:function(e){var n=e.deviceOs;return n===i.deviceOs.ios&&null===e.safeAreaInsets?new(r("../patches/PatchesIphoneX.js"))(t,e,i):new(r("./NotchService.js"))(t,e.safeAreaInsets,i,n)}}}},{"../patches/PatchesIphoneX.js":127,"./NotchService.js":33}],33:[function(e,n,t){n.exports=function(e,n,t,i){var r=0,a=!1;function o(){return i!==t.deviceOs.android&&a}function s(){var e=document.getElementById("viewport"),n="viewport-fit=cover";-1===e.content.indexOf(n)&&(e.content+=","+n)}return function(){if(i!==t.deviceOs.android){var e=t.notchSettings.safeAreaInsetsMin;a=n.top>e||n.bottom>e||n.right>e||n.left>e}}(),{hasNotch:o,onParseDeviceStatusSuccess:function(){i!==t.deviceOs.android&&o()&&window.addEventListener("resize",function(){(0===r||r>=t.notchSettings.viewportCounter)&&(r=0,function e(){r<t.notchSettings.viewportCounter&&setTimeout(function(){s(),r++,e()},100)}())})},onEngageEnd:function(){i!==t.deviceOs.android&&o()&&(r=0)},onSetConfig:function(e){return i!==t.deviceOs.android&&o()&&(n=e).settings&&n.settings.standaloneView;var n},onScreenVisible:function(){i!==t.deviceOs.android&&o()&&!e("body").hasClass("iphoneXAdjustPadding")&&(e("body").addClass("iphoneXAdjustPadding"),s())},className:"NotchService"}}},{}],34:[function(e,n,t){n.exports={omidNativeFunction:"omidAPI",activateSuccessKey:"omidActivateSuccess",activateFailKey:"omidActivateFail",startSessionSuccessKey:"omidStartSessionSuccess",startSessionFailKey:"omidStartSessionFail",finishSessionSuccessKey:"omidFinishSessionSuccess",finishSessionFailKey:"omidFinishSessionFail",impressionOccurredSuccessKey:"omidimpressionOccurredSuccess",impressionOccurredFailKey:"omidimpressionOccurredFail",omidFailedToLoadBundleMessage:"Failed to load OMID JS Bundle",omidFailedToDownloadMessage:"Failed to download and cache OMID JS Bundle",omidFailureInStartSession:"Failure in starting session",omidFailureInFinishSession:"Failure in finishing session",omidFailureInImpressionOccurred:"Failure in impression occurred",omidBundleFilePrefix:"omid-daemon-",omidBundleFileType:".js",stopOMIDServiceDelay:1e3,omidPartnerName:"Ironsrc",omidPartnerVersion:"6",omidServiceName:"omid",omidBundleDefaultVersionKey:"default",omidVersionMapping:{"1.2.22-Ironsrc":"1.0.0",default:"1.0.0"}}},{}],35:[function(e,n,t){n.exports=function(r,a,o){var s,c=e("./Constants.js"),l=e("./OMIDConstants"),d=!1,u=!1,f="",g=c.omidPartnerVersion,p="",n=null,v=null,m=null,b=null,h=null;function t(){if(!d){if(v&&"pending"===v.state())return v;v=new o.Deferred,a.log("OMIDService - activate",a.LogLevels.verbose);var t=r.PubSub.subscribe(c.CB+"."+l.activateSuccessKey,function(e){var n;f=e&&e.omidVersion?e.omidVersion:"",g=e&&e.omidPartnerVersion?e.omidPartnerVersion:c.omidPartnerVersion,d=!0,r.PubSub.clearHandlers([t,i]),r.PubSub.subscribe("SDKController.OMIDStartSession",function(e){S(e)}),r.PubSub.subscribe("SDKController.OMIDFinishSession",function(){y()}),r.PubSub.subscribe("SDKController.OMIDImpressionOccurred",function(){!function(){if(!C()||!d||!u){var e=l.omidFailureInImpressionOccurred+" didLoadOMSDKService "+C()+" omidServiceActivated "+d+" isSessionStarted "+u;return r.PubSub.publish("SDKController.onOmidServiceFailure",[e])}if(!h||"pending"!==h.state()){h=new o.Deferred,a.log("OMIDService - impressionOccurred",a.LogLevels.verbose);var t=r.PubSub.subscribe(c.CB+"."+l.impressionOccurredSuccessKey,function(e){r.PubSub.clearHandlers([t,i]),a.log(l.omidNativeFunction+" Impression Occurred success: "+JSON.stringify(e),a.LogLevels.verbose),h.resolve()}),i=r.PubSub.subscribe(c.CB+"."+l.impressionOccurredFailKey,function(e){r.PubSub.clearHandlers([t,i]);var n=e&&e.errMsg?e.errMsg:"";a.log(l.omidNativeFunction+" Impression Occurred fail: "+JSON.stringify(e),a.LogLevels.verbose),r.PubSub.publish("SDKController.onOmidServiceFailure",[n]),h.reject()});a.callSDKFunction(l.omidNativeFunction,{omidFunction:"impressionOccurred"},l.impressionOccurredSuccessKey,l.impressionOccurredFailKey),h.promise()}}()}),n=A(f),p=s.getExternalLibrariesUrl()+l.omidServiceName+"/"+n+"/"+l.omidServiceName+l.omidBundleFileType,a.log(l.omidNativeFunction+" activate success: "+JSON.stringify(e),a.LogLevels.verbose),v.resolve()}),i=r.PubSub.subscribe(c.CB+"."+l.activateFailKey,function(e){r.PubSub.clearHandlers([t,i]);var n=e&&e.errMsg?e.errMsg:"";a.log(l.omidNativeFunction+" activate session fail: "+JSON.stringify(e),a.LogLevels.verbose),r.PubSub.publish("SDKController.onOmidServiceFailure",[n]),v.reject()});return a.callSDKFunction(l.omidNativeFunction,{omidFunction:"activate",omidParams:{}},l.activateSuccessKey,l.activateFailKey),v.promise()}a.log("OMIDService - activate OMID is already initialized",a.LogLevels.verbose)}function S(e){if(C()&&d){if(m&&"pending"===m.state())return m;m=new o.Deferred,a.log("OMIDService - startSession",a.LogLevels.verbose);var t=r.PubSub.subscribe(c.CB+"."+l.startSessionSuccessKey,function(e){r.PubSub.clearHandlers([t,i]),u=!0,a.log(l.omidNativeFunction+" Start session success: "+JSON.stringify(e),a.LogLevels.verbose),m.resolve()}),i=r.PubSub.subscribe(c.CB+"."+l.startSessionFailKey,function(e){r.PubSub.clearHandlers([t,i]),u=!1,I();var n=e&&e.errMsg?e.errMsg:"";a.log(l.omidNativeFunction+" Start session fail: "+JSON.stringify(e),a.LogLevels.verbose),r.PubSub.publish("SDKController.onOmidServiceFailure",[n]),m.reject()});return a.callSDKFunction(l.omidNativeFunction,{omidFunction:"startSession",omidParams:e},l.startSessionSuccessKey,l.startSessionFailKey),m.promise()}var n=l.omidFailureInStartSession+" didLoadOMSDKService "+C()+" omidServiceActivated "+d;r.PubSub.publish("SDKController.onOmidServiceFailure",[n])}function y(){if(C()&&d&&u){if(b&&"pending"===b.state())return b;b=new o.Deferred,a.log("OMIDService - finishSession",a.LogLevels.verbose);var t=r.PubSub.subscribe(c.CB+"."+l.finishSessionSuccessKey,function(e){r.PubSub.clearHandlers([t,i]),u=!1,a.log(l.omidNativeFunction+" Start session success: "+JSON.stringify(e),a.LogLevels.verbose),b.resolve()}),i=r.PubSub.subscribe(c.CB+"."+l.finishSessionFailKey,function(e){r.PubSub.clearHandlers([t,i]),u=!1,I();var n=e&&e.errMsg?e.errMsg:"";a.log(l.omidNativeFunction+" Start session fail: "+JSON.stringify(e),a.LogLevels.verbose),r.PubSub.publish("SDKController.onOmidServiceFailure",[n]),b.reject()});return a.callSDKFunction(l.omidNativeFunction,{omidFunction:"finishSession"},l.finishSessionSuccessKey,l.finishSessionFailKey),b.promise()}var e=l.omidFailureInFinishSession+" didLoadOMSDKService "+C()+" omidServiceActivated "+d+" isSessionStarted "+u;r.PubSub.publish("SDKController.onOmidServiceFailure",[e])}function C(){return window.OmidDaemon&&"function"==typeof window.OmidDaemon.start&&"function"==typeof window.OmidDaemon.stop}function A(e){return l.omidVersionMapping[e]?l.omidVersionMapping[e]:l.omidVersionMapping[l.omidBundleDefaultVersionKey]}function i(){window.OmidDaemon&&window.OmidDaemon.start({partnerName:l.omidPartnerName,partnerVersion:g})}function D(){r.PubSub.publish("SDKController.onOmidServiceFailure",[l.omidFailedToLoadBundleMessage])}function I(){window.OmidDaemon&&window.OmidDaemon.reset()}return{isSupported:function(e,n){return!a.isLegacy(a.featureMap.OMID)&&(i=e)&&i.omidEnabled&&!(!(t=n)||!t.omidEnabled)&&t.omidEnabled;var t,i},isNativeServiceActivated:function(){return d},getVersionData:function(){return{omidVersion:f,omidPartnerVersion:g}},startSession:S,finishSession:y,isAdOmidSupported:function(e){return e&&e.ext&&e.ext.ivt&&e.ext.ivt.omid},downloadOmidJsBundle:function(){if(!d)return r.Utils.returnResolvedPromise();if(C())return r.Utils.returnResolvedPromise();if(n&&"rejected"!==n.state())return n;n=new o.Deferred;var e=d?p:"";return a.libsManager.updateFileVersionByFilePathForThirdPartyLibraries(l.omidServiceName,e,A(f)).then(a.libsManager.manageDownloadLibsFileByFiletype.bind(null,l.omidServiceName)).then(function(){var e;e=s.getCacheLibsPath()+l.omidServiceName+l.omidBundleFileType,r.Utils.getScript(e,i,D),n.resolve()},function(){r.PubSub.publish("SDKController.onOmidServiceFailure",[l.omidFailedToDownloadMessage]),n.reject()}),r.Utils.returnResolvedPromise()},init:function(e){s=e,t()}}}},{"./Constants.js":9,"./OMIDConstants":34}],36:[function(e,n,t){n.exports=function(){var i,r={iframe:"#adSandbox",url:"",adData:"",templateClass:"obfuscationIframe",src:"{{url}}",frameBorder:"0",scrolling:"no",style:{},id:""},a={};return{init:function(e,n){if((a=jQuery.extend(r,e)).adData&&""!==a.adData){var t=a.src.replace("{{url}}",a.url);(i=jQuery("<iframe />",{id:a.id,class:a.templateClass,src:t,scrolling:a.scrolling,frameborder:a.frameBorder}).css(a.style)).on("load",function(){n(i)}),document.documentElement.appendChild(i[0])}},removeIframe:function(e){if(e){var n=document.getElementById(e);n&&n.parentNode.removeChild(n)}}}}},{}],37:[function(e,n,t){n.exports=function(o){var s=e("./Constants.js");return{open:function(e){if(e&&e.type){if("openUrl"!==e.type)return!1;var n,t=e.callback;e.method||(o.getApiData({deviceOs:1}).deviceOs===s.deviceOs.ios?!e.appId||!o.isLegacy(o.featureMap.hybrid)&&o.isLegacy({ios:"5.38",android:"99"})?e.method=s.openUrlMethods.external_browser:e.method=s.openUrlMethods.storeKit:e.method=s.openUrlMethods.store);var i=(r=e,(a={default:{}})[s.openUrlMethods.storeKit]={appId:r.appId,viewUniqueId:o.StoreKitService.getViewUniqueId(r)},a[s.openUrlMethods.external_browser]={},a[s.openUrlMethods.store]={},a[s.openUrlMethods.webview]={controls:!0},a[r.method]||a.default);return n=jQuery.extend({url:e.url,method:e.method},i),o.openUrl(n,t),!0}var r,a;return!1},openForOW:function(e){if(e&&e.type&&"openUrl"===e.type){var n={},t=e.callback;return n=e.externalBrowser?{url:e.url,controls:!0,method:"external_browser"}:e.method===s.openUrlMethods.external_browser?{url:e.url,method:"external_browser"}:e.install?"ios"===o.getApiData({deviceOs:1}).deviceOs?{url:e.url,controls:!0,method:"external_browser"}:{url:e.url,controls:!0,method:"store"}:{url:e.url,controls:!0,method:"webview"},o.openUrl(n,t),!0}return!1}}}},{"./Constants.js":9}],38:[function(e,n,t){n.exports={NativeAPI:{failCallback:"handleAppOrientationDataFailed",successCallback:"handleAppOrientationDataSuccess",oldApiSuccessCallback:"getOrientationSuccess"},ControllerNativeAPI:{getAppOrientationData:"getAppOrientationData",oldSetOrientation:"setOrientation",oldGetOrientation:"getOrientation",setAppOrientation:"setAppOrientation"},eventicsCategories:{failCallback:{name:"AppOrientationFailed",id:263},successCallback:{name:"AppOrientationSuccess",id:264}},iosOrientationsMap:{UIInterfaceOrientationPortrait:2,UIInterfaceOrientationPortraitUpsideDown:4,UIInterfaceOrientationLandscapeLeft:16,UIInterfaceOrientationLandscapeRight:8},iosOrientations:{2:"Portrait",4:"PortraitUpsideDown",16:"LandscapeLeft",8:"LandscapeRight"},appOrientationAPI:"appOrientationAPI"}},{}],39:[function(e,n,t){n.exports=function(a,o,s){var t,c=e("./OrientationConstants.js"),i=!1,l=s.CB;function r(e){o.log("_setAppOrientation | send orientation: "+e,o.LogLevels.info),o.callSDKFunction(c.ControllerNativeAPI.setAppOrientation,{appOrientation:e})}return{init:function(e,n){e&&!i&&(a.PubSub.subscribe(l+"."+c.NativeAPI.successCallback,function(e){t.trackEvent(c.eventicsCategories.successCallback),e||(o.log("getAppOrientationData | Orientation data structure not exist.",o.LogLevels.info),t.trackEvent(c.eventicsCategories.failCallback))}),a.PubSub.subscribe(l+"."+c.NativeAPI.failCallback,function(e){o.log("getAppOrientationData failed, errorMsg:"+e.errMsg,o.LogLevels.info),t.trackEvent(c.eventicsCategories.failCallback)}),a.PubSub.subscribe("AppOrientationManager.appOrientationChanged",function(e){e&&e.appOrientation&&(o.log("appOrientationChanged | updating native with orientation: "+e.appOrientation,o.LogLevels.info),r(e.appOrientation))}),t=n,i=!0)},getAppOrientationData:function(){o.callSDKFunction(c.ControllerNativeAPI.getAppOrientationData,{},c.NativeAPI.successCallback,c.NativeAPI.failCallback)},setOrientation:function(e){o.callSDKFunction(c.ControllerNativeAPI.oldSetOrientation,{orientation:e})},oldGetOrientation:function(){var t=new jQuery.Deferred,i=a.PubSub.subscribe(l+"."+c.NativeAPI.oldApiSuccessCallback,function(e){if(a.PubSub.unsubscribe(i),"resolved"!==t.state()){clearTimeout(r);var n=e&&e.orientation||s.appInfo.orientation.portrait;t.resolve(n)}}),r=setTimeout(function(){t.resolve(s.appInfo.orientation.portrait)},2e3);return o.callSDKFunction(c.ControllerNativeAPI.oldGetOrientation,null,c.NativeAPI.oldApiSuccessCallback,c.NativeAPI.oldApiSuccessCallback),t.promise()},setAppOrientation:r}}},{"./OrientationConstants.js":38}],40:[function(e,n,t){n.exports=function(){var a=e("./OrientationConstants.js");function o(e){var n=parseInt(e.replace(/^"|"$/g,"")),t=[],i=n.toString(2);if(i.length>Object.keys(a.iosOrientations).length+1||"0"!==i.substr(i.length-1,1))return[];for(var r in a.iosOrientations)(n|r)===n&&t.push(a.iosOrientations[r]);return t}var n=function(n,e){return e.some(function(e){return 0<=n.indexOf(e)})};return{convertOrientationsArrayToNumber:function(e){var i=0;return e.forEach(function(e){var n,t;i+=Number((n=a.iosOrientations,t=e,Object.keys(n).filter(function(e){return n[e]===t})))}),i},convertNumberToOrientations:o,isContainPortrait:function(e){return n(o(e),[a.iosOrientations[2],a.iosOrientations[4]])},isContainLandscape:function(e){return n(o(e),[a.iosOrientations[8],a.iosOrientations[16]])},sharedOrientationBetweenOrientations:function(e,n){var t=o(e),i=o(n),r=t.filter(function(e){return-1<i.indexOf(e)});return r||(r=[]),r}}}},{"./OrientationConstants.js":38}],41:[function(e,n,t){n.exports=function(r,a){var i,o=e("./Constants.js"),s=e("./PermissionsConstants.js"),c=s.nativeFunction,l={};return{getPermissions:function(){if(i&&"pending"===i.status)return i;i=new jQuery.Deferred;var e,n=r.PubSub.subscribe(o.CB+"."+s.handleGetPermissionsSuccess,function(e){a.log(s.handleGetPermissionsSuccess+": "+JSON.stringify(e)),r.PubSub.unsubscribe(n),r.PubSub.unsubscribe(t),i.resolve(e)}),t=r.PubSub.subscribe(o.CB+"."+s.handleGetPermissionsFailure,function(e){a.log(s.handleGetPermissionsFailure+": "+JSON.stringify(e)),r.PubSub.unsubscribe(t),r.PubSub.unsubscribe(n),i.reject(e)});return a.callSDKFunction(s.nativeFunction,{functionName:s.NativeAPI.getPermissions,functionParams:(e=a.getConfig().mobileSDKSettings.deviceOs===o.deviceOs.ios?o.deviceOs.ios:o.deviceOs.android,{permissions:s.supportedPermissions[e]})},s.handleGetPermissionsSuccess,s.handleGetPermissionsFailure),i.promise()},isPermissionGranted:function(e){if(!e)return!1;if(l[e]&&"pending"===l[e].status)return l[e];l[e]=new jQuery.Deferred;var t=r.PubSub.subscribe(o.CB+"."+s.handleIsPermissionGrantedSuccess,function(e){if(e&&e.permission){var n=e.permission;l[n]?(a.log(s.handleIsPermissionGrantedSuccess+": "+JSON.stringify(e)),r.PubSub.unsubscribe(t),r.PubSub.unsubscribe(i),l[n].resolve(e)):a.log("Unrecognised permission name "+n,a.LogLevels.error)}}),i=r.PubSub.subscribe(o.CB+"."+s.handleIsPermissionGrantedFailure,function(e){if(e&&e.permission){a.log(c+s.NativeAPI.isPermissionGranted+JSON.stringify(e),a.LogLevels.verbose);var n=e.permission;l[n]?(r.PubSub.unsubscribe(i),r.PubSub.unsubscribe(t),l[n].reject(e)):a.log("Unrecognised permission name "+n,a.LogLevels.error)}else e&&e.errMsg&&a.log("Error calling isPermissionGranted "+e.errMsg,a.LogLevels.error)});return a.callSDKFunction(s.nativeFunction,{functionName:s.NativeAPI.isPermissionGranted,functionParams:{permission:e}},s.handleIsPermissionGrantedSuccess,s.handleIsPermissionGrantedFailure),l[e].promise()}}}},{"./Constants.js":9,"./PermissionsConstants.js":42}],42:[function(e,n,t){n.exports={CB:"NativeCallback",NativeAPI:{getPermissions:"getPermissions",isPermissionGranted:"isPermissionGranted"},nativeFunction:"permissionsAPI",supportedPermissions:{ios:["NSCameraUsageDescription","NSLocationAlwaysUsageDescription","NSLocationWhenInUseUsageDescription","NSLocationAlwaysAndWhenInUseUsageDescription","NSMicrophoneUsageDescription"],android:[]},handleGetPermissionsSuccess:"handleGetPermissionsSuccess",handleGetPermissionsFailure:"handleGetPermissionsFailure",handleIsPermissionGrantedSuccess:"handleIsPermissionGrantedSuccess",handleIsPermissionGrantedFailure:"handleIsPermissionGrantedFailure"}},{}],43:[function(e,n,t){n.exports=function(t){return{firePixel:function(e){if(void 0!==e.url&&""!==e.url){if("pixel"===e.type){var n=new Image;""===e.at||isNaN(parseInt(e.at))?n.src=e.url:(n.src=e.url,n.time=e.at)}}else t.log("Missing callback data. At: directive ssaPixel"+(new Date).getTime(),t.LogLevels.info)}}}},{}],44:[function(e,n,t){function i(r){var a={},t,o,e={init:function(){o=jQuery,t=this},publish:function(n,e){o=o||jQuery;try{var t=o.extend(!0,[],a[n]);o.each(t,function(){this.apply(o,e||[])})}catch(e){if(r.Utils.isDefined(e)){r.log({type:"in PubSub "+n,data:e.message,trace:e.stack});var i={name:e.name,message:e.stack};window.onerror(e.name+": "+e.message,null,null,null,i)}}},subscribe:function(e,n){return a[e]||(a[e]=[]),a[e].push(n),[e,n]},unsubscribe:function(n){if(n){var t=n[0];a[t]&&o.each(a[t],function(e){a[t][e]===n[1]&&a[t].splice(e,1)})}},subscribeOnce:function(e,n){var t=this,i=this.subscribe(e,function(){n(),t.unsubscribe(i)})},clearHandlers:function(e){jQuery.each(e,function(e,n){t.unsubscribe(n)})}};return e}n.exports=i},{}],45:[function(e,n,t){n.exports={CB:"NativeCallback",NativeAPI:{startListenerSuccessKey:"startListenerSuccess",startListenerFailKey:"startListenerFailed",stopListenerSuccessKey:"stopListenerSuccess",stopListenerFailKey:"stopListenerFailed",initSuccessKey:"initSuccess",initFailKey:"initFailed",statusChanged:"ringerSwitchStatusChanged"},ControllerNativeAPI:{startListener:"startListener",stopListener:"stopListener",init:"init"},eventicsCategories:{startListenerFail:{name:"startListenerFail",id:263},stopListenerFail:{name:"stopListenerFail",id:264},initFail:{name:"initRingerFail",id:265}},notifyAdunitOnState:"ringerSwitchState",ringerNativeFunction:"ringerSwitchAPI"}},{}],46:[function(e,n,t){n.exports=function(n,t){var i,r,a,o=e("./RingerSwitchConstants.js"),s=!0,c=!1,l=1e3,d=!1;function u(e){t.postAdUnitEvent(JSON.stringify({name:o.notifyAdunitOnState,isRingerSwitchSilent:e}))}return{init:function(){var e;c||(n.PubSub.subscribe(o.CB+"."+o.NativeAPI.statusChanged,function(e){e&&(s=e.ringerSwitchSilent,d&&!s?r=setTimeout(function(){u(s)},i):(r&&clearTimeout(r),u(s)))}),n.PubSub.subscribe(o.CB+"."+o.NativeAPI.startListenerSuccessKey,function(e){t.log("Ringer | start detecting function performed successfully.",t.LogLevels.info)}),n.PubSub.subscribe(o.CB+"."+o.NativeAPI.startListenerFailKey,function(e){a.trackEvent(o.eventicsCategories.startListenerFail),e&&t.log("Ringer start detecting failed to perform, errorMsg:"+e.errMsg,t.LogLevels.info)}),n.PubSub.subscribe(o.CB+"."+o.NativeAPI.stopListenerSuccessKey,function(e){t.log("Ringer stop detecting successfully.",t.LogLevels.info)}),n.PubSub.subscribe(o.CB+"."+o.NativeAPI.stopListenerFailKey,function(e){a.trackEvent(o.eventicsCategories.stopListenerFail),e&&t.log("Ringer stop detecting failed to perform, errorMsg:"+e.errMsg,t.LogLevels.info)}),n.PubSub.subscribe(o.CB+"."+o.NativeAPI.initSuccessKey,function(e){t.log("Ringer prepare detector successfully.",t.LogLevels.info)}),n.PubSub.subscribe(o.CB+"."+o.NativeAPI.initFailKey,function(e){a.trackEvent(o.eventicsCategories.initFail),e&&t.log("Ringer prepare detector failed to perform, errorMsg:"+e.errMsg,t.LogLevels.info)}),t.log("Ringer | calling init native function",t.LogLevels.info),t.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.init},o.NativeAPI.initSuccessKey,o.NativeAPI.initFailKey),e={productChance:(t.getEnv(),1),baseData:{}},a=n.Eventics.createEventic(e),c=!0)},startListener:function(e){t.postAdUnitEvent(JSON.stringify({name:o.notifyAdunitOnState,isRingerSwitchSilent:s})),d=e&&e.shouldSetRingerUpdateDelay,i=e&&e.ringerUpdateDelay||l,t.log("Ringer | Set listener config to should delay?"+d+", with delay "+i,t.LogLevels.verbose),t.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.startListener},o.NativeAPI.startListenerSuccessKey,o.NativeAPI.startListenerFailKey)},stopListener:function(){d=!1,i=l,t.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.stopListener},o.NativeAPI.stopListenerSuccessKey,o.NativeAPI.stopListenerFailKey)},isInitiated:function(){return c}}}},{"./RingerSwitchConstants.js":45}],47:[function(i,e,n){e.exports=function(l,d,e){var n=i("../patches/PatchStoreKitOsVersion"),u="NativeCallback",t=!1;function f(e){return e.viewIdentifier?e.viewIdentifier:e.viewUniqueId}function g(e,n){var t={isViewable:e,changeReason:n};l.PubSub.publish(u+".viewableChange",[t])}function p(e){t=e}function v(e){if(m()){if(!e)return;d.callSDKFunction("clearAppPage",{viewUniqueId:e})}}function m(e){return!("ios"!==d.getApiData({deviceOs:1}).deviceOs||n(l.Utils,d.getCompatibilityService()).shouldBlock(d.getApiData({deviceOSVersion:1}).deviceOSVersion)||e&&!0===e.standaloneView||d.isLegacy(d.featureMap.hybrid))}return l.PubSub.subscribe("SDKController.PreloadAppInstallPage",function(e){d.checkRequiredCallbackParams(["appId"],e,"preloadAppInstallPage").didSucceed?function(n){var t,e,i=f(n),r=(e=n.productType)&&d.getApplicationExternalConfig().getABTestConfiguration(e).storeKitLoadingTimeout||3e4;if(m(n)){d.callSDKFunction("preLoadAppPage",{appId:n.appId,viewUniqueId:i},"preloadAppInstallPageSuccess","preloadAppInstallPageFailure");var a=l.PubSub.subscribe(u+".appStoreInsideLoaded",function(e){e&&"object"==typeof e&&e.viewUniqueId&&e.viewUniqueId===i&&(clearTimeout(t),l.PubSub.unsubscribe(a),n.callback&&n.callback.call(null,e))}),o=l.PubSub.subscribe(u+".appStoreInsideDisplayStoreKit",function(e){if(e.viewUniqueId=f(e),d.log("appStoreInsideDisplayStoreKit "+e.viewUniqueId,d.LogLevels.verbose),e.viewUniqueId===i){p(!0);var n=jQuery.extend({name:"appStoreInsideVisible"},e);l.PubSub.unsubscribe(o),d.postAdUnitEvent(JSON.stringify(n)),g(!1,"storeKitOpen")}}),s=l.PubSub.subscribe(u+".appStoreInsideClosed",function(e){if(e.viewUniqueId===i){if(!1===e.isClosed)return d.log("storeKit Failed to Load ",d.LogLevels.verbose),void c();p(!1);var n=jQuery.extend({name:"appStoreInsideClosed"},e);l.PubSub.unsubscribe(s),d.postAdUnitEvent(JSON.stringify(n)),g(!0,"storeKitClose")}}),c=function(){l.PubSub.unsubscribe(a),l.PubSub.unsubscribe(s),l.PubSub.unsubscribe(o)};t=setTimeout(function(){d.log("reach appstoreinside loading timeout",d.LogLevels.verbose),c(),v(i)},r)}}(e):d.log("error calling preload App install page with "+JSON.stringify(e),d.LogLevels.error)}),l.PubSub.subscribe("SDKController.ClearAppPage",function(e){e.viewUniqueId=f(e),d.checkRequiredCallbackParams(["viewUniqueId"],e,"ClearAppPage").didSucceed?e&&e.viewUniqueId&&v(e.viewUniqueId):d.log("error calling clear App install page with "+JSON.stringify(e),d.LogLevels.error)}),{isStoreKitSupported:m,updateAdWithStoreAppId:function(e,n){if(n&&(null===(i=n.extractAppIdForStoreKit)||!l.Utils.isDefined(i)||i)&&m(n)&&e&&e.ext&&e.ext.clickTags&&!e.ext.clickTags.storeAppId&&e.ext.clickTags.pixelURL){var t=d.AdUtils.getStoreAppId(e);t&&(e.ext.clickTags.storeAppId=t)}var i;return e},getViewUniqueId:f,isStoreKitVisible:function(){return t}}}},{"../patches/PatchStoreKitOsVersion":126}],48:[function(e,n,t){n.exports=function(i,r){return{shouldFetchNewFeedOnAdCloseFlag:function(e){var n=i.getConfig().controllerConfig||{};return!(!1===(n[r.sspProductNames[e]]||{}).shouldFetchNewFeedOnAdClose||!1===n.shouldFetchNewFeedOnAdClose)},getValueByKeyAndProductType:function(e,n){var t=i.getConfig().controllerConfig||{};return!!(t[r.sspProductNames[n]]||{})[e]||!!t[e]}}}},{}],49:[function(e,n,t){function i(o,r,s,c){function i(e,n){return e[0]&&n[0]?(e=new Date(e[0]))<(n=new Date(n[0]))?-1:n<e?1:0:0}function e(e,n){if(void 0===e&&(e=1),e=parseInt(e),n=parseInt(n),!isNaN(e)&&!isNaN(n))return e===n?0:n<e?1:-1;o.log("Function variables are not valid, must be numbers representation: versionToCheck ="+e+" , versionToCompareTo ="+n,o.LogLevels.error)}function n(e){try{return e()}catch(e){return!1}}var t={extend:function(e,n){jQuery.extend(e,n)},getScript:function(e,n,t){var i=s.createElement("script");i.src=e;var r=s.getElementsByTagName("head")[0],a=!1;i.onload=i.onreadystatechange=function(e){a||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(a=!0,n(e),i.onload=i.onreadystatechange=null,r.removeChild(i))},i.onerror=function(e){o.log(["script load error",e]),t&&t()},r.appendChild(i)},getQueryString:function(e,n,t){t=this.isDefined(t)?t:r.location.href,null===n&&(n=""),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null===i?n:i[1]},getUrlInfo:function(e){var n=s.createElement("a");return n.href=e,{host:n.hostname,port:n.port,path:n.pathname,protocol:n.protocol}},changeUrlProtocol:function(e,n){var t=s.createElement("a");return t.href=e,t.protocol=n,t.href},serialize:function(e){var n=[];for(var t in e)e.hasOwnProperty(t)&&n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.join("&")},isDefined:function(e){return typeof e!==c},isFunction:function(e){return"function"==typeof e},isString:function(e){return"string"==typeof e},parseJSON:function(e){var n={};if(!this.isString(e))return null;try{n=jQuery.parseJSON(e)}catch(e){o.log(e.message,o.LogLevels.error)}return n},getParams:function(e){var n,t=[],i=e.split("/"),r=i.length;if(-1===e.indexOf("JSON:")){if(2<=r&&r%2==0)for(n=0;n<r;n+=2)t[i[n]]=i.length>=n+1?decodeURIComponent(i[n+1]):null}else{var a=e.split("JSON:");typeof a[1]!==c&&(t=jQuery.parseJSON(a[1]))}return t},decodeValues:function(n){jQuery.each(n,function(e){n.hasOwnProperty(e)&&("string"==typeof n[e]&&(n[e]=decodeURIComponent(n[e])),"object"==typeof n[e]&&n[e]&&o.Utils.decodeValues(n[e]))})},renderTemplate:function(i,e){return e&&jQuery.each(e,function(e,n){var t=new RegExp("{{"+e+"}}","g");i=i.replace(t,n)}),i},isVisible:function(e){return"none"!==e.css("display")&&"hidden"!==e.css("visibility")},versionCompare:function(e,n){var t=function(e){1===e.length&&e.push("0"),2===e.length&&e.push("0")},i=function(n){jQuery.each(n,function(e){n[e]=parseInt(n[e])})};"5.02"===e&&(e="5.0.2");var r=e.split("."),a=n.split(".");t(r),t(a);try{i(r),i(a)}catch(e){throw"parse error"}return r[0]===a[0]?r[1]===a[1]?r[2]===a[2]?0:r[2]>a[2]?1:-1:r[1]>a[1]?1:-1:r[0]>a[0]?1:-1},returnResolvedPromise:function(){var e,n=new jQuery.Deferred;return 0<arguments.length&&(e=[].slice.call(arguments)),n.resolve.apply(n.resolve,e),n.promise()},returnRejectedPromise:function(){var e,n=new jQuery.Deferred;return 0<arguments.length&&(e=[].slice.call(arguments)),n.reject.apply(n.reject,e),n.promise()},replacePlaceHolder:function(e,n){var t;for(var i in n){t=n[i];var r=new RegExp(i+"|"+encodeURIComponent(i),"i");e=e.replace(r,"function"==typeof t?t():t)}return e},fileArrayIncludes:function(e,n){if(e||0===e.length)return!1;for(var t=0;t<e.length;t++)if(n===e[t])return!0;return!1},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){if(!e)return!0;if(this.isString(e)||this.isArray(e))return 0===e.length;for(var n in e)if(e.hasOwnProperty(n))return!1;return!0},sortDataByDateKey:function(e){var n=[];for(var t in e)n.push([t,e[t]]);return n.sort(i)},apiVersionCompareTo:e,isNestedObjectExists:n};return t}n.exports=i},{}],50:[function(e,n,t){n.exports=function(g,p){var v=e("../components/PixelTrackingService.js")(p),m=e("../components/FillRateTrackingService.js")(p,v),b=e("../components/ObfuscationService.js")(),h=e("../modules/DemandSource/EventCategories")(),S=e("./Constants"),y=p.DemandUtils,C={url:1,xmlResponse:2};function A(e){return e.ext.vastData?e.ext.vastData.xmlResponse:null}return{parseVast:function(e,n,t){var i,r,a=new jQuery.Deferred;r="prod"!==p.getEnv()?(i=e.settings.urltocdn+"/common/sdk/1.0.9/vastObfuscator.html",e.settings.urltocdn+"/common/sdk/1.0.9/vast-vmap.js"):(i=e.settings.urltocdn+"/common/sdk/1.0.9/vastObfuscator.4f4eb4fb.min.html",e.settings.urltocdn+"/common/sdk/1.0.9/vast-vmap.4f4eb4fb.min.js");var o,s,c,l=(c=A(o=e)?(s=A(o),C.xmlResponse):(s=o.ext.videoData.videoSource.vast,C.url),{adData:s,adSource:c});l.adSource===C.url&&(l.adData=function(e,n,t){if(e&&void 0!==e){var i;e=e.replace(S.vastRequestPlaceholders.moatEnabled,(i=n,p.MOATService.isInitialized()&&i?1:0));var r=t.requestID;r&&(e=e.replace(S.vastRequestPlaceholders.requestId,r));var a=function(e){var n=e.ext.opportunityID;if(e.ext.squeezeOpportunityIds&&"[object Array]"===Object.prototype.toString.call(e.ext.squeezeOpportunityIds)){var t=e.controllerSpace&&e.controllerSpace.viewCount||0;n=e.ext.squeezeOpportunityIds[t]}return n}(t);return a&&(e=e.replace(S.vastRequestPlaceholders.opportunityId,a)),e}}(l.adData,n,e));var d,u={adData:l.adData,style:"height:100%;",adUnitData:e,vastParserUrl:r,isAdDataTypeURL:(d=l,d.adSource===C.url)},f={adData:l.adData,url:i,templateClass:"obfuscationIframe",style:{width:"1px",height:"1px",border:"0"},id:e.vastIframeId};return function(t,n,e){var i,r;if("[object Array]"===Object.prototype.toString.call(t.ext.callbacks)){var a=t.controllerSpace&&t.controllerSpace.viewCount||0;i=t.ext.callbacks[a]}else i=t.ext.callbacks;var o=m.init(i),s=t.vastIframeId,c=g.PubSub.subscribe("SDKController.VastRequest",function(e){e.vastIframeId&&e.vastIframeId===s&&(o.track({trackingType:"request"}),g.PubSub.unsubscribe(c))}),l=g.PubSub.subscribe("SDKController.VastResponse",function(e){e.vastIframeId&&e.vastIframeId===s&&(clearTimeout(r),"hit"===e.result?(o.track({trackingType:"responseHit"}),b.removeIframe(s),g.PubSub.unsubscribe(l),n.resolve(e.data)):(o.track({trackingType:"responseMiss",data:e.data}),b.removeIframe(s),g.PubSub.unsubscribe(l),n.reject({errMsg:e.data})))}),d=e&&e>S.vastMinimumResponseTimeout?e:S.vastResponseTimeout;r=setTimeout(function(){g.PubSub.unsubscribe(l),g.PubSub.unsubscribe(c),g.PubSub.unsubscribe(u),clearTimeout(r),n.reject({isTimeLimitReached:!0,errMsg:"timeout"})},d);var u=g.PubSub.subscribe("SDKController.VastErrorPixel",function(e){e.vastIframeId&&e.vastIframeId===s&&(v.firePixel(e),b.removeIframe(s),g.PubSub.unsubscribe(u))}),f=g.PubSub.subscribe("SDKController.parseVastInfo",function(e){if(e.vastIframeId&&e.vastIframeId===s){g.PubSub.unsubscribe(f);var n=y.extendCallbackParamsWithParentProductConfig(t,{action:"fireEvent",eventParam:{eName:h.parseVastInfo,label:{},data:{generalMessage:e.data}}});g.PubSub.publish("SDKController.Analytics",[n])}})}(e,a,t.vastTimeOut),b.init(f,function(e){g.Msg.postMessage("$$JSON:"+JSON.stringify(u),i,e[0].contentWindow)}),a.promise()},removeIframe:function(e){b.removeIframe(e)}}}},{"../components/FillRateTrackingService.js":15,"../components/ObfuscationService.js":36,"../components/PixelTrackingService.js":43,"../modules/DemandSource/EventCategories":78,"./Constants":9}],51:[function(e,n,t){n.exports=function(r){var a,o,s,c,l=e("../components/Constants.js"),d=null;return{init:function(e){var n;d=new jQuery.Deferred,a=(n=e).settings&&n.settings.standaloneView,(o=e.ext&&e.ext.isHybridFlow||!1)?l.viewsStates.hybrid:l.viewsStates.normal,s=e.ext&&e.ext.viewUniqueId||"";var t,i=JSON.stringify(l.hybridViews);c={standaloneView:a,viewUniqueId:s},o?(c.hybridView=o,c.hybridJson=i,t=r.PubSub.subscribe("ViewsManager.viewClosed",function(e){d.resolve(),r.PubSub.unsubscribe(t)})):d.resolve({})},waitForAllViews:function(){return d.promise()},isHybridFlow:function(){return isHybrid},getDisplayWebViewParams:function(e){return c=jQuery.extend(c,{display:e})}}}},{"../components/Constants.js":9}],52:[function(o,e,n){e.exports=function(u,f,g,p,v,e,m,b,n,h,S,y,t,i,C,A,a){var c=new(o("../IframeManager.js"))(f,p,v,e,t,i,a),D=n.style.backgroundColors,r=n.style.forceCloseProperties,l={none:0,device:1,controller:2},I=function(){var a=!1,o=!1,s=!1,c=null,i={on:!1,productConfig:null};function l(){f.log("Webview state- open: "+a+", viewable: "+o+", productConfig: "+JSON.stringify(c),f.LogLevels.verbose)}function e(e,n){var t;switch(f.log("received event: "+e+" sendCloseRequest: "+JSON.stringify(i),f.LogLevels.verbose),e){case"close":I.shouldNotifyClose(n)&&(t=y.extendCallbackParamsWithParentProductConfig(n),u.PubSub.publish("SDKController.onAdWindowsClosed",[t]),f.callSDKFunction("onAdWindowsClosed",t));break;default:f.log("received event: "+e,f.LogLevels.verbose)}}function d(e,n){var t=r[g.mobileSDKSettings.deviceOs+e]?e:"Neutral",i=v.extend({},r[g.mobileSDKSettings.deviceOs+t]);n&&(i.position=n),f.callSDKFunction("setForceClose",i)}return u.PubSub.subscribe("SDKController.SetForceClose",function(e){var n;n=e,!u.Utils.isDefined(n.isEnable)||n.isEnable?I.changeMode("Neutral",n.position):I.disableForceClose()}),{display:function(e){if(e){if(g.mobileSDKSettings.deviceOs===p.deviceOs.ios&&(a||o)&&C.supportOrientation)f.log("avoiding setOrientation for new displayed ad",f.LogLevels.verbose);else{var n=b.getAdDisplayOrientation(g,h,e);S.setOrientation(n)}if(a||o)return f.log("line[882]: be might here because of next offer, engaged is "+s,f.LogLevels.verbose),void(s=!0);var t;t=e,u.Utils.isDefined(t)&&u.Utils.isDefined(t.productType)?f.getNotchService().onSetConfig(t)?(T(D.semiTransparent),L(D.semiTransparent)):t.settings.setContainerBGColorBlack?L(D.black):(T(P(t.productType)),L(w(t.productType))):L(D.darkGrey),d(t.productType),I.loadProduct(e),m.init(e);var i=y.extendCallbackParamsWithParentProductConfig(e,m.getDisplayWebViewParams(!0)),r=function(e){var n={};if(g.mobileSDKSettings.deviceOs===p.deviceOs.android&&!C.supportImmersive){var t=e.settings&&e.settings.immersive;v.extend(n,{immersive:t})}return C.translucent||(n.activityThemeTranslucent=!!e.settings.translucentView),g.mobileSDKSettings.deviceOs===p.deviceOs.ios&&v.extend(n,{appOrientation:A.getOrientation(),ModalPresentationStyle:p.iOS_UIModalPresentationFullScreen}),n}(e);f.log("displayWebView platformParams: "+JSON.stringify(r),f.LogLevels.verbose),f.log("displayWebView displayParams: "+JSON.stringify(i),f.LogLevels.verbose),f.callSDKFunction(p.nativeInterfaceMethod.displayWebView,v.extend(r,i,{integrationType:f.AdUtils.getIntegrationType(e)})),a=!0,l()}},hide:function(){a&&function(){var e,n,t=new v.Deferred,i=function(){u.PubSub.unsubscribe(e),u.PubSub.unsubscribe(n),t.resolve()};f.log("line[882]:"+JSON.stringify(c),f.LogLevels.verbose);var r=f.DemandUtils.extendCallbackParamsWithParentProductConfig(c,f.ViewsManager.getDisplayWebViewParams(!1));return r.integrationType=c.integrationType,C.supportAdCloseCB?(e=u.PubSub.subscribe(p.CB+"."+p.nativeCallBacks.hideSuccess,i),n=u.PubSub.subscribe("SDKController.HybridAdDidClosed",i)):t.resolve(),f.callSDKFunction(p.nativeInterfaceMethod.displayWebView,r,p.nativeCallBacks.hideSuccess,p.nativeCallBacks.hideFailed),window.timerService.stopTimer(window.lastWebviewClosedTimer),window.lastWebviewClosedTimer=window.timerService.startTimer(),t.promise()}().then(function(){a=!1,i.productConfig=c,i.on=!0,s||e("close",c),l()})},setVisibility:function(e){o=e,l()},shouldNotifyClose:function(e){return i.on&&i.productConfig===e?(i.on=!1,i.productConfig=null,l(),!0):(l(),!1)},loadProduct:function(e){c=y.extendCallbackParamsWithParentProductConfig(e,{integrationType:f.AdUtils.getIntegrationType(e)}),s=!0,l()},unloadProduct:function(){s=!1,i.on&&e("close",c),l()},changeMode:function(e,n){d(e,n)},disableForceClose:function(){f.callSDKFunction("setForceClose",r.disable)},setWebviewBGColorTransparent:function(){L(D.transparent)},getState:function(){return{engaged:s,opened:a,productConfig:c,viewable:o,standalone:!1}}}}();function w(e){var n;switch(e){case p.IS:case p.WebControls:n=D.transparent;break;case p.OW:case p.RV:case p.BC:n=D.darkGrey;break;default:n=D.darkGrey}return n}function P(e){var n;switch(e){case p.IS:case p.WebControls:n=D.transparent;break;case p.OW:case p.RV:case p.BC:n=D.black;break;default:n=D.black}return n}function L(e){e&&(f.log("ContainerManager | setControllerBGColor | color: "+e),v("body").css("background",e))}function T(e){e&&(f.log("ContainerManager | setSDKWebviewBGColor | color: "+e),f.callSDKFunction("setWebviewBackgroundColor",{color:e}))}function d(e,n,t){var i=v("#ssaNavigator"),r=a.getDisplayedAdType();g.mobileSDKSettings.deviceOs!==p.deviceOs.android&&v("body").css("height",n.scrollHeight),L(w(r)),T(P(r)),c.displayFrame(),f.callSDKFunction("setBackButtonState",{state:l.controller}),e(!1,!1,null),I.changeMode("Neutral"),t(),i.removeClass("webNavigation").addClass("defaultNavigation"),g.mobileSDKSettings.deviceOs!==p.deviceOs.android&&setTimeout(function(){f.callSDKFunction("navigationModeChange",{state:!1})},70)}return{createAndLoadAdFrame:c.createAndLoadAdUnitFrame,displayAdFrame:c.displayAdUnitFrame,unloadAdFrame:c.unloadAdUnitFrame,updateFrameUrl:c.updateAdUnitUrl,getContainerState:I.getState,displayContainer:I.display,hideContainer:I.hide,setContainerVisibility:I.setVisibility,changeContainerMode:I.changeMode,unloadProductFromContainer:I.unloadProduct,setContainerBGColorTransparent:I.setWebviewBGColorTransparent,handleScreenVisible:c.handleScreenVisible,displayLoader:c.displayLoader,hideLoader:c.hideLoader,setSDKWebviewBGColor:T,changeToNavigationMode:function(e,n,t,i){var r,a,o,s=v("#ssaNavigator");v("body").css("height",""),T(P(p.WebControls)),L(w(p.WebControls)),I.changeMode("Navigation"),c.hideFrame(),c.hideLoader(),f.callSDKFunction("setBackButtonState",{state:l.device}),e(!1,null),r=e,a=t,o=i,n.unbind("touchend").bind("touchend",function(e){e.stopPropagation(),e.preventDefault(),v("#ssaNavigatorBackButton").unbind("touchend"),f.callSDKFunction("controlSecondaryWebView",{action:"close"}),f.callSDKFunction("removeCloseEventHandler"),d(r,a,o)}),v("#ssaNavigatorBackButton").unbind("touchend").bind("touchend",function(e){e.stopPropagation(),e.preventDefault(),f.callSDKFunction("removeCloseEventHandler"),f.callSDKFunction("controlSecondaryWebView",{action:"back"})}),s.removeClass("defaultNavigation").addClass("webNavigation"),f.callSDKFunction("navigationModeChange",{state:!0})},returnFromNavigationMode:d,isContainerLoaded:c.isContainerLoaded,onAdUnitLoaded:c.onAdUnitLoaded,getAdFrameByProductAndId:c.getAdFrameByProductAndId}}},{"../IframeManager.js":22}],53:[function(e,n,t){n.exports={CB:"NativeCallback",NativeAPI:{loadWithUrl:"loadWithUrl",updateAd:"updateAd",isExternalAdViewInitiated:"isExternalAdViewInitiated",sendMessage:"sendMessage",getViewVisibility:"handleGetViewVisibility"},nativeFunction:"bannerViewAPI",handleContainerIsVisible:"containerIsVisible",handleContainerWasRemoved:"containerWasRemoved",handleIsInitiated:"containerAdViewStatus",handleIsInitiatedFailure:"containerAdViewStatusFailure",handleAdReplaced:"containerAdReplaced",handleMessage:"containerSendMessage",handleLoadWithUrlSuccess:"handleLoadWithUrlSuccess",handleLoadWithUrlFailure:"handleLoadWithUrlFailure",handleUpdateAdSuccess:"handleUpdateAdSuccess",handleUpdateAdFailure:"handleUpdateAdFailure",handleSendMessageSuccess:"handleSendMessageSuccess",handleSendMessageFailure:"handleSendMessageFailure",handleGetViewVisibilitySuccess:"handleGetViewVisibility",handleGetViewVisibilityFailure:"handleGetViewVisibilityFailure"}},{}],54:[function(e,n,t){n.exports=function(o,s,c,i,n){var r,a,l=e("./ExternalAdViewConstants.js"),t=[],d=[];function u(){var e=n.get();e&&e.productType&&e.productType===c.BN&&n.reset()}function f(e){return!!e&&e.isViewVisible}function g(e){s.log("ExternalAdViewService | sendMessage | "+JSON.stringify(e));var n=o.PubSub.subscribe(c.CB+"."+l.handleSendMessageFailure,function(e){e&&e.errMsg&&s.log("Error calling "+l.handleSendMessageFailure+" with error "+e.errMsg,s.LogLevels.error),o.PubSub.unsubscribe(n)}),t=e.indexOf("$$");-1!==t&&(e=function(e,n){var t={};t.name=e.substr(0,n);var i=e.substr(n+2),r=i.indexOf("="),a=i.substr(0,r),o=i.substr(r+1);return t[a]=o,JSON.stringify(t)}(e,t)),s.callSDKFunction(l.nativeFunction,{functionName:l.NativeAPI.sendMessage,functionParams:{params:e}},l.handleSendMessageSuccess,l.handleSendMessageFailure)}var p=function(e,n){s.log("ExternalAdViewService | send message to adview"+e,s.LogLevels.error),g(e)};return{init:function(){t.push(o.PubSub.subscribe(c.CB+"."+l.handleContainerIsVisible,function(e){!e.configs&&e.configs.productType&&e.configs.visibilityParams||(s.log("ExternalAdViewService | "+l.handleContainerIsVisible,s.LogLevels.verbose),f(e.configs.visibilityParams)&&o.PubSub.publish(e.configs.productType+".isVisible",[e.configs]))})),t.push(o.PubSub.subscribe(c.CB+"."+l.handleContainerWasRemoved,function(e){s.log("ExternalAdViewService | "+l.handleContainerWasRemoved,s.LogLevels.error);for(var n=!1,t=0;!n&&t<d.length;t++)d[t].id===e.configs.externalAdViewId&&(n=!0,d.splice(t,1));n||s.log("ExternalAdViewService | "+l.handleContainerWasRemoved+"trying to remove container "+e.configs.externalAdViewId+" that does not exist",s.LogLevels.error),u(),o.PubSub.publish(e.configs.productType+".reset",[e.configs])})),t.push(o.PubSub.subscribe(c.CB+"."+l.handleMessage,function(e){!function(n){try{s.log("ExternalAdViewService | handleMessageFromAdunit | "+JSON.stringify(n));var e=(t=n.id,function(e){p(JSON.stringify({data:e,id:t}),!0)});o.Utils.decodeValues(n.arguments),i.extend(n.arguments,{callback:e}),o.PubSub.publish("SDKController."+n.method,[n.arguments])}catch(e){s.log("ExternalAdViewService | unable to parse message: "+n,s.LogLevels.error)}var t}(e)}))},destroy:function(){for(var e in t)o.PubSub.unsubscribe(e)},loadWithUrl:function(e,n,t,i){s.log("ExternalAdViewService | _loadWithUrl | "+e),s.AdUtils.extendAdObjectWithConfig(e,n,t,i);var r=o.PubSub.subscribe(c.CB+"."+l.handleLoadWithUrlFailure,function(e){e&&e.errMsg&&(s.log("Error calling "+l.handleLoadWithUrlFailure+" with error "+e.errMsg,s.LogLevels.error),u(),o.PubSub.publish("SDKController.AdLoadError",[e])),o.PubSub.unsubscribe(r)});s.callSDKFunction(l.nativeFunction,{functionName:l.NativeAPI.loadWithUrl,functionParams:{urlForWebView:e}},l.handleLoadWithUrlSuccess,l.handleLoadWithUrlFailure)},updateAd:function(e,n,t,i){s.log("ExternalAdViewService | _updateAd | "+JSON.stringify(n));var r={name:"updateAd",param:n};s.AdUtils.extendAdObjectWithConfig(e,n,t,i);var a=o.PubSub.subscribe(c.CB+"."+l.handleUpdateAdFailure,function(e){e&&e.errMsg&&s.log("Error calling "+l.handleUpdateAdFailure+" with error "+e.errMsg,s.LogLevels.error),o.PubSub.unsubscribe(a)});s.callSDKFunction(l.nativeFunction,{functionName:l.NativeAPI.updateAd,functionParams:{params:JSON.stringify(r)}},l.handleUpdateAdSuccess,l.handleUpdateAdFailure)},sendMessage:g,isContainerVisible:f,isExternalAdViewInitiated:function(){if(s.log("ExternalAdViewService | isExternalAdViewInitiated |"),r&&"pending"===r.status)return r;r=new i.Deferred;var n=o.PubSub.subscribe(c.CB+"."+l.handleIsInitiated,function(e){s.log("ExternalAdViewService | "+l.handleIsInitiated+" "+JSON.stringify(e)),o.PubSub.unsubscribe(n),o.PubSub.unsubscribe(t),r.resolve(e)}),t=o.PubSub.subscribe(c.CB+"."+l.handleIsInitiatedFailure,function(e){e&&e.errMsg&&s.log("Error calling "+l.handleIsInitiatedFailure+" with error "+e.errMsg,s.LogLevels.error),o.PubSub.unsubscribe(t),o.PubSub.unsubscribe(n),r.reject(e)});return s.callSDKFunction(l.nativeFunction,{functionName:l.NativeAPI.isExternalAdViewInitiated},l.handleIsInitiated,l.handleIsInitiatedFailure),r.promise()},addExternalAdViewIdAndSetStatus:function(e){s.log("ExternalAdViewService | _addExternalAdViewIdAndSetStatus",s.LogLevels.error);for(var n=e.externalAdViewId,t=e.isInReload,i=!1,r=0;r<d.length;r++){var a=d[r];a.id===n&&(i=!0,a.isInReload=t,s.log("ExternalAdViewService | _addExternalAdViewIdAndSetStatus | changed isInReload to "+t,s.LogLevels.error))}i?s.log("ExternalAdViewService | _addExternalAdViewIdAndSetStatus | "+n+" has been previously added",s.LogLevels.error):(0!==d.length&&(d=[]),d.push({id:n,isInReload:t}))},getViewVisibility:function(){if(s.log("ExternalAdViewService | _getViewVisibility"),a&&"pending"===a.status)return a;a=new i.Deferred;var n=o.PubSub.subscribe(c.CB+"."+l.handleGetViewVisibilitySuccess,function(e){s.log("ExternalAdViewService | "+l.handleGetViewVisibilitySuccess+" "+JSON.stringify(e)),o.PubSub.unsubscribe(n),o.PubSub.unsubscribe(t),a.resolve(e)}),t=o.PubSub.subscribe(c.CB+"."+l.handleGetViewVisibilityFailure,function(e){e&&e.errMsg&&s.log("Error calling "+l.handleGetViewVisibilityFailure+" with error "+e.errMsg,s.LogLevels.error),o.PubSub.unsubscribe(t),o.PubSub.unsubscribe(n),a.reject(e)});return s.callSDKFunction(l.nativeFunction,{functionName:l.NativeAPI.getViewVisibility},l.handleGetViewVisibilitySuccess,l.handleGetViewVisibilityFailure),a.promise()},resetExternalAdViewsIdentifiers:function(){d=[]}}}},{"./ExternalAdViewConstants.js":53}],55:[function(f,e,n){e.exports=function(e,n,t,i,r){var a,o=!1,s=!1;function c(e){s=e}function l(e){o=e}function d(){c(!1),l(!1)}function u(){return s&&!o}return{initExternalContainer:function(){(a=new(f("./ExternalAdViewService.js"))(e,n,t,i,r)).init(),e.PubSub.subscribe("SDKController.AdVisible",function(e){e&&e.productType===t.BN&&l(!0)})},setAdIsLoadedInContainer:c,setAdIsVisibleInContainer:l,resetReportAdVisibilityFlags:d,shouldReportAdVisible:u,checkStatusOfAdView:function(){return a.isExternalAdViewInitiated()},createAdUrlInAdView:function(e,n,t,i){d(),a.loadWithUrl(e,n,t,i)},updateAdInAdView:function(e,n,t,i){d(),a.updateAd(e,n,t,i)},sendMessageToExternalAdView:function(e){a.sendMessage(e)},addExternalAdViewIdAndSetStatus:function(e){a.addExternalAdViewIdAndSetStatus(e)},onExternalViewLoaded:function(n,t){a.getViewVisibility().then(function(e){a.isContainerVisible(e)&&(n(),u()&&t())})},resetExternalAdViewsIdentifiers:function(){a.resetExternalAdViewsIdentifiers()}}}},{"./ExternalAdViewService.js":54}],56:[function(e,n,t){n.exports={NativeAPI:{failCallback:"updateTokenFail",successCallback:"updateTokenSuccess"},ControllerNativeAPI:{updateToken:"updateToken"},iabTokenAPI:"iabTokenAPI",payloadKeys:{common:{biddingRVImpressions:!0,biddingISImpressions:!0,totalRVSessionImpressions:!0,totalISSessionImpressions:!0},android:{gpi:!0,androidIsVersion:!0,blacklistedCampaigns:!0},ios:{}}}},{}],57:[function(o,e,n){e.exports=function(e,r,n,t,i){var a=o("./IABConstants.js");return e.PubSub.subscribe(n.CB+"."+a.NativeAPI.failCallback,function(e){r.log("IABService | updateTokenFail: "+JSON.stringify(e));var n=e.errMsg?e.errMsg:"unknown";t.trackEvent(i.updateTokenFail,{generalMessage:n})}),{updateToken:function(e){if(!r.isLegacy(r.featureMap.IAB)){var n=function(e){if(!e)return{};var n={},t=a.payloadKeys.common;for(var i in jQuery.extend(t,a.payloadKeys[r.getConfig().mobileSDKSettings.deviceOs]),t)t.hasOwnProperty(i)&&e.hasOwnProperty(i)&&(n[i]=e[i]);return n}(e);r.log("IABService | _updateNativeToken | data: "+JSON.stringify(n)),0!==Object.keys(n).length&&r.callSDKFunction(a.iabTokenAPI,{functionName:a.ControllerNativeAPI.updateToken,functionParams:n},null,a.NativeAPI.failCallback)}}}}},{"./IABConstants.js":56}],58:[function(t,e,n){e.exports=function(i,e,n){var r,a,s=t("../OrientationUtils.js")(),o=n.appInfo.orientation.none,c=!1,l={free:n.appInfo.orientation.none,portrait:n.appInfo.orientation.portrait,landscape:n.appInfo.orientation.landscape};function d(e,n,t){c=!1;var i=l[(e||"").toLowerCase()];if(i)return c=!0,i;if(!t)return n;var r,a=s.sharedOrientationBetweenOrientations(t.viewControllerToPresentFrom||t.topMostViewControllerOrientation,t.windowOrientation),o=(r=(a&&0<a.length?s.convertOrientationsArrayToNumber(a):t.windowOrientation).toString(),s.isContainPortrait(r)&&s.isContainLandscape(r)?l.free:s.isContainPortrait(r)?l.portrait:l.landscape);return o!==n&&(c=!0),o}return{init:function(e,n){r=e,a=n.appOrientation,o=d(r,a,n.orientationRestriction)},getOrientation:function(){return o},isAppOrientation:function(e){return o===e},isChangedExternally:function(){return c},updateAppOrientationByNewRestriction:function(e){if(e){var n,t=o;o=d(r,a,e),t!==(n=o)&&i.PubSub.publish("AppOrientationManager.appOrientationChanged",[{appOrientation:n}])}}}}},{"../OrientationUtils.js":40}],59:[function(e,n,t){function i(r,a,e){var o=e||{},n,s,c=!1,l=a.Cache,d={campaignsOnly:"campaignsOnly",globalsOnly:"globalsOnly",globalsAndCampaigns:"globalsAndCampaigns"},t=!1,u=a.jQuery();function f(e){t=e}function g(e,n,t){return l.cacheAds(o,e,n,t)}function p(e,n,t){return setTimeout(function(){!0,a.log("Time out in update cache. Fallback to non-precache.",a.LogLevels.error),r.PubSub.publish("PrecacheManager.fallbackToNonPrecache",[{demandSourceName:o.demandSourceName,productType:o.productType}]),i(!1),r.PubSub.publish("Cache.StopCacheUpdate",[{demandSourceName:o.demandSourceName,productType:o.productType}]),f(!1),l.clearCacheByType(o,[]).then(function(){n()}).fail(function(){var e="Error deleting globals in fallback to NPC";a.log(e,a.LogLevels.error),t(e)})},o.nonPrecacheFallback)}function i(e){n=e}function v(i){s=p(c,i.cacheTimeoutSuccessCallback,i.cacheTimeoutFailCallback),f(!0),g(i.applicationKey,i.newAdsToEnterCache,i.adAssetsCacheConfig).then(function(){a.log("PM | success",a.LogLevels.verbose),clearTimeout(s),c||(a.log("cache update completed",a.LogLevels.verbose),f(!1),r.PubSub.publish("PrecacheManager.cacheAdsSuccessCallback",[o]))},function(e,n,t){if(clearTimeout(s),!c){f(!1),r.PubSub.publish("PrecacheManager.cacheAdsFailedCallback",[{productType:o.productType,demandSourceName:o.demandSourceName,deletedOffers:n,deletedAdsData:t,errorLog:"Error adding new ads from queue, some campaigns were deleted.",cacheParam:e,inventoryId:i.inventoryId}])}})}function m(e){u.extend(o,e),a.log("PM | updateConfig updated config"+JSON.stringify(o),a.LogLevels.verbose)}function b(e){var n=e.numOfCampaigns||0,t=e.settings||{};return m({settings:t}),0<=t.numOfBannersToInitSuccess&&0<n&&0<t.numOfBannersToCache?(t.numOfBannersToCache<t.numOfBannersToInitSuccess&&(t.numOfBannersToInitSuccess=t.numOfBannersToCache),n<t.numOfBannersToInitSuccess&&(t.numOfBannersToInitSuccess=n),n<t.numOfBannersToCache&&(t.numOfBannersToCache=n),i(!0),t.maxCachedCampaigns=o.maxCachedCampaigns,l.setSettings(o,t)):(t.numOfBannersToInitSuccess=t.numOfBannersToCache=0,i(!1)),r.Utils.returnResolvedPromise()}function h(e){return e&&e.cacheBase===o.cacheBase}function S(){r.PubSub.subscribe("Cache.cacheUpdated",function(e){h(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.cacheUpdatedCallback",[e]))}),r.PubSub.subscribe("Cache.campaignDeleted",function(e){h(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.campaignDeletedCallback",[e]))}),r.PubSub.subscribe("Cache.campaignSaved",function(e){h(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.campaignSavedCallback",[e]))}),r.PubSub.subscribe("Cache.campaignDownloadStarted",function(e){h(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.campaignDownloadStartedCallback",[e]))}),r.PubSub.subscribe("Cache.preProcessingFailed",function(e){h(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.preProcessingFailedCallback",[e]))})}function y(){return n}function C(){var e,n,t=new u.Deferred,i=y();function r(e){t.resolve(e)}return o.settings.purgeCacheOnInit?(n="purge cache on init (settings)",e=!0):i||(n="purge cache on non-precache",e=!0),e?(a.log("handleCacheClear purge reason: "+n,a.LogLevels.verbose),l.clearCacheByType(o,[]).then(r.bind(null,d.campaignsOnly),function(){t.reject("Error in clearing cache")})):r(),t.promise()}function A(e){y()&&(f(!0),l.cacheNext(o,e).always(function(){f(!1)}).fail(function(e,n,t){a.log("line[451]: failed updating cache on cache next with deletedAds: "+n,a.LogLevels.verbose),n&&0<n.length&&r.PubSub.publish("PrecacheManager.cacheNextFail",[{productType:o.productType,demandSourceName:o.demandSourceName,deletedAds:n,deletedAdsData:t,inventoryId:n[0].inventoryId}])}))}function D(){return d}function I(){return l.getNextAvailableAd(o)}function w(e){return l.clearCacheByType(o,e)}function P(e,n){return n=r.Utils.isDefined(n)?n:o.settings.numOfBannersToCache,l.mergeCampaigns(e,n,o.settings.maxCachedCampaigns,o)}function L(e,n){return l.areCampaignsAvailable(e,n,o)}function T(){return l.getCacheSizeByType(o)}function O(){return l.incrementNextCampaign(o)}function F(e){return l.getCurrentAd(o,e)}function U(e){return l.isNextAvailable(o,e)}function x(){return l.cacheNext(o)}function N(e,n){return l.setAdInventoryIndex(o,e,n)}function M(e){return l.isAdInCache(o,e)}function k(e){return l.setSettings(o,e)}function B(){S(),l.initCacheBase(o.cacheBase)}function E(e){return l.getAdStatusInQueue(o,e)}function V(e){return l.deleteCachedCampaign(o,e)}function R(e,n){return l.cacheSingleAd(o,e,n)}var K={updateConfig:m,init:B,decidePrecacheStatus:b,isPrecache:y,handleCacheClear:C,mergeCampaigns:P,handleCacheAds:v,updateCache:A,clearCacheByType:w,areCampaignsAvailable:L,getCacheSizeByType:T,setAdInventoryIndex:N,incrementNextCampaign:O,getCurrentAd:F,isAdInCache:M,getAdStatusInQueue:E,setCacheSettings:k,getNextAvailableAd:I,isNextAvailable:U,getCacheClearMessages:D,cachingStatus:l.cachingStatus,deleteCachedCampaign:V,cacheSingleAd:R};return K}n.exports=i},{}],60:[function(e,n,t){n.exports=function(i){var r=e("./SDKPluginTypeConstants.js");return{shouldShowInStandAloneView:function(e){var n=e.getApplicationExternalConfig().getGeneralConfig()[r.microJobFlags.showStandaloneViewInAdobe];null!==n&&i.isDefined(n)||(n=!0);var t=!e.isLegacy(e.featureMap.showStandaloneViewInAdobe)&&n;return e.log("AdobeAirPluginHandler | shouldShowInStandAloneView | useStandAloneView: "+t),t}}}},{"./SDKPluginTypeConstants.js":61}],61:[function(e,n,t){n.exports={supportedPluginNames:{adobeAir:"AdobeAir"},microJobFlags:{showStandaloneViewInAdobe:"showStandaloneViewInAdobe"}}},{}],62:[function(o,e,n){e.exports=function(t,i){var r=o("./SDKPluginTypeConstants.js");function a(e){return(n=e).applicationSettings&&n.applicationSettings.SDKPluginType&&n.applicationSettings.SDKPluginType===r.supportedPluginNames.adobeAir?(t.log("SDKPluginTypeHandler | createPluginHandler | creating adobe handler"),new(o("./AdobeAirPluginHandler.js"))(i)):(t.log("SDKPluginTypeHandler | createPluginHandler | plugin handler is not required"),null);var n}return{shouldShowInStandAloneView:function(e){t.log("SDKPluginTypeHandler | shouldShowInStandAloneView");var n=a(e);return n&&"function"==typeof n.shouldShowInStandAloneView?n.shouldShowInStandAloneView(t):(t.log("SDKPluginTypeHandler | shouldShowInStandAloneView | "+(n?"function not supported in handler":"no plugin handler")),!1)}}}},{"./AdobeAirPluginHandler.js":60,"./SDKPluginTypeConstants.js":61}],63:[function(e,n,t){n.exports={storeKitDismissVCOnFinishCallback:"storeKitDismissVCOnFinishCallback"}},{}],64:[function(e,n,t){n.exports={userData:{ios:"5.1",android:"5.1"},loadIS:{ios:"5.7",android:"5.10"},selfLoadingIS:{ios:"5.19",android:"5.20"},supportImmersive:{ios:"99",android:"5.26"},rvPortraitOrientation:{ios:"5.30",android:"5.30"},MDS:{RewardedVideo:{ios:"5.29",android:"5.29"},Interstitial:{ios:"5.48",android:"5.48"},Banner:{ios:"5.51",android:"5.51"}},nativeHttpEngine:{ios:"5.36",android:"99"},translucent:{ios:"99",android:"5.37"},hybrid:{ios:"5.40",android:"99"},supportOrientation:{ios:"5.39",android:"99"},androidIsVersion:{ios:"99",android:"5.39"},postAdEventNotification:{ios:"5.43",android:"5.43"},MOAT:{ios:"5.46",android:"5.46"},demandState:{ios:"5.47",android:"5.47"},ringerSwitch:{ios:"5.48",android:"99"},appOrientationRestrictions:{ios:"5.50",android:"99"},GDPRSupport:{ios:"5.51",android:"5.51"},adCloseCB:{ios:"5.51",android:"99"},showStandaloneViewInAdobe:{ios:"5.54",android:"99"},IAB:{ios:"5.62",android:"5.63"},messageSecurity:{ios:"99",android:"5.70"},OMID:{ios:"5.67",android:"5.74"},getTokenSupport:{ios:"5.66",android:"5.73"}}},{}],65:[function(e,n,t){var u={ext:{clickTags:{backgroundLandscape:"",backgroundPortrait:""},videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},appData:{appIcon:"",appImages:{both:[],portrait:[],landscape:[]}}}},f={ext:{videoData:{videoSource:{vast:""}}}},g={ext:{vastData:{xmlResponse:""}}},p={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},appData:{appIcon:{url:""},appImages:[{url:""}]},imageData:{landscape:"",portrait:""}}},v={ext:{imageData:{landscape:"",portrait:""},layoutData:{portrait:{closeButtonUrl:"",frameUrl:""},landscape:{closeButtonUrl:"",frameUrl:""}}}},m={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},layoutData:{html:""}}},b={ext:{videoData:{videoSource:{videoformat_mp4:""}},clickTags:{backgroundLandscape:""}}},h={ext:{videoData:{videoSource:{html:""}}}},S={ext:{videoData:{videoSource:{videoformat_mp4:""}},appData:{appIcon:""}}},y={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},imageData:{landscape:"",portrait:""},layoutData:{portrait:{closeButtonUrl:"",frameUrl:""},landscape:{closeButtonUrl:"",frameUrl:""}}}};n.exports=function(){var s=function(e,n){return n+e.split("/").pop()},r=function(e,n){for(var a=[],t=Object.keys(n),i=0;i<t.length;i++)e[t[i]]&&o(n[t[i]],e[t[i]]);function o(e,n){var t,i;if("string"==typeof e)a.push(n);else if(e instanceof Array&&0===e.length)a=a.concat(n);else if(e instanceof Array&&0<e.length&&n instanceof Array&&0<n.length)for(t=0;t<n.length;t++)for(i=0;i<e.length;i++)o(e[i],n[t]);else{var r=Object.keys(e);for(t=0;t<r.length;t++)n[r[t]]&&o(e[r[t]],n[r[t]])}}return a};function o(e){return!!e.src&&e.src}function c(e){var n,t=r(e,d(e)),i=0<t.length&&t[0];return!!i&&((n=document.createElement("div")).innerHTML=i,n.firstChild)}function l(e){return e.ext&&e.ext.ableToCache}function i(e){return e&&e.type&&"playableAd"===e.type}function a(e){return e.ext.videoData&&e.ext.videoData.videoSource&&e.ext.videoData.videoSource.videoformat_mp4}function d(e){if(e.ext)return e.ext.layoutData?e.ext.layoutData.portrait&&e.ext.layoutData.landscape?a(e)?y:v:m:e.ext.appData&&e.ext.appData.appImages&&Array.isArray(e.ext.appData.appImages)?p:e.ext.clickTags&&e.ext.clickTags.backgroundLandscape&&e.ext.videoData.videoformat_mp4?b:i((t=e).ext)&&t.ext.videoData&&t.ext.videoData.videoSource&&t.ext.videoData.videoSource.html?h:a(n=e)&&n.ext.appData&&n.ext.appData.appIcon&&!n.ext.appData.appImages?S:u;var n,t}return{extractStaticFiles:function(e,n){return e.ext&&i(e.ext)?function(e,n){var t=[];if(n&&l(e)){var i=c(e);if(!i)return t;var r=o(i);if(r){t.push(r);var a=function(e){var n,t=[];if(n=e.getAttribute("data-assets"))try{t=(t=JSON.parse(n))&&t.assets?t.assets:[]}catch(e){}return t}(i);a&&0<a.length&&(t=t.concat(a))}}return t}(e,n):r(e,d(e))},extractVastSource:function(e){var n=e.ext&&e.ext.vastData&&e.ext.vastData.xmlResponse?g:f;return r(e,n)},updateAdunitPrecachePath:function(e,n,t){return e.ext&&i(e.ext)?function(e,n){var t=c(e),i=o(t);if(l(e)&&i&&t){var r=s(i,n);t.src=r,e.ext.videoData.videoSource.html=t.outerHTML}}(e,n):function(e,a,n){for(var t=Object.keys(n),i=0;i<t.length;i++)e[t[i]]&&(e[t[i]]=o(n[t[i]],e[t[i]]));function o(e,n){var t,i;if("string"==typeof e||"string"==typeof n)n=s(n,a);else if(e instanceof Array&&0===e.length)for(t=0;t<n.length;t++)n[t]=s(n[t],a);else if(e instanceof Array&&0<e.length&&n instanceof Array&&0<n.length)for(t=0;t<n.length;t++)for(i=0;i<e.length;i++)n[t]=o(e[i],n[t]);else{var r=Object.keys(e);for(t=0;t<r.length;t++)n[r[t]]&&(n[r[t]]=o(e[r[t]],n[r[t]]))}return n}return e}(e,n,d(e))},getPlayableCacheFlag:function(){return"isPrecacheable"},isAdAbleToCache:l}}},{}],66:[function(e,n,t){n.exports={adunitFilesMapping:{js:"main.min.js",css:"main.min.css",html:"adUnit.min.html"},environment:{develop:"dev",production:"prod",stage:"stage"},adunitAssetsJsonKeys:{html:"html",js:"js",css:"css",sprite:"sprite",BC:"BrandConnect",libs:"libs",graphicAssets:"graphicAssets",adunitVersion:"adunitVersion"},adunitVersionKey:"adunitVersion",adunitLibsFileName:"adunitLibsFile",adunitGlobalsErrorMsgs:{failedDownloadingAssetsJson:"Failed downloading adunitStaticAssets.json",invalidAdunitAssetsJson:"Missing parameters in adunitStaticAssets.json",failedDownloaingGraphicAssets:"Failed to download adunit graphic assets",failedToRetrieveAdunitUrl:"Failed to retrieve Adunit url"},apiResponseTimeout:15e3}},{}],67:[function(e,n,t){n.exports=function(e,n,t,i,r){var a=e||{},o=n||{},s=t&&t.debug,c=t&&t.domain,l=t&&t.scdn,d=t&&t.protocol,u=t&&t.adunitConfig,f=i,g=r||{};function p(){return d+"//"+function(){if(s&&0<parseInt(s)&&"www.supersonicads.com"!==c){var e=c.split(".")[0];return c+"/users/staging/"+e}return l}()+"/adunit/dist/adunitAssets.json"}function v(){return o.ajax({dataType:"json",url:p(),timeout:g.apiResponseTimeout}).then(function(e,n,t){if(e&&(e.libs&&e.libs.adunitVersion||e.adunitVersion))return e;var i=o.Deferred();return i.reject(g.adunitGlobalsErrorMsgs.failedDownloadingAssetsJson),i.promise()},function(e,n,t){return g.adunitGlobalsErrorMsgs.failedDownloadingAssetsJson})}function m(e){return e&&e.libs&&(e.adunitVersion||e.libs.adunitVersion)&&e.graphicAssets}return{getGlobalAssetsJSON:function(){return f===g.environment.develop?v():m(u)?a.Utils.returnResolvedPromise(u):v().then(function(e){return m(e)?a.Utils.returnResolvedPromise(e):a.Utils.returnRejectedPromise(g.adunitGlobalsErrorMsgs.invalidAdunitAssetsJson)})},setProtocol:function(e){d=e}}}},{}],68:[function(V,e,n){function t(t){var d,u,f,g,p,v,m,b,h,S,y,C,A,r,a,o,s,c,l,D,I,w,P=V("./AdUnitConst.js");function L(){var e=f+"//",n="/adunit/dist",t=s?"/versions/"+s:"";if(d&&0<parseInt(d)&&"www.supersonicads.com"!==u){var i=u.split(".")[0],r="/stage/";("local"===i||1<parseInt(i))&&(r="/dev/"),e=e+u+("/users/staging/"+i)+n+t+r}else e=e+g+n+t+"/prod/";return e}function T(){var e=h.getCacheByType({cacheBase:"globals"});return e&&e.cache||[]}function O(e,n){return h.cacheGlobalAssets(e,n)}function F(){return"../"+S+"/globals/"}function U(){return h.getAppData().then(function(e){return(e=e||{})[P.adunitVersionKey]=s,h.setAppData(e)}).always(v.Utils.returnResolvedPromise)}function x(){return h.clearCacheByType({cacheBase:"globals"},[])}function N(e){if(p===t.environment.develop)return v.Utils.returnResolvedPromise(!0);var n=T();return n.length<=0||function(e,n){for(var t=0;t<e.length;t++){var i=e[t].split("."),r=i[i.length-1];if(P.adunitFilesMapping.hasOwnProperty(r)&&e[t]!==P.adunitFilesMapping[r])return n.hasOwnProperty("trackEvent")&&n.trackEvent(m.globalsInOldFormat),!0}return!1}(n,e)?v.Utils.returnResolvedPromise(!0):SuperSonicGlobalConfig.controllerConfig.adunitVersionToDownload&&SuperSonicGlobalConfig.controllerConfig.adunitVersionToDownload!==s?v.Utils.returnResolvedPromise(!0):h.getAppData().then(function(e){e=e||{};var n=v.Utils.versionCompare(s,e[P.adunitVersionKey]?e[P.adunitVersionKey]:"0");return v.Utils.returnResolvedPromise(0===n)}).then(function(e){var n=e&&function(){var e=T(),n=P.adunitFilesMapping;for(var t in n)if(-1===e.indexOf(n[t]))return!1;return!0}();return v.Utils.returnResolvedPromise(!n)}).fail(function(){return v.Utils.returnResolvedPromise(!0)})}function M(e){var a=L();return b.map(e,function(e){var n=/(\.\.\/)/g,t=e.match(n),i=t&&t.length||0;if(e=e.replace(n,""),0<i){var r=a.split("/");return r.splice(r.length-1-i,i),r.join("/")+e}return a+e})}function k(e){s=e.adunitVersion?e.adunitVersion:e.libs.adunitVersion}function B(e){var n,t,i=b.extend({},P.adunitFilesMapping,e);return t=e,(n=i).libs=function(e,n){for(var t in e)e.hasOwnProperty(t)&&"string"==typeof e[t]&&(e[t]=n+e[t]);return e}(t.libs,"../../"),i=n}function E(e){return w.prefetchGlobalAssetsToBrowser(e,L())}return{init:function(e,n,t,i,r,a,o,s,c,l){e,d=n.debug,u=n.domain,f=n.protocol,g=n.scdn,b=t,h=i,S=r,y=a,C=o,p=s,v=c,m=l,A=new(V("./AdUnitDataJsonFetcher.js"))(v,b,n,p,P),w=new(V("./AdUnitUtils.js"))(v,b,P),I=new(V("./AdUnitGraphicAssetsManager.js"))(v,w,h)},setProtocol:function(e){f=e,A.setProtocol(e)},getStaticGlobalsUrl:L,getGlobalAssetsJSON:function(){return A.getGlobalAssetsJSON()},prefetchGlobalAssetsToBrowser:E,getGlobalsCache:T,isAdunitVersionChanged:function(t){var e=T(),i=!0;return b.each(e,function(e,n){return-1<n.indexOf(t)&&(i=!1),i}),i},clearGlobalsCache:x,getLocalGlobalsFolder:F,cacheGlobalAssets:O,assetsToCache:M,updateAdUnitGlobals:function(n,e,t,i){if(n){if(l&&"rejected"!==l.state())return l.promise();l=b.Deferred()}else{if(c&&"rejected"!==c.state())return c.promise();c=b.Deferred()}return D&&"rejected"!==D.state()||(D=A.getGlobalAssetsJSON().then(function(e){var n;k(r=e),r=B(r),a=P.adunitFilesMapping,I.setAdunitAssetsPaths(r.graphicAssets,L()),o=r.libs,C.setLibsFilesPaths(o,L()),n=L()+P.adunitFilesMapping.html,y.setRemoteAdunitUrl(n),y.setLocalAdunitUrlFromCache(F(),T())}).then(function(){return n?C.manageDownloadLibsFileByFiletype(P.adunitLibsFileName,e):E({adunitLibsFile:o.adunitLibsFile})}).fail(function(e){n?l.reject(e):c.reject(e)})),D.then(function(){return n?(e=t,I.shouldUpdateAdunitAssets()?I.precacheAdunitGraphicAssets(e):v.Utils.returnResolvedPromise()).then(null,function(){l.reject(P.adunitGlobalsErrorMsgs.failedDownloaingGraphicAssets)}).then(N.bind(null,i)).then(function(e){return e?x().then(function(e,n){return O(M(e),n).then(function(){y.setLocalAdunitUrl(F()+y.getRemoteAdunitFileName())},function(){return y.setLocalAdunitUrl(y.getRemoteAdunitUrl()),P.adunitGlobalsErrorMsgs.failedToRetrieveAdunitUrl}).then(U)}.bind(null,a,t)).then(function(){l.resolve()},function(e){l.reject(e)}).always(function(){return l.promise()}):(l.resolve(),l.promise())}):E(a).then(I.prefetchAdunitGraphicAssets).then(function(){c.resolve()},function(e){c.reject(e)}).always(function(){return c.promise()});var e})},setAdunitVersion:k,getAdunitGlobalsHTML:function(){return P.adunitFilesMapping.html},updateGlobalAssetsStructure:B}}var i;e.exports=function(e,n){return n?new t(e):(i||(i=new t(e)),i)}},{"./AdUnitConst.js":66,"./AdUnitDataJsonFetcher.js":67,"./AdUnitGraphicAssetsManager.js":69,"./AdUnitUtils.js":70}],69:[function(e,n,t){n.exports=function(e,n,t){var r,a=t||{},o=n||{},s={},i={},c="graphicAssets";function l(){var e=a.getCacheByType({cacheBase:c});return e&&e.cache||[]}return{setAdunitAssetsPaths:function(e,n){s=e,r=n,i.sprite=s.sprite},shouldUpdateAdunitAssets:function(){if(0===l().length)return!0;for(var e in s)if(!a.isAssetInCache(o.extractFileNameFromPath(s[e]),c))return!0;return!1},precacheAdunitGraphicAssets:function(e){return(n=function(){for(var e=l(),n=[],t=function(e){for(var n in s)if(o.extractFileNameFromPath(s[n])===e)return!1;return!0},i=0;i<e.length;i++)t(e[i])&&n.push(e[i]);return n}(),a.deleteCachedListOfAssets(c,n)).then(a.cacheGraphicAssets.bind(null,function(){var e=[];for(var n in s){var t=o.extractFileNameFromPath(s[n]);if(!a.isAssetInCache(t,c)){var i=o.formatAssetsUrlForCache(s[n],r);e.push(i)}}return e}(),e));var n},prefetchAdunitGraphicAssets:function(){return o.prefetchGlobalAssetsToBrowser(i,r)}}}},{}],70:[function(e,n,t){n.exports=function(e,n,t){var p=n||{},v=t||{};return{formatAssetsUrlForCache:function(e,n){var t=n,i=function(e,n){var t=/(\.\.\/)/g,i=n.match(t),r=i&&i.length||0;if(n=n.replace(t,""),0<r){var a=e.split("/");return a.splice(a.length-1-r,r),a.join("/")+n}return e+n};return"string"==typeof e?i(t,e):p.map(e,function(e){i(t,e)})},prefetchGlobalAssetsToBrowser:function(e,n,t,i){var r,a,o=new p.Deferred,s=[],c=0,l=0,d=p.extend(!0,{},e);d.hasOwnProperty(v.adunitAssetsJsonKeys.BC)&&(p.extend(d,d[v.adunitAssetsJsonKeys.BC]),delete d[v.adunitAssetsJsonKeys.BC]),d.hasOwnProperty(v.adunitAssetsJsonKeys.html)&&delete d.html;var u=function(e){return-1<s.indexOf(e)};p.each(d,function(e,n){"string"==typeof n?u(n)||l++:delete d[e]}),0===l&&o.resolve();var f=function(e){var n;if(u(n=e)||s.push(n),++c===l){if("function"==typeof t&&t(s),r)return;clearTimeout(a),o.resolve()}},g=n;return p.each(d,function(e,i){if(!u(i)){var n=g+i;p.get(n,{},null,{dataType:"text"}).done(function(){f(i)}).fail(function(e,n,t){"parsererror"===n&&f(i)})}}),a=setTimeout(function(){c<l&&("function"==typeof i&&i(),o.reject("Failed to preload all global assets ("+c+" out of "+l+" succeeded)")),r=!0},15e3),o.promise()},extractFileVersionFromUrl:function(e){var n=e.split("/");return 0<n.length?n[n.length-2]:"0"},extractFileNameFromPath:function(e){return e.replace(/^.*[\\\/]/,"")}}}},{}],71:[function(C,e,n){function t(e){var a=e||{},n={dapi:"dapi",externalObfuscation:"externalObfuscation",adunitLibsFile:"adunitLibsFile",omid:"omid"},o={dapi:{filename:"dapi.js",type:n.dapi,cacheKeyName:"dapiVersion"},externalObfuscation:{filename:"obfuscateV2.html",type:n.externalObfuscation,cacheKeyName:"externalObfuscation"},adunitLibsFile:{filename:"adunitLibs.min.js",type:n.adunitLibsFile,cacheKeyName:"adunitLibsFile"},omid:{filename:"omid.js",type:n.omid,cacheKeyName:"omid"}},s="libs",c,l,d,i,r;function u(e,n,t){return!!o[e]&&(o[e].url=n,o[e].newVersion=t,!0)}function t(e,n,t){return u(e,n,t),a.returnResolvedPromise()}function f(e,n){return u(e,i.formatAssetsUrlForCache(n,r),i.extractFileVersionFromUrl(n))}function g(e){return c.isAssetInCache(e,s)?c.deleteCachedAsset(s,e):a.returnResolvedPromise()}function p(e,n){return 0===a.versionCompare(e,n)}function v(e,n){var t=o[e],i={};return!!t&&(i[t.cacheKeyName]=n,i)}function m(e,n,t){d=e,l=n,c=t||{},i=new(C("./AdUnitUtils.js"))(l,c)}function b(e,n){if(r=n,e)for(var t in e)f(t,e[t])}function h(e,t){var i=o[e]||{},r=function(){return g(i.filename).then(function(){return d.log("LibsManager | updateFileInCache | going to download",d.LogLevels.verbose),c.cacheLibsAsset(i.url).then(null,function(){return a.returnResolvedPromise()})}).fail(function(){return a.returnResolvedPromise()})};return c.getAppData().then(function(e){e=e||{},i.savedVersion=e&&e[i.cacheKeyName]?e[i.cacheKeyName]:"0";var n=!p(i.newVersion,i.savedVersion);return t||n?r().then(function(e){d.log("LibsManager | updateFileVersion | appData "+JSON.stringify(e),d.LogLevels.verbose);var n=l.extend(e,v(i.type,i.newVersion));return d.log("LibsManager | updateFileVersion | updatedData "+JSON.stringify(n),d.LogLevels.verbose),c.setAppData(n).fail(function(){return a.returnResolvedPromise()})}.bind(null,e)):c.isAssetInCache(i.filename,s)?(d.log("LibsManager | manageDownloadLibsFileByFiletype | file version is updated and file is already in cache",d.LogLevels.verbose),a.returnResolvedPromise()):(d.log("LibsManager | manageDownloadLibsFileByFiletype  | file version updated but file is not in cache - download it again",d.LogLevels.verbose),c.cacheLibsAsset(i.url))},r).then(function(){return d.log("LibsManager | manageDownloadLibsFileByFiletype  | success to download file "+i.url,d.LogLevels.verbose),a.returnResolvedPromise("success")},function(){return d.log("LibsManager | manageDownloadLibsFileByFiletype  | failed to download file "+i.url,d.LogLevels.verbose),S(i)})}function S(e){return e.filename===o.adunitLibsFile.filename?a.returnRejectedPromise("Failed to download file "+e.filename):a.returnResolvedPromise()}var y={init:m,setLibsFilesPaths:b,manageDownloadLibsFileByFiletype:h,updateFileVersionByFilePathForThirdPartyLibraries:t};return y}e.exports=t},{"./AdUnitUtils.js":70}],72:[function(e,n,t){function i(e){var n,t,r=function(){return n},i=function(e){n=e},a=function(){var e=null;return n&&(e=n.replace(/^.*[\\\/]/,"")),e},o=function(){return t},s=function(e){t=e},c=function(e,n,t){var i=e?o():r();return i+=n&&n.productType?"#?productType="+n.productType:"",i+=n&&n.demandSourceName?"&demandSourceName="+n.demandSourceName:"",i+=t&&t.shouldBuildAdUnitUrlForExternal?"&mode=native&viewType=external":""},l=function(t,e){jQuery.each(e,function(e,n){if("string"==typeof n&&n.match(/.*\.html/))return s(t+n.replace(/^.*[\\\/]/,"")),!1})},d={getAdunitUrl:c,getRemoteAdunitUrl:r,setRemoteAdunitUrl:i,getRemoteAdunitFileName:a,getLocalAdunitUrl:o,setLocalAdunitUrl:s,setLocalAdunitUrlFromCache:l};return d}n.exports=i},{}],73:[function(e,n,t){n.exports={NativeAPI:{adClicked:"adClicked",init:".initInterstitial",load:".loadInterstitial",show:".showInterstitial"},ControllerCallbacks:{cacheReady:".CacheReady",allOffersVast:".AllOffersVast",noMoreOffers:".NoMoreOffers",failedToShow:".failedToShow",failedToLoad:".failedToLoad",fallbackToNonPrecache:".fallbackToNonPrecache",actionClick:".ActionClick",exhaustedDemandSource:".exhaustedDemandSource",onAdWindowsClosed:".onAdWindowsClosed",resetStateManager:".resetStateManager"},AdUnitCallbacks:{adClicked:"SDKController.AdClicked",adVisible:"SDKController.AdVisible",engageEnd:"SDKController.engageEnd"},retriesLogic:{maxNumOfAttemptsToCallAPI:2,initAttemptsDelay:500,serverResponseTimeoutInMilis:1e4}}},{}],74:[function(e,n,t){n.exports=function(e,n){return{retriesLogic:e.retriesLogic,NativeAPI:{init:".initBanner",load:".loadBanner",show:".bannerViewVisible"},ControllerCallbacks:{reset:".reset",isVisible:".isVisible",isInitiated:".isInitiated",cacheReady:".CacheReady",failedToShow:".failedToShow",failedToLoad:".failedToLoad",actionClick:".ActionClick",exhaustedDemandSource:".exhaustedDemandSource",onAdWindowsClosed:".onAdWindowsClosed",noMoreOffers:".NoMoreOffers"},AdUnitCallbacks:{adClicked:"SDKController.AdClicked",adVisible:"SDKController.AdVisible",engageEnd:"SDKController.engageEnd"},ControllerNativeAPI:{adClicked:"adClicked"},ProductName:n.BN,Features:{allowMultiInitCalls:!0,shouldFetchNewFeedOnAdClose:!1,isSupportFetchFeedOnAdCloseLogic:!1,allowReloadDuringShow:!0,displayOnAdReady:!0,allowConsecutiveGatewayRequestsDuringLoad:!1,isExhaustInstanceAllowed:!0},gatewayDestinationMap:{prod:n.gatewayDestinationMap.BN.production},amountOfInventories:2,shouldResetOnEngageEnd:!0,shouldAvoidHandleFrameClose:!0}}},{}],75:[function(o,e,n){e.exports=function(i,r){var a=o("../components/Constants.js");return{create:function(){var e=o("./ProductAdapter.js"),n=o("./AdapterSharedConfig.js"),t=o("./Banner/BannerConfiguration.js")(n,a);return new e(i,r,t,a)}}}},{"../components/Constants.js":9,"./AdapterSharedConfig.js":73,"./Banner/BannerConfiguration.js":74,"./ProductAdapter.js":95}],76:[function(e,n,t){function i(y,C){var A="NativeCallback",b="globals",h="graphicAssets",t=!1,D={},I={mraid:{cache:[]},globals:{cache:[],cacheQueue:[]},BrandConnect:{cache:[],currentAd:0,cacheQueue:[],evaluatedCache:[]},Interstitial:{cache:[],currentAd:0,cacheQueue:[],evaluatedCache:[]},assets:{cache:[],cacheQueue:[]},libs:{cache:[],cacheQueue:[]},graphicAssets:{cache:[],cacheQueue:[]}},w={BrandConnect:{numOfBannersToCache:1},Interstitial:{numOfBannersToCache:1}},P;function s(e){return I[e.cacheBase].currentUser?y.Utils.returnResolvedPromise():C.setFixedUserIdForCache(e.productType).then(function(){I[e.cacheBase].currentUser=C.getFixedUserIdForCache()})}var n=function(e){return 0!==I[e.cacheBase].cache.length?(I[e.cacheBase].currentAd+1)%I[e.cacheBase].cache.length:0},i=function(i){i=i||{},jQuery.each(I,function(e,n){var t=e;I[t].cache&&0!==I[t].cache.length&&y.Utils.isDefined(i)&&i.hasOwnProperty(t)&&I[t].cache.sort(function(e,n){return i[t].indexOf(e.id)<i[t].indexOf(n.id)?-1:1})})},L=function(e){var n,t=e.length;for(n=0;n<t;n++)y.Utils.isDefined(e[n])&&e[n]&&y.PubSub.unsubscribe(e[n])},r=function(e){C.log("cache: "+JSON.stringify(I[e].cache)+" currentAd: "+I[e].currentAd,C.LogLevels.info),C.log("queue: "+JSON.stringify(I[e].cacheQueue),C.LogLevels.info)},T=function(e,n){var t,i=null,r=I[e.cacheBase].cacheQueue.length;for(t=0;t<r;t++)if(I[e.cacheBase].cacheQueue[t].cachingStatus===n){i=I[e.cacheBase].cacheQueue[t];break}return i},O=function(e,n){return e.cacheBase+"/"+n},F=function(e,n){var t=jQuery.map(I[e.cacheBase].evaluatedCache,function(e){return C.AdUtils.getAdId(e)});if(0<t.length){var i=t.indexOf(n.toString());0<=i&&(C.log("Removing ad from evaluatedCache! "+n,C.LogLevels.verbose),I[e.cacheBase].evaluatedCache.splice(i,1))}},U=function(e,n){var t=C.AdUtils.getAdId(n);if(n&&t){var i,r=I[e.cacheBase].cacheQueue.length;for(i=0;i<r;i++)I[e.cacheBase].cacheQueue[i].id==t&&(I[e.cacheBase].cacheQueue[i]=n)}},x=function(t,e){var i=-1;jQuery.each(I[e.cacheBase].cache,function(e,n){return!(y.Utils.isDefined(n.inventoryIndex)&&n.inventoryIndex>t.inventoryIndex||!y.Utils.isDefined(n.inventoryIndex))||(i=e,!1)}),-1===i?I[e.cacheBase].cache.push(t):I[e.cacheBase].cache.splice(i,0,t);var n={};n.cacheBase=e.cacheBase,n.id=t.id,n.inventoryId=t.inventoryId,y.PubSub.publish("Cache.campaignSaved",[n])},N=function(t){jQuery.each(I[t.cacheBase].cacheQueue,function(e,n){if(n.cachingStatus===P.cachingStatus.none&&0===jQuery.grep(I[t.cacheBase].cache,function(e){return C.AdUtils.getAdId(e)===C.AdUtils.getAdId(n)}).length&&0===jQuery.grep(I[t.cacheBase].evaluatedCache,function(e){return C.AdUtils.getAdId(e)===C.AdUtils.getAdId(n)}).length)return I[t.cacheBase].evaluatedCache.push(n),!1})},a=function(e,n){var t=jQuery.map(I[e.cacheBase].cache,function(e){return C.AdUtils.getAdId(e)});if(0<t.length){var i=t.indexOf(n.toString());0<=i&&(C.log("Removing ad from cache array! "+n,C.LogLevels.verbose),I[e.cacheBase].cache.splice(i,1))}},o=function(i,r){return C.getGlobalAppData().then(function(e){e.cachePriorityArray=e.cachePriorityArray||{};var n=e.cachePriorityArray[i.cacheBase];if(n){var t=n.indexOf(r.toString());0<=t&&(C.log("Removing ad from cache array! "+r,C.LogLevels.verbose),n.splice(t,1),e.cachePriorityArray=n)}return C.setGlobalAppData(e)})};function c(s,l){I[s.cacheBase].evaluatedCache.length;var n,e,t,d,i=I[s.cacheBase].cacheQueue.length,r=(w[s.cacheBase].numOfBannersToCache,null),a=null,u=null,f=null,o=null,g=[],p=[],c=[],v=0,m={};for(t=jQuery.Deferred(),e=0;e<i;e++)I[s.cacheBase].cacheQueue[e].cachingStatus!==P.cachingStatus.pending&&I[s.cacheBase].cacheQueue[e].cachingStatus!==P.cachingStatus.queued||0;var b=function(){0<I[s.cacheBase].evaluatedCache.length?(C.log("line[182]: evaluatedCache is: "+JSON.stringify(I[s.cacheBase].evaluatedCache),C.LogLevels.verbose),(n=T(s,P.cachingStatus.none))?(n.cachingStatus=P.cachingStatus.pending,F(s,C.AdUtils.getAdId(n)),n.numOfAssetsCached=0,D[s.cacheBase][n.id]=[],c.push(C.AdUtils.getAdId(n)),n.preProcessing().then(function(e){if(!y.Utils.isDefined(e))return y.Utils.returnResolvedPromise();n=q(e),U(s,n)},function(){var e={};e.cacheBase=s.cacheBase,e.id=C.AdUtils.getAdId(n),e.inventoryId=n.inventoryId,y.PubSub.publish("Cache.preProcessingFailed",[e]),g.push(e.id),t.reject(I[s.cacheBase].cache,g)}).then(function(){var e={};e.cacheBase=s.cacheBase,e.id=n.id,y.PubSub.publish("Cache.campaignDownloadStarted",[e]),m={},0===n.assets.length?S(s,C.AdUtils.getAdId(n)):(C.log("campaign "+n.id+" download started",C.LogLevels.info),C.cacheAdUnitAssets(O(s,n.id),n))}),0):(L([r,a,o,u,f]),0===g.length?t.resolve(I[s.cacheBase].cache):t.reject(I[s.cacheBase].cache,g,p))):(T(s,P.cachingStatus.pending)&&C.log("cache is full but we're waiting for a campaign to finish downloading (probably the last)",C.LogLevels.verbose),L([r,a,o,u,f]),0===g.length?t.resolve(I[s.cacheBase].cache):t.reject(I[s.cacheBase].cache,g,p))},h=function(e){L([u,f]),e&&(0,b())},S=function(e,n,t,i){var r,a,o=i&&i.hasOwnProperty("file")?i.file:null,s=!(!i||!i.hasOwnProperty("status"))&&i.status,c=[];if((r=B(e,n))&&z(s,m,o,r.assets,l)){if(l.cacheBase=e.cacheBase,m[o]={isSuccessfullyCached:s},!X(t,o,m,r.assets,v,l))return void v++;v=0}D[e.cacheBase][n].push(i),r&&r.id&&D[e.cacheBase][r.id].length===r.assets.length&&(C.log("campaign "+r.id+" download finished!",C.LogLevels.info),d=E(D[e.cacheBase][r.id],function(e){return e.status}),a=V(D[e.cacheBase][r.id],r,function(e){return e.status}),0===r.assets.length&&(d=!0),delete D[e.cacheBase][r.id],d?(r.cachingStatus=P.cachingStatus.queued,0<=I[e.cacheBase].evaluatedCache.length?(k(e,r.id,!1),r.numOfAssetsCached=r.assets.length,x(r,e),c=I[e.cacheBase].cache.map(function(e){return C.AdUtils.getAdId(e)}),y.PubSub.publish("Cache.cacheUpdated",[e,{inventoryId:r.inventoryId}])):C.log("Cache full, could not enter new ad",C.LogLevels.error),0<c.length?(C.log("mappedAds after 'handleCachedAd/pushNewCachedAd' "+c,C.LogLevels.verbose),C.setCachePriorityArrayKey(e,c).always(function(){b()})):b()):(k(e,n,!1),N(e),u=y.PubSub.subscribe(A+".deleteFolderFailed",function(e){C.log("in delete failure from cache next",C.LogLevels.verbose),C.checkRequiredCallbackParams(["path"],e,"deleteFolderFailed").didSucceed&&(C.log("deleting folder failed: "+JSON.stringify(e),C.LogLevels.error),y.Utils.isDefined(e.errCode)&&1==e.errCode?h(!0):h(!1))}),f=y.PubSub.subscribe(A+".deleteFolderSuccess",function(e){C.log("in delete success from cache next",C.LogLevels.verbose),C.checkRequiredCallbackParams(["path"],e,"deleteFolderSuccess").didSucceed&&(C.log("deleting folder success: "+JSON.stringify(e),C.LogLevels.info),h(!0))}),g.push(r.id),a&&p.push({id:r.id,failedAssetsUrlsArray:a.failedAssetsUrlsArray}),C.deleteFolder(t)))};return r=y.PubSub.subscribe(A+".assetCached",function(e,n,t){if(C.checkRequiredCallbackParams(["path","file"],e,"assetCached",t).didSucceed){var i,r=M(e.path),a=decodeURIComponent(e.path),o={file:e.file,status:!0};-1!==jQuery.inArray(r.id,c)?y.Utils.isDefined(D[r.type][r.id])&&r.type===s.cacheBase?(C.log("asset cached success: "+r.id+"/"+e.file,C.LogLevels.verbose),i={cacheBase:r.type},B(i,r.id).numOfAssetsCached++,S(i,r.id,a,o)):C.log("Exiting asset cached. folder:"+r.id+" responses array:"+JSON.stringify(D),C.LogLevels.error):C.log("ad is not recognised in this scope: "+r.id+" adForCaching:"+c,C.LogLevels.info)}}),a=y.PubSub.subscribe(A+".assetCachedFailed",function(e,n,t){if(C.checkRequiredCallbackParams(["path","file"],e,"assetCachedFailed",t).didSucceed){var i,r=M(e.path),a=decodeURIComponent(e.path),o={file:e.file,status:!1};-1!==jQuery.inArray(r.id,c)&&(y.Utils.isDefined(D[r.type][r.id])&&r.type===s.cacheBase?(C.log("asset cached failed: "+r.id+"/"+e.file+" with error: "+e.errMsg,C.LogLevels.error),i={cacheBase:r.type},S(i,r.id,a,o)):C.log("Exiting asset cached failed. folder:"+r.id+" responses array:"+JSON.stringify(D),C.LogLevels.error))}}),o=y.PubSub.subscribe(A+".preCacheFileFail",function(e,n,t){if(C.checkRequiredCallbackParams(["path","file"],e,"preCacheFileFail",t).didSucceed){var i,r=M(e.path),a=decodeURIComponent(e.path),o={file:e.file,status:!1};-1!==jQuery.inArray(r.id,c)&&(y.Utils.isDefined(D[r.type][r.id])&&r.type===s.cacheBase?(C.log("pre cache file fail: "+e.file+" with error: "+e.errMsg,C.LogLevels.error),i={cacheBase:r.type},S(i,r.id,a,o)):C.log("Exiting preCache file fail. folder:"+r.id+" responses array:"+JSON.stringify(D),C.LogLevels.error))}}),b(),t.promise()}var l=function(e){return parseInt(e)},d=function(e){var n;try{n=parseInt(e)}catch(e){n=0}return n},u=function(e,n){var t,i;for(t in n)if(n.hasOwnProperty(t)){if("userUniqueId"===t||"applicationUserId"===t){e.currentUser=n[t];continue}if("applicationKey"===t){e.currentAppKey=n[t];continue}if("files"===t){e.cache=n[t];continue}if(l(t)){e.cache.push({id:t,numOfAssetsCached:y.Utils.isDefined(n[t].files)?n[t].files.length:0,lastUpdateTime:y.Utils.isDefined(n[t].lastUpdateTime)?d(n[t].lastUpdateTime):0,assets:y.Utils.isDefined(n[t].files)?n[t].files:[]});continue}if("lastUpdateTime"===t)return;i=C.isRootFolder(t)?e:(P.initCacheBase(t),e[t]),u(i,n[t])}},f=function(e){y.Utils.isDefined(e)&&e&&e!=={}?u(I,e):I={mraid:{cache:[]},globals:{cache:[],cacheQueue:[]},BrandConnect:{cache:[],currentAd:0,cacheQueue:[]},RewardedVideo_Premium:{cache:[],currentAd:0,cacheQueue:[]},RewardedVideo_Direct:{cache:[],currentAd:0,cacheQueue:[]},Interstitial:{cache:[],currentAd:0,cacheQueue:[]},assets:{cache:[],cacheQueue:[]},libs:{cache:[],cacheQueue:[]}}},M=function(e){var n=decodeURIComponent(e).split("/");return{type:n[0],id:y.Utils.isDefined(n[1])?n[1]:null}},g=function(e){var n=e.split("#");return 1<n.length?n[n.length-1]:(n=e.split("/"))[n.length-1]},S=function(e,n){var t,i=-1,r=g(n),a=e.length;for(t=0;t<a;t++)if(g(e[t])===r){i=t;break}return i},k=function(e,n,t){var i,r=I[e.cacheBase].cacheQueue,a=[],o=!1;for(i=0;i<I[e.cacheBase].cacheQueue.length;i++)r[i].id!=n?a.push(r[i]):(o&&!t&&a.push(r[i]),o=!0);I[e.cacheBase].cacheQueue=a},p=function(i,e){var n,t,r,a,o=0,s=I[i.cacheBase].cache.length,c=[],l=[],d=jQuery.Deferred(),u=function(e,n){-1!==jQuery.inArray(decodeURIComponent(e.path),c)&&(e.success=n,l.push(e),l.length>=c.length&&(L([r,a]),E(l,function(e){return y.Utils.isDefined(e.success)&&e.success})?d.resolve():d.reject()))};if(a=y.PubSub.subscribe(A+".deleteFolderFailed",function(e){C.checkRequiredCallbackParams(["path"],e,"deleteFolderFailed").didSucceed&&-1!==e.path.indexOf(i.cacheBase)&&(C.log("deleting folder failed: "+JSON.stringify(e),C.LogLevels.error),y.Utils.isDefined(e.errCode)&&1==e.errCode?u(e,!0):u(e,!1))}),r=y.PubSub.subscribe(A+".deleteFolderSuccess",function(e){if(C.checkRequiredCallbackParams(["path"],e,"deleteFolderSuccess").didSucceed&&-1!==e.path.indexOf(i.cacheBase)){C.log("deleting folder success: "+JSON.stringify(e),C.LogLevels.info),u(e,!0);var n=M(e.path);if(null!==n.id){var t={};t.cacheBase=n.type,t.id=n.id,t.inventoryId=n.inventoryId,y.PubSub.publish("Cache.campaignDeleted",[t])}}}),i.cacheBase===b)I[i.cacheBase].cache=[],I[i.cacheBase].cacheQueue=[],c.push(b);else{for(o=0;o<s;o++)y.Utils.isDefined(I[i.cacheBase].cache[0].id)||C.log("something went wrong. len="+s+" cache size= "+I[i.cacheBase].cache.length+" first element="+JSON.stringify(I[i.cacheBase].cache[0]),1),n=I[i.cacheBase].cache[0].id.toString(),y.Utils.isDefined(n)&&-1===jQuery.inArray(n,e)&&(t=i.cacheBase+"/"+n,-1===jQuery.inArray(t,c)&&c.push(t)),I[i.cacheBase].cache.shift();for(s=I[i.cacheBase].cacheQueue.length,o=0;o<s;o++)n=I[i.cacheBase].cacheQueue[0].id,y.Utils.isDefined(n)&&I[i.cacheBase].cacheQueue[0].cachingStatus!==P.cachingStatus.none&&(t=i.cacheBase+"/"+n,-1===jQuery.inArray(t,c)&&c.push(t)),I[i.cacheBase].cacheQueue.shift()}if(0===c.length)L([r,a]),d.resolve();else for(C.log("Removing irrelevant campaigns: "+JSON.stringify(c)),o=0;o<c.length;o++)C.deleteFolder(c[o]);return d.promise()},v=function(e,n){var t,i=null,r=I[e.cacheBase].cache,a=I[e.cacheBase].cache.length;for(t=0;t<a;t++)if(r[t].id==n){i=r[t];break}return i},B=function(e,n){var t,i=null,r=I[e.cacheBase].cacheQueue,a=I[e.cacheBase].cacheQueue.length;for(t=0;t<a;t++)if(r[t].id==n){i=r[t];break}return i},E=function(e,n){var t,i=e.length,r=!0;for(t=0;t<i;t++)r=r&&n(e[t]);return r};function V(e,n,t){var i,r=e.length,a={failedAssetsUrlsArray:[]},o=function(e,n){if(!e||!e.assets)return null;var t=e.assets;n=n.split("?")[0];for(var i=0;i<t.length;i++){if(n&&-1!==t[i].indexOf(n))return t[i].split("?")[0]}return null};for(i=0;i<r;i++)if(!t(e[i])){var s=o(n,e[i].file);s&&a.failedAssetsUrlsArray.push(s)}return a}var m=function(){y.PubSub.subscribe(A+".printCache",function(e){y.Utils.isDefined(e.type)&&r(e.type)})},e=function(t,i,e){var r=0,a=!1;return jQuery.each(I[e.cacheBase].cache,function(e,n){if(0<jQuery.grep(t,function(e){return C.AdUtils.getAdId(e)===C.AdUtils.getAdId(n)}).length&&i<=++r)return!(a=!0)}),a},R=function(n,e,t,i){var r,a=n.slice(0,e),o=[];for(I[i.cacheBase].evaluatedCache=[],r=0;r<a.length;r++)0===jQuery.grep(I[i.cacheBase].cache,function(e){return C.AdUtils.getAdId(e)===C.AdUtils.getAdId(a[r])&&K(e,a[r])}).length&&I[i.cacheBase].evaluatedCache.push(a[r]);for(r=0;r<a.length;r++)0===jQuery.grep(I[i.cacheBase].cache,function(e){return C.AdUtils.getAdId(e)===C.AdUtils.getAdId(a[r])&&!K(e,a[r])}).length&&o.push(a[r]);for(r=e;r<n.length;r++)0<jQuery.grep(I[i.cacheBase].cache,function(e){return C.AdUtils.getAdId(e)===C.AdUtils.getAdId(n[r])&&K(e,n[r])}).length&&o.push(n[r]);var s,c=n.length;for(r=0;r<I[i.cacheBase].cache.length;r++)0===jQuery.grep(n,function(e){return C.AdUtils.getAdId(e)===C.AdUtils.getAdId(I[i.cacheBase].cache[r])}).length&&(I[i.cacheBase].cache[r].inventoryIndex=++c,o.push(((s=I[i.cacheBase].cache[r]).adId=s.id,s.staticContent=s.assets,s)));return I[i.cacheBase].mergedAds=o.slice(0,t),I[i.cacheBase].mergedAds},K=function(e,n){if(!e||!n)return C.log("line[750]: entering isCachedAdStillUpdated with no ad",C.LogLevels.verbose),!1;var t=H(e.assets),i=H(n.staticContent);return C.log("cachedAdNumOfUniqueAssets: "+t+", newAdNumOfUniqueAssets:"+i,C.LogLevels.verbose),t===i&&(j(n)||e.lastUpdateTime==n.lastUpdateTime)},j=function(e){return e&&"0"!==e.creativeId},W=function(e,n){return I[n]&&-1<I[n].cache.indexOf(e)},G=function(e,n,t){var i=v(e,n);i&&(i.inventoryIndex=t)},H=function(e){var t,i=[];return e?(jQuery.each(e,function(e,n){t=g(n),-1===S(i,t)&&i.push(t)}),i.length):(C.log("cannot extract unique assets count",C.LogLevels.error),-1)},q=function(e){var n={id:C.AdUtils.getAdId(e),assets:e.staticContent||[],lastUpdateTime:y.Utils.isDefined(e.lastUpdateTime)?e.lastUpdateTime:0,numOfAssetsCached:0,cachingStatus:P.cachingStatus.none,preProcessing:e.preProcessing||y.Utils.returnResolvedPromise};return y.Utils.isDefined(e.credits)&&(n.credits=e.credits),y.Utils.isDefined(e.inventoryIndex)&&(n.inventoryIndex=e.inventoryIndex),n},J=function(e,n){var t={};t.failedCachedFile=e,t.listOfFilesUrls=n,e=e.split("?")[0];for(var i=0;i<n.length;i++)if(-1!==n[i].indexOf(e))return n[i];return!1},Q=function(e,n,t,i,r,a){return{cacheBase:e,productType:n,file:t,currentRetryAttempt:i,totalRetryAttempts:r,assetType:a}},_=function(e){return e&&e.hasOwnProperty("retryAttempts")&&e.hasOwnProperty("retryInterval")},z=function(e,n,t,i,r){return t&&i&&0<i.length&&(!e||n[t])&&_(r)},X=function(e,n,t,i,r,a){var o,s=!0,c=J(n,i),l=a.retryAttempts,d=a.retryInterval,u={cacheBase:e,failedCachedFile:n,listOfFilesUrls:i};if(c)return t[n].isSuccessfullyCached?0<r&&t[n].isSuccessfullyCached&&(o=Q(e,a.productType,c,r,l,a.assetType),y.PubSub.publish("Cache.assetRetrySuccess",[o])):r<l?(s=!1,setTimeout(function(){C.cacheAsset(e,c)},1e3*d)):(o=Q(e,a.productType,c,r,l,a.assetType),y.PubSub.publish("Cache.assetRetryFailed",[o])),s;y.PubSub.publish("Cache.executeRetryFileUrlEmpty",[u])},$={init:function(e,n){return P=this,t||(f(e),m(),t=!0),i(n),t},initCacheBase:function(e){I[e]||(I[e]={cache:[],currentAd:0,cacheQueue:[]}),D[e]||(D[e]={})},setAdInventoryIndex:G,cacheNext:function(e,n){return C.log("line[707]: recalling cache next",C.LogLevels.verbose),N(e),c(e,n)},incrementNextCampaign:function(e){I[e.cacheBase].currentAd=n(e)},isNextAvailable:function(e,n){return P.getCurrentAd(e,n)},setSettings:function(e,n){w[e.cacheBase]=n},getCacheSizeByType:function(e){return I[e.cacheBase].cache.length},cacheGlobalAssets:function(e,n){return P.cacheFilesByFolder("globals",e,n)},cacheGraphicAssets:function(e,n){return P.cacheFilesByFolder("graphicAssets",e,n)},cacheFilesByFolder:function(t,i,r){var e,a,o,s,c,l=i.length,d=[],u=0,f={};if(!I.hasOwnProperty(t))return y.Utils.returnResolvedPromise();a=jQuery.Deferred();var g=I[t].cache,p=I[t].cacheQueue,v=function(e,n){if(z(n,f,e,i,r)){if(f[e]={isSuccessfullyCached:n},r.cacheBase=t,!X(t,e,f,i,u,r))return void u++;u=0}d.push({file:e,status:n}),m(e),d.length>=l&&(L([o,s,c]),E(d,function(e){return e.status})?(g=jQuery.map(i,function(e){return e.replace(/^.*[\\\/]/,"")}),a.resolve(g)):a.reject())},m=function(e){var n=p.indexOf(e);-1<n&&p.splice(n,1)};for(o=y.PubSub.subscribe(A+".assetCached",function(e,n,t){C.checkRequiredCallbackParams(["path","file"],e,"assetCached",t).didSucceed&&(e.path!==b&&e.path!==h||(C.log("asset cached success: "+e.file,C.LogLevels.verbose),v(e.file,!0)))}),s=y.PubSub.subscribe(A+".assetCachedFailed",function(e,n,t){C.checkRequiredCallbackParams(["path","file"],e,"assetCachedFailed",t).didSucceed&&(e.path!==b&&e.path!==h||(C.log("asset cached failed: "+e.file+" with error: "+e.errMsg,C.LogLevels.error),v(e.file,!1)))}),c=y.PubSub.subscribe(A+".preCacheFileFailed",function(e,n,t){C.checkRequiredCallbackParams(["path","file"],e,"preCacheFileFail",t).didSucceed&&(e.path!==b&&e.path!==h||(C.log("failed to request to save file:"+e.file+" with error "+e.errMsg,C.LogLevels.error),v(e.file,!1)))}),e=0;e<l;e++)-1===S(g,i[e])?(-1===S(p,i[e])?p.push(i[e]):m(i[e]),C.cacheAsset(t,i[e])):-1!==S(g,i[e])&&v(i[e],!0);return 0===l&&L([o,s,c]),a.promise()},cacheLibsAsset:function(e){var n=jQuery.Deferred(),t=e.replace(/^.*[\\\/]/,"");return I.libs.cacheQueue.push(t),C.cacheAsset("libs",e).then(function(){!function(e){I.libs.cache.push(t);var n=I.libs.cacheQueue.indexOf(e);-1!==e&&I.libs.cacheQueue.splice(n,1)}(e),n.resolve(I.libs.cache)},function(){n.reject("Libs asset cache failed: "+e)}),n.promise()},cacheAds:function(e,n,t,i){var r,a=t.length;for(I[e.cacheBase].currentAppKey=n,r=0;r<a;r++){var o=q(t[r]);I[e.cacheBase].cacheQueue.push(o)}return s(e).then(c.bind(null,e,i))},cacheSingleAd:function(e,n,t){I[e.cacheBase].cacheQueue.splice(0,0,q(n)),P.cacheNext(e,t)},clearCacheByType:function(e,n){var t,i,r=n.length,a=[],o=null,s=[],c=jQuery.Deferred();if(0===I[e.cacheBase].cache.length&&0===I[e.cacheBase].cacheQueue.length)return c.resolve(I[e.cacheBase].cache),c.promise();for(t=0;t<r;t++)i=C.AdUtils.getAdId(n[t]),o=v(e,i),K(o,n[t])&&(s.push(i),y.Utils.isDefined(n[t].credits)&&!y.Utils.isDefined(o.credits)&&(o.credits=n[t].credits),a.push(o));return jQuery.when(p(e,s)).then(function(){I[e.cacheBase].cache=a,c.resolve(I[e.cacheBase].cache)},function(){C.log("error in clear cache by type",C.LogLevels.error),c.reject()}),c.promise()},getCurrentAd:function(n,e){var i=null;return n&&n.cacheBase&&e?(jQuery.each(e,function(e,t){return jQuery.each(I[n.cacheBase].cache,function(e,n){return!(i=C.AdUtils.getAdId(n)===C.AdUtils.getAdId(t)?n:i)}),!i}),i):null},getNextAvailableAd:function(){return{}},getAppKeyByType:function(e){return y.Utils.isDefined(I[e.cacheBase].currentAppKey)?I[e.cacheBase].currentAppKey:null},getCacheByType:function(e){return I[e.cacheBase]},getRootCacheStructure:function(){return I},isAdInCache:function(e,n){var t,i=I[e.cacheBase].cache.length,r=!1;for(t=0;t<i;t++)if(I[e.cacheBase].cache[t].id==n){r=!0;break}return r},getAdStatusInQueue:function(e,n){var t=B(e,n);return t?t.cachingStatus:null},setAppData:function(e){return C.setGlobalAppData(e)},getAppData:function(){return C.getGlobalAppData()},deleteCachedAsset:function(e,n){return C.deleteAsset(e,n)},deleteCachedListOfAssets:function(e,n){var t,i=new jQuery.Deferred,r=[],a=0;if(0===n.length)return i.resolve(0),i.promise();for(t=0;t<n.length;t++)r.push(C.deleteAsset(e,n[t]));return jQuery.when.apply(null,r).always(function(){var e=arguments;for(t in e)e[t]&&a++;i.resolve(a)}),i.promise()},deleteCachedCampaign:function(e,n){var t=e.cacheBase+"/"+n;return C.deleteFolder(t),a(e,n),o(e,n)},isAssetInCache:W,mergeCampaigns:R,areCampaignsAvailable:e,getFileIndexInCache:S,cachingStatus:{none:0,pending:1,queued:2}};return $}n.exports=i},{}],77:[function(i,e,n){e.exports=function(e,n){var t=i("../../components/Constants.js");return{productType:e.productType,demandGroupName:n.demandGroupName||n.demandSourceName,demandSourceName:n.demandSourceName,demandType:n.demandType||t.demandSourceType.demandSource,isInAppBidding:n.isInAppBidding,integrationType:n.integrationType||t.integrationType.automatic,demandSourceId:n.demandSourceId,waterfallPosition:n.waterfallPosition}}},{"../../components/Constants.js":9}],78:[function(e,n,t){n.exports=function(){return{initAd:{name:"initAd",id:1},initAdFail:{name:"initAdFail",id:2},initAdToAdReady:{name:"initAdToAdReady",id:-1},adReady:{name:"adReady",id:3},showAd:{name:"showAd",id:4},showAdFail:{name:"showAdFail",id:5},showAdSuccess:{name:"showAdSuccess",id:26},showAdCalled:{name:"showAdCalled",id:-3},adVisible:{name:"adVisible",id:8},videoStarted:{name:"videoStarted",id:9},videoCompleted:{name:"videoCompleted",id:10},endCardDisplayed:{name:"endCardDisplayed",id:11},clickDownloadNow:{name:"clickDownloadNow",id:12},endCardDisplayedToClickDownload:{name:"endCardDisplayedToClickDownload",id:-4},campaignSavedCache:{name:"campaignSavedCache",id:106},campaignsAvailableFromCache:{name:"campaignsAvailableFromCache",id:107},noMoreOffers:{name:"noMoreOffers",id:105},clickReplay:{name:"clickReplay",id:111},clickVideoSound:{name:"clickVideoSound",id:112},adVisibleToClose:{name:"adVisibleToClose",id:-5},adUnitRetrySuccess:{name:"adUnitRetrySuccess",id:170},adUnitRetryFail:{name:"adUnitRetryFail",id:171},adLoaded:{name:"adLoaded",id:6},adLoadedError:{name:"adLoadedError",id:7},userAlert:{name:"userAlert",id:113},backFill:{name:"backFill",id:115},campaignFailedToCache:{name:"campaignFailedToCache",id:109},campaignDeletedCache:{name:"campaignDeletedCache",id:108},hybridFallback:{name:"hybridFallback",id:118},hybridFlowFail:{name:"hybridFlowFail",id:120},loadAd:{name:"loadAd",id:21},loadAdFailed:{name:"loadAdFailed",id:22},loadAdFailedForExhaustedInstance:{name:"loadAdFailedExhaustedInstance",id:32},loadAdIgnored:{name:"loadAdIgnored",id:24},loadAdSuccess:{name:"loadAdSuccess",id:23},bannerLoaded:{name:"bannerLoaded",id:27},bannerVisible:{name:"bannerVisible",id:28},bannerClicked:{name:"bannerClicked",id:29},getInventory:{name:"getInventory",id:158},getInventoryFailed:{name:"getInventoryFailed",id:159},bannerDestroyed:{name:"bannerDestroyed",id:30},bannerLoadToLoadSuccess:{name:"bannerLoadToLoadSuccess",id:-6},bannerLoadSuccessToVisible:{name:"bannerLoadSuccessToVisible",id:-7},bannerVisibleToClick:{name:"bannerVisibleToClick",id:-8},bannerReloadDuringLoad:{name:"bannerReloadDuringLoad",id:251},bannerLoadedDuringShow:{name:"bannerLoadedDuringShow",id:232},initBeforeLoad:{name:"initBeforeLoad",id:128},loadAdToAdReady:{name:"loadAdToAdReady",id:-9},loadAdToShowAd:{name:"loadAdToShowAd",id:-10},fallbackToNonPrecache:{name:"fallbackToNonPrecache",id:154},parseVastSuccess:{name:"parseVastSuccess",id:240},parseVast:{name:"parseVast",id:-11},parseVastFail:{name:"parseVastFail",id:241},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},parseVastInfo:{name:"parseVastInfo",id:157},refreshInterval:{name:"refreshInterval",id:164},attemptToBringNewFeed:{name:"attemptToBringNewFeed",id:163},adAssetRetrySuccess:{name:"adAssetRetrySuccess",id:320},adAssetRetryFail:{name:"adAssetRetryFail",id:321},executeRetryFileUrlEmpty:{name:"executeRetryFileUrlEmpty",id:323}}}},{}],79:[function(e,n,t){n.exports={direct:{http:{method:"GET",dataType:"jsonp"}}}},{}],80:[function(e,n,t){n.exports=function(t,i){var r=e("./FetchDemandConst.js");return{fetchFeed:function(e,n){return t({url:e,data:n,type:r.direct.http.method,dataType:r.direct.http.dataType,timeout:i||1e4})}}}},{"./FetchDemandConst.js":79}],81:[function(e,n,t){n.exports=function(r,a,e,o,s){var i=295e3,c=a.getConfig().mobileSDKSettings.deviceOs,l=a.getConfig().controllerConfig||{},d=!(e.overrideFeedSettings.isSupportFetchFeedOnAdCloseLogic&&!e.overrideFeedSettings.shouldFetchNewFeedOnAdClose),u={applyPatchLogic:{name:"applyPatchLogic",id:841},applyPatchLogicEnd:{name:"applyPatchLogicEnd",id:842}};function t(t){var i=r.PubSub.subscribe(s.CB+".webviewPatch",function(){var e,n;r.PubSub.unsubscribe(i),e=t,n=window.timerService.timeElapsed(window.lastWebviewClosedTimer)-e,o.trackEvent(u.applyPatchLogicEnd,{generalMessage:0<n?n:-9}),setTimeout(function(){a.callSDKFunction("displayWebView",{display:!1}),window.timerService.stopTimer(window.lastWebviewClosedTimer),window.lastWebviewClosedTimer=window.timerService.startTimer()})})}function f(e){if(c!==s.deviceOs.android)return!1;if("number"!=typeof e||e<i)return!1;var n=(a.getApplicationExternalConfig().getGeneralConfig()||{}).shouldApplyNetworkSolution,t=l.shouldApplyNetworkSolution;return!(d&&(!1===n||!1===t))}return{applyCommunicationSolution:function(e){var n;f(e)&&(a.log("applyCommunicationSolution five minutes communication issue | timeElapsed window.lastWebviewClosedTimer > 5 minutes: "+e),n=e,o.trackEvent(u.applyPatchLogic,{generalMessage:0<i?n:-8}),t(e),a.callSDKFunction("displayWebView",{display:!0,activityThemeTranslucent:!0,success:"webviewPatch"}))},shouldApplyCommunicationSolution:f}}},{}],82:[function(e,n,t){n.exports=function(a,o,s,r,t){var c=e("./PayloadBuilderConstants.js"),i=r.productType,n=r.demandSourceName,l=r.demandGroupName,d=0,u=!1,f=0;function g(e){var n=o.getSDKDataByKey(t.abTests.abt);return n&&n.hasOwnProperty(t.abtParamByProductType[i])&&0<n[t.abtParamByProductType[i]].length&&(e.abt=n[t.abtParamByProductType[i]]),s.Utils.returnResolvedPromise(e)}function p(e){return a.extend(e,{demandSource:n,impressionsCount:d}),s.Utils.returnResolvedPromise(e)}function v(e){var n=o.ImpressionsCounterService.getPayloadCounters(r);return a.extend(e,n),s.Utils.returnResolvedPromise(e)}function m(e){var n={},t=o.getApiData({fpf:0});u&&t&&(n.fpf=t.fpf);var i=r.waterfallPosition;return s.Utils.isDefined(i)&&(n.wp=i),n.integrationType=r.integrationType,n.retryCounter=f,a.extend(e,n),s.Utils.returnResolvedPromise(e)}function b(e){var n=o.getApiData({segmentId:0}),t=o.getApiData({segmentName:0});return n&&t&&a.extend(e,{segmentId:n.segmentId,segmentName:t.segmentName}),s.Utils.returnResolvedPromise(e)}function h(n){var e=new a.Deferred;return o.shouldExtendApiDataWithDebugData()?o.getSDKDebugParams().then(function(e){return a.extend(n,e),s.Utils.returnResolvedPromise(n)}).always(function(){e.resolve(n)}):e.resolve(n),e.promise()}function S(e){if(!o.blacklistService.isEmpty(i,l)){var n=o.blacklistService.getBlacklistedCampaigns(i,l);a.extend(e,{blacklistedCampaigns:n.join(",")})}return s.Utils.returnResolvedPromise(e)}function y(e){return o.LastSeenCampaignService.shouldAddLastDisplayedAdCampaignIdToPayload(i)&&a.extend(e,{lastSeenCampaignId:o.LastSeenCampaignService.getLastDisplayedAdCampaignId()}),s.Utils.returnResolvedPromise(e)}function C(e){if(o.OMIDService.isNativeServiceActivated()){var n=o.OMIDService.getVersionData();a.extend(e,{omidEnabled:!0,omidVersion:n.omidVersion,omidPartnerVersion:n.omidPartnerVersion})}else a.extend(e,{omidEnabled:!1,moatSupported:o.MOATService.isInitialized()});return s.Utils.returnResolvedPromise(e)}function A(t){return function(){var n,t,i=a.Deferred();if(o.isLegacy(o.featureMap.getTokenSupport))return s.Utils.returnResolvedPromise({});var r=function(e){s.PubSub.clearHandlers([n,t]),i.resolve(e)};return n=s.PubSub.subscribe(c.CB+"."+c.callbacks.getTokenSuccess,function(e){r(e)}),t=s.PubSub.subscribe(c.CB+"."+c.callbacks.getTokenFailed,function(e){e&&e.errMsg?o.log(c.errorLog+": "+e.errMsg,o.LogLevels.error):o.log(c.errorLog),r({})}),o.callSDKFunction(c.nativeFunction,{functionName:c.nativeAPI.getToken},c.callbacks.getTokenSuccess,c.callbacks.getTokenFailed),i.promise()}().then(function(e){return"object"!=typeof e||a.each(e,function(e,n){-1<e.indexOf(c.metaDataPrefix)&&(t[e]=n)}),s.Utils.returnResolvedPromise(t)})}function D(e){return o.log("payloadBuilder | built payload for "+i+" | payload "+JSON.stringify(e)),s.Utils.returnResolvedPromise(e)}return{createPayload:function(e,n,t){return d=e,u=n,f=t,o.getApplicationInfo(o.DemandUtils.extendCallbackParamsWithParentProductConfig(r,{})).then(o.getAPIRequiredData).then(p).then(v).then(m).then(b).then(g).then(h).then(S).then(y).then(C).then(A).then(D)}}}},{"./PayloadBuilderConstants.js":83}],83:[function(e,n,t){n.exports={CB:"NativeCallback",metaDataPrefix:"metadata_",nativeFunction:"iabTokenAPI",nativeAPI:{getToken:"getToken"},callbacks:{getTokenSuccess:"getTokenSuccess",getTokenFailed:"getTokenFailed"},errorLog:"payloadBuilder | getToken Failed"}},{}],84:[function(e,n,t){n.exports=function(o,s){var c=!0;function e(e){c=!!e}return{canPreloadCandidateAd:function(e,n,t,i,r){if(!c)return s.log("Can not preload next ad right now",s.LogLevels.verbose),!1;if(e&&!n)return s.log("Skipping preload on capped demand",s.LogLevels.verbose),!1;var a=o.VastUtils.isVastCampaign(t);return n||r&&!a||i?(s.log("line[1390]:preload ad "+s.AdUtils.getAdId(t),s.LogLevels.verbose),!0):(s.log("line[1393]:skipping preload with "+s.AdUtils.getAdId(t),s.LogLevels.verbose),!1)},preloadAdFinished:function(){e(!1)},setCanPreloadFlag:e,reset:function(){e(!0)}}}},{}],85:[function(Ot,e,n){function t(u,p,f,e,c,n){"use strict";var l,t=!1,d=e.demandSourceName,g=p.adUnitUrl,v=p.jQuery(),i,m=new(Ot("./../../components/MultipleInventories.js")),b=new(Ot("./PreloadAdManager"))(u,p),r=new(Ot("../../patches/PublisherPatchEasybrain.js"))(p.getConfigurationHelper()),h=new(Ot("./../../components/sdkPluginType/SDKPluginTypeHandler.js"))(p,u.Utils),S=c.eventicsCategories,y={},a=v.extend({},c.precacheConfig),C=c.displayMode,A=!1,s=0,o=null,D=null,I=null,w=!1,P=!1,L,T=[],O,F={},U,x=f.closeButtonStates,N=!1,M=[],k=null,B=null,E=null,V=null,R=f.CB,K=null,j=0,W={},G={},H=p[c.productType],q=new(Ot("./DemandEntityBuilder.js"))(c,e),J=Ot("../../patches/PatchIOSLoadAfterLoad.js")(u,p,q),Q=n||le(),_=Ot("./FetchDemand/FetcherPatch.js")(u,p,c,Q,f),z=p.DemandUtils,X=new(Ot("./../RewardedVideo/dsTaskManager.js"))(u,p,q,f),$=Ot("../../components/VastService.js")(u,p),Y=new(Ot("./../RewardedVideo/availabilityReporter.js"))(u,p,c,q,X),Z=new(Ot("./../RewardedVideo/availabilityManager.js"))(u,p,Y,c,Q),ee=Ot("../../components/CampaignsFilter.js")(u,p).factory(q.productType),ne=new(Ot("./PayloadBuilder.js"))(v,p,u,q,f),te,ie=!0,re=1,ae=!1,oe=p.getExternalContainer(),se=function(){M.push(u.PubSub.subscribe("PrecacheManager.cacheUpdatedCallback",function(e){if(z.shouldReceiveMessage(q,e)){var n,t,i;p.log("globals ready: "+A+" initSuccess in settings: "+y.numOfBannersToInitSuccess+" adUnits: "+m.size(e.inventoryId),p.LogLevels.verbose);var r=te.getCacheSizeByType(q.productType),a=Re.bind(null,e.inventoryId);if(0===y.numOfBannersToInitSuccess)t=1,n=te.areCampaignsAvailable(qe(e.inventoryId).slice(0,t),t);else{var o=Je(e.inventoryId);t=o.length;var s=Be(m.getOffers(e.inventoryId),y.numOfBannersToInitSuccess);i=s<=t?s:t,n=te.areCampaignsAvailable(o,i)}p.log("PM | cacheUpdatedCallback cache updated areCampaignsAvailable: "+n,p.LogLevels.verbose),Z.cacheUpdate(r,A,n,a)}})),M.push(u.PubSub.subscribe("PrecacheManager.campaignDeletedCallback",function(e){if(z.shouldReceiveMessage(q,e)){var n,t=-1,i={};u.Utils.isDefined(e.id)&&(n=Ge(e.id,e.inventoryId),i=p.AdUtils.updateEventWithAdParams(y,n,i),t=n&&u.Utils.isDefined(n.inventoryIndex)?n.inventoryIndex:-1),Q.trackEvent(S.campaignDeletedCache,{inventoryIndex:t},i)}})),M.push(u.PubSub.subscribe("PrecacheManager.campaignSavedCallback",function(e){if(z.shouldReceiveMessage(q,e)){var n,t=-1,i=null,r={};u.Utils.isDefined(e.id)&&(n=Ge(e.id,e.inventoryId),i=e.id,t=n&&u.Utils.isDefined(n.inventoryIndex)?n.inventoryIndex:-1,r=p.AdUtils.updateEventWithAdParams(y,n,r)),v.extend(r,{eNameStart:{name:S.campaignSavedCache.name+(i||"")},inventoryIndex:t}),Q.trackTimingStop(S.campaignSavedCache,r)}})),M.push(u.PubSub.subscribe("PrecacheManager.campaignDownloadStartedCallback",function(e){if(z.shouldReceiveMessage(q,e)){var n=v.extend({},S.campaignSavedCache);n.name=n.name+(e.id||""),Q.trackTimingStart(n)}})),M.push(u.PubSub.subscribe("PrecacheManager.cacheAdsSuccessCallback",function(e){z.shouldReceiveMessage(q,e)&&p.log("RV cacheAdsSuccessCallback "+JSON.stringify(e),p.LogLevels.verbose)})),M.push(u.PubSub.subscribe("PrecacheManager.cacheNextFail",function(o){z.shouldReceiveMessage(q,o)&&o.deletedAds&&0<o.deletedAds.length&&v.each(o.deletedAds,function(e,n){var t=Ge(n,o.inventoryId),i=p.AdUtils.updateEventWithAdParams(y,t,{}),r=o.deletedAdsData;if(r&&r[e].id==n){var a=r[e].failedAssetsUrlsArray.toString();i.rvnomoreoffersreason=a.substring(0,999)}Q.trackEvent(S.campaignFailedToCache,{},i),je(n,o.inventoryId)})})),M.push(u.PubSub.subscribe("PrecacheManager.fallbackToNonPrecache",function(e){z.shouldReceiveMessage(q,e)&&(u.PubSub.publish(c.productType+".fallbackToNonPrecache",[e]),Q.trackEvent(S.fallbackToNonPrecache))})),M.push(u.PubSub.subscribe("PrecacheManager.cacheAdsFailedCallback",function(e){if(z.shouldReceiveMessage(q,e)){p.log("RV cacheAdsFailedCallback "+JSON.stringify(e),p.LogLevels.verbose);for(var n,t,i,r=e.deletedOffers.length,a=e.deletedOffers,o=e.deletedAdsData,s=0;s<r;s++){var c=a[s],l=Ge(c,e.inventoryId),d=p.AdUtils.updateEventWithAdParams(y,l,{});if(o&&o[s].id==c){var u=o[s].failedAssetsUrlsArray.toString();d.rvnomoreoffersreason=u.substring(0,999)}Q.trackEvent(S.campaignFailedToCache,{},d),Ke(c,e.inventoryId)}if(0===y.numOfBannersToInitSuccess)t=1,n=te.areCampaignsAvailable(qe(e.inventoryId).slice(0,t),t);else{var f=Je(e.inventoryId);t=f.length;var g=Be(m.getOffers(e.inventoryId),y.numOfBannersToInitSuccess);i=g<=t?g:t,n=te.areCampaignsAvailable(f,i)}Z.cacheAdsFailed(A,n,e.errorLog,Re.bind(null,e.inventoryId))}})),M.push(u.PubSub.subscribe("PrecacheManager.preProcessingFailedCallback",function(e){if(z.shouldReceiveMessage(q,e)){p.log("PM | preProcessingFailedCallback "+e,p.LogLevels.verbose);var n=e.id,t=Ge(n,e.inventoryId);Ue(t)&&(z.extendCallbackParamsWithProductConfig(q,t),p.addAdToLoadedCreatives(t),Ve(),me(t))}})),M.push(u.PubSub.subscribe("Cache.assetRetrySuccess",function(e){if(e.productType===c.productType&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]";e.assetType===f.assetType.adunitAsset?Q.trackEvent(S.adUnitRetrySuccess,{generalMessage:n.substring(0,250)}):e.assetType===f.assetType.adAsset&&Q.trackEvent(S.adAssetRetrySuccess,{generalMessage:n.substring(0,250)})}})),M.push(u.PubSub.subscribe("Cache.assetRetryFailed",function(e){if(e.productType===c.productType&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]";e.assetType===f.assetType.adunitAsset?Q.trackEvent(S.adUnitRetryFail,{generalMessage:n.substring(0,250)}):e.assetType===f.assetType.adAsset&&Q.trackEvent(S.adAssetRetryFail,{generalMessage:n.substring(0,250)})}})),M.push(u.PubSub.subscribe("Cache.executeRetryFileUrlEmpty",function(e){var n={},t=e.listOfFilesUrls.toString();n.callfailreason=e.failedCachedFile.substring(0,255),n.rvnomoreoffersreason=t.substring(0,999),Q.trackEvent(S.executeRetryFileUrlEmpty,{},n)})),M.push(u.PubSub.subscribe("SDKController.AdTracked",function(e){z.shouldReceiveMessage(q,e)&&(e=p.AdUtils.formatParamsToAdId(e),p.callSDKFunction("adCredited",z.extendCallbackParamsWithParentProductConfig(q,{credits:Ge(p.AdUtils.getAdId(e),e.inventoryId).credits}),"adCreditedSuccess","adCreditedFailed"))})),M.push(u.PubSub.subscribe("SDKController.AdStarted",function(e){if(z.shouldReceiveMessage(q,e)&&p.RingerSwitchService.isInitiated()){var n={},t=Pn();t&&t.ext&&(n=ot(I.ext)),p.RingerSwitchService.startListener(n),p.log("Ringer | startListener ringer status from AdStarted.",p.LogLevels.info)}})),M.push(u.PubSub.subscribe("SDKController.Analytics",function(e){if(z.shouldReceiveMessage(q,e)&&e&&e.action){var n=e.action,t=e.eventParam;"fireEvent"===n?Q.trackEvent(t.eName,t.label,t.data):"startTiming"===n?Q.trackTimingStart(t.eName,t.data):"stopTiming"===n?Q.trackTimingStop(t.eName,t.data):"setCustomData"===n&&Q.updateBaseData(t.data)}})),M.push(u.PubSub.subscribe("SDKController.AdLoaded",function(e){if(z.shouldReceiveMessage(q,e)){var n=p.AdUtils.getAdId(e),t=Ge(n,e.inventoryId),i=e.inventoryId;clearTimeout(L),p.log("ad loaded with params: "+JSON.stringify(e),p.LogLevels.verbose),t&&Q.updateBaseData({rvPlayMethod:t.displayMode});var r=0;if(u.VastUtils.isVastCampaign(t)&&(r=u.VastUtils.getVastViewCount(t)),u.Utils.isDefined(e.errMsg)){X.publish("AdErrorState",[z.extendCallbackParamsWithDemandConfig(q,{error:!0})]),p.log("Error in loading ad: "+e.errMsg,p.LogLevels.error);var a={generalMessage:e.errMsg,vastViewCount:u.VastUtils.getVastViewCountForEvent(r)};return a=p.AdUtils.updateEventWithAdParams(y,t,a),Q.trackEvent(S.adLoadedError,{},a),t.ext.isHybridFlow&&t.ext.viewUniqueId&&(p.HybridService.clearAppPage(t.ext.viewUniqueId),u.PubSub.publish("HybridService.closeHybridFlow",[{viewUniqueId:t.ext.viewUniqueId}])),u.VastUtils.setMaxVastCount(t),Cn(t),void me(e)}y.viewType===f.viewTypes.externalView&&Q.incrementSessionNumber(),Q.trackEvent(S.adLoaded,{vastViewCount:u.VastUtils.getVastViewCountForEvent(r)}),u.Utils.isDefined(e.enableBackButton)&&p.setBackButtonState(e.enableBackButton),e=p.AdUtils.formatParamsToAdId(e),p.onAdLoaded(Ge(p.AdUtils.getAdId(e),e.inventoryId)),Z.adLoadedSuccessfully(m.size(i),We(i))}})),M.push(u.PubSub.subscribe("SDKController.AdLoadError",function(e){z.shouldReceiveMessage(q,e)&&(Z.adLoadError(),p.unloadFramesByProduct(q),gt()||Mn())})),M.push(u.PubSub.subscribe("SDKController.AdError",function(e){z.shouldReceiveMessage(q,e)&&p.log("SDKController.AdError:"+JSON.stringify(e),p.LogLevels.verbose)})),M.push(u.PubSub.subscribe("SDKController.dialogBoxResume",function(e){z.shouldReceiveMessage(q,e)&&Q.trackEvent(S.dialogBoxResume)})),M.push(u.PubSub.subscribe("SDKController.dialogBoxExit",function(e){z.shouldReceiveMessage(q,e)&&Q.trackEvent(S.dialogBoxExit)})),M.push(u.PubSub.subscribe("SDKController.adClosed",function(e){z.shouldReceiveMessage(q,e)&&Q.updateBaseData({rvPlayMethod:null,dynamicDemandSource:null})})),M.push(u.PubSub.subscribe(c.productType+".GetConfig",function(t){if(z.shouldReceiveMessage(q,t)){var e=Pn();if(!e)return void p.log("line[331]:get config with no loaded ad",p.LogLevels.verbose);u.VastUtils.isVastCampaign(e)&&B?B.then(function(e,n){ue(n||e,t)}):(p.HybridService.isHybridCampaign(e,y)&&ce(e),ue(e,t))}})),M.push(u.PubSub.subscribe(c.productType+".isVisible",function(e){if(z.shouldReceiveMessage(q,e)){var n=Pn(),t=p.getCurrentDisplayedAd();if(p.isAdDisplayed(n))return;n&&(t&&p.getCurrentDisplayedAdType()!==c.productType?Q.trackEvent(S.bannerLoadedDuringShow):(p.setCurrentDisplayedAd(n),p.getCurrentDisplayedAdType()===f.BN&&oe.shouldReportAdVisible()&&p.onAdVisible()))}}))};function ce(e){e.ext.shouldInitHybridFlow=!0}function le(){var e=ft()?f.integrationType.manual:f.integrationType.automatic,n={productChance:(p.getEnv(),1),baseData:{productType:q.productType,demandSourceName:q.demandSourceName,integrationType:e,isBiddingInstance:gt()}};return u.Eventics.createEventic(n)}function de(){return Q}function ue(e,n){var t=Ge(p.AdUtils.getAdId(e),e.inventoryId);return t?(u.VastUtils.isVastCampaign(e)||fe(t),p.MOATService.containsMOATData(e)&&p.MOATService.enableTracking(),Se(t),n&&n.callback&&n.callback.call(null,t)):p.log("line[456]: no current available ad",p.LogLevels.verbose),t}function fe(e){y.requestID&&(e.requestID=y.requestID);var n=ge(p.getApiData({scdn:1,protocol:0,defaultProtocol:1}).scdn);return v.extend(!0,e,p.getFormattedDeviceData(),pe(n))}function ge(e){var n=p.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+e;return"prod"!==p.getEnv()&&(n=p.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env),n}function pe(e){return{settings:{protocol:p.decideUrlProtocolAccordingToHTTPSCompliance(),urltocdn:e,appKey:p.getSDKDataByKey(f.requiredSDKDataKeys.applicationKey),appOrientation:p.getSDKDataByKey(f.requiredSDKDataKeys.appOrientation),deviceLanguage:p.getSDKDataByKey(f.requiredSDKDataKeys.deviceLanguage),bundleId:p.getSDKDataByKey(f.requiredSDKDataKeys.bundleId),sdkAbName:p.getSDKDataByKey(f.requiredSDKDataKeys.sdkAbName),deviceId:p.getDeviceId()}}}function ve(){k=E=B=null}function me(e){var n=p.AdUtils.getAdId(e);je(n,e.inventoryId);var t=X.getStatus().duringEngage;Ln(n,e.inventoryId),ve();var i=l.getNextAd(t,e.inventoryId),r=function(){p.log("DemandSource | adLoaded with error - removing and moving to next offer",p.LogLevels.verbose),wn(null),p.removeAdUnit(Ge(n,e.inventoryId))};if(t&&!i){var a=m.getBackfillOffer(e.inventoryId);if(a){Tn();var o=p.AdUtils.updateEventWithAdParams(y,a,{rvPlayMethod:a.displayMode});Q.trackEvent(S.backFill,{},o),r()}else{p.log("RV adLoaded with error | no offers for user - show dialog",p.LogLevels.verbose),p.setCloseButtonState({productType:c.productType,demandSourceName:d,state:x.close});var s={productType:c.productType,message:O&&O.noOffers?O.noOffers:f.labels.noOffers,yes:"close",alwaysClose:!0};p.alert(s),Q.trackEvent(S.userAlert,{inventoryIndex:e.inventoryIndex||-1})}}else r()}function be(e){return e&&e.displayMode?e.displayMode:C.softprecache}function he(){var e=m.getActiveInventoryId();Q.incrementSessionNumber();var n=Pn()||Qe(e);n||(n=_e(!0,e));var t=p.AdUtils.updateEventWithAdParams(y,n,{});t.rvPlayMethod=be(n),Q.updateBaseData(t)}function Se(e){var n=e.displayMode!=C.softprecache&&te.isPrecache();void 0===e.productType&&(e.productType=q.productType),void 0===e.demandSourceName&&(e.demandSourceName=q.demandSourceName),e.settings.precache=n,e.settings.sessionDepth=re,e.settings.viewType=y.viewType,u.AdAssets.isAdAbleToCache(e)&&(e.settings.ableToCache=e.ext.ableToCache,delete e.ext.ableToCache),p.MOATService.containsMOATData(e)&&p.MOATService.isTrackingEnabled()&&(e.settings.moatData=p.MOATService.extractMoatDataFromAd(e));var t=p.getConfig().controllerConfig;u.Utils.isNestedObjectExists(function(){return t.adContainer.infoButton.text})&&(e.settings.adContainerInfoText=t.adContainer.infoButton.text)}var ye=function(e){var n="AttemptToBringNewAds | ";if(p.log(n),Q.trackEvent(S.attemptToBringNewFeed,{generalMessage:X.getStatusMsg()}),ft()||Q.trackTimingStart(S.initAdToAdReady),N)p.log(n+"Cannot bring feed attemptToBringNewAdsInProcess="+N);else{if(N=!0,!X.allowExternalCallToApi())return p.log(n+"Cannot bring feed: "+X.getStatusMsg()),void(D=setTimeout(function(){N=!1,p.log(n+"2 minutes delay finished"),ye(e)},c.timerLengths.riDelay));Z.inventoryEmpty(e),setTimeout(function(){p.log(n+"Can bring feed"),Ce(y.refreshInterval),p.unloadFramesByProduct(q),N=!1,Mn()},0)}},Ce=function(e){p.log("setting refresh interval to: "+e,p.LogLevels.info),o&&clearInterval(o),e&&0!==e&&!gt()?o=setInterval(function(){Q.trackEvent(S.refreshInterval),X.canEngage()?(clearInterval(o),X.canInitCallToApi().then(ye)):(p.log("setDuringRefreshInterval(true)",p.LogLevels.info),ht(!0))},e*c.timeUnit):p.log("No Refresh interval is needed")};function Ae(e){U=e.labels,e.templateid==c.customDialog?U.confirmCloseMsg[f.confirmCloseMsgMap[0]].alwaysClose=!0:O=e.labels}var De=function(e){var n=e.seatbid.ext;n.shouldStartMuted=p.AdUtils.isCampaignShouldStartMuted(p.getConfig().controllerConfig,c.productType),v.extend(n,c.overrideFeedSettings),v.extend(n,p.getApplicationExternalConfig().getABTestConfiguration(Ie(),n.landingId)),o&&clearInterval(o),Kn()&&Ce(n.refreshInterval),p.isLegacy(p.featureMap.rvPortraitOrientation)&&(n.orientation=f.appInfo.orientation.landscape),c.productType===f.BN&&(n.numOfBannersToInitSuccess=0,n.numOfBannersToCache=0),y=n},Ie=function(){return q.demandSourceName===f.RIS?f.RIS:H.getProductType()},we=function(e){v.each(e,function(e,n){n.inventoryIndex=e,te.isPrecache()&&te.setAdInventoryIndex(p.AdUtils.getAdId(n),e)})};function Pe(){v.each(M,function(e,n){u.PubSub.unsubscribe(n)})}function Le(){D&&clearTimeout(D),o&&clearInterval(o)}function Te(e){var n=!!e&&e.engaged;Pe(),Le();var t=v.extend({},q,{engaged:n});u.PubSub.publish(c.productType+".exhaustedDemandSource",[t])}function Oe(e){var n,t=[];for(n=0;n<e.length;n++)te.isAdInCache(p.AdUtils.getAdId(e[n]))||t.push(e[n]);return t}var Fe=function(e){var t=[];return v.each(e,function(e,n){n.ext&&n.ext.appData&&n.ext.appData.adAssets&&(n.ext.appData.appImages=n.ext.appData.adAssets,delete n.ext.appData.adAssets),t.push(n)}),t},Ue=function(e){return te.isPrecache()&&u.VastUtils.isVastCampaign(e)&&e.ext.precacheVasts},xe=function(e){return 1===e.length&&Ue(e[0])&&(P=!0),u.Utils.returnResolvedPromise()},Ne=function(e){return on(u.VastUtils.isVastCampaign(e)),e.inventoryId&&fn(),rn(e).then(function(e,n){return p.AdUtils.formatVastAdForPrecache(n,Ne.bind(null,e))})},Me=function(e){var n=[];return P?n.push(p.AdUtils.formatVastAdForPrecache(e[0],Ne.bind(null,e[0]))):n=p.AdUtils.formatAdsForPrecache(e),n},ke=function(a,o){var s,c,e,l=te.isPrecache();a=Fe(a),we(a);var d=m.setOffers(a.slice(0),o);s=Me(a),c=Be(a,y.numOfBannersToCache);var n=function(){if(u.VastUtils.isThereVastCampaign(qe(d))&&Z.setAMSettings({reportOnAdunitReady:!1},!0),l){var e=Be(a,y.numOfBannersToInitSuccess),n=te.areCampaignsAvailable(s.slice(0,e),e);p.log("DemandSource | updateCurrentAds areCampaignsAvailable "+n,p.LogLevels.verbose);var t=Re.bind(null,d);Z.preCacheMode(n,c,t,u.VastUtils.areAllCampaignTypesAreVast(qe(d)),dn.bind(null,d),m.size(d),We(d),u.VastUtils.isVastCampaign(a[0]));var i=Oe(s),r={cacheTimeoutSuccessCallback:function(){ke(a,o)},cacheTimeoutFailCallback:Ee,applicationUserId:p.getSDKDataByKey(f.requiredSDKDataKeys.applicationUserId),applicationKey:p.getSDKDataByKey(f.requiredSDKDataKeys.applicationKey),newAdsToEnterCache:i,inventoryId:d,adAssetsCacheConfig:G};te.handleCacheAds(r)}else Z.notPreCacheMode(Re.bind(null,d))};l&&(e=te.mergeCampaigns(s,c),p.log("DemandSource | updateCurrentAds after merge "+JSON.stringify(e),p.LogLevels.verbose)),!l||y.purgeCacheOnInit?(p.log("DemandSource | already purged cache so go strait to adding the new ads",p.LogLevels.verbose),n()):te.clearCacheByType(e).always(n)},Be=function(e,n){for(var t=e.length<n?e.length:n,i=n,r=0;r<t;r++)e[r].isCacheable||i--;return i},Ee=function(e){Z.cacheTimeoutFail(e)},Ve=function(){X.publish("InitiatedAPICall",[z.extendCallbackParamsWithProductConfig(q,{duringInit:!1})])},Re=function(e){p.log("ProductInstance | handlePossibleAdUnitsReady",p.LogLevels.verbose);var n=Qe(e);if(n){var t=u.VastUtils.isVastCampaign(n);if(P&&on(t,e))un(e);else{var i=m.size(e),r=We(e),a=u.VastUtils.areAllCampaignTypesAreVast(qe(e));Z.canReportAvailable(i,r,a,t)}oe&&q.productType===f.BN?It(y,q,F):l.attemptToPreloadAd(!1,e)}},Ke=function(e,n){m.removeOfferById(e,n)&&!m.isEmpty(n)&&te.incrementNextCampaign()},je=function(e,n){if(!On()){var t=m.getOfferById(e,n);t?t.toRemove=!0:p.log("Error in mark current ad to be removed:"+e,p.LogLevels.error),V=null}},We=function(e){for(var n=0,t=m.getOffers(e),i=m.size(e),r=0;r<i;r++)n+=t[r].credits;return n},Ge=function(e,n){var t=m.getOfferById(e,n);if(!t){if(On())return m.getBackfillOffer(n);p.log("Error in getAdUnitById, id "+e+" not found in "+JSON.stringify(m.getOffers(n)),1)}return t},He=function(e,n,t){return m.replaceOfferById(e,n,t)},qe=function(e){return v.grep(m.getOffers(e),function(e){return!(u.Utils.isDefined(e.toRemove)&&e.toRemove)})},Je=function(e){var n=qe(e);return v.grep(n,function(e){return e.isCacheable})},Qe=function(e){var n,t=Ge(p.AdUtils.getAdId(Ye(e)),e);return n=te.isPrecache()&&t&&t.isCacheable?(t=Ge(p.AdUtils.getAdId($e(e)),e),C.precache):C.nonprecache,t&&!t.displayMode&&ze(t,n),t},_e=function(e,n){if(!e)return null;var t=Xe(n);return t?Ge(p.AdUtils.getAdId(t),n):null},ze=function(e,n){e&&(e.displayMode=n)},Xe=function(e){return 0<qe(e).length?qe(e)[0]:null},$e=function(e){return 0===y.numOfBannersToInitSuccess?te.getCurrentAd(qe(e).slice(0,1)):te.getCurrentAd(qe(e))},Ye=function(e){return m.getCurrentOffer(e)},Ze=function(e){var n=p.AdUtils.getAdId(e);X.publish("Engaged",[z.extendCallbackParamsWithProductConfig(q,{duringEngage:!1})]),wn(null),ve();var t=Ge(n,e.inventoryId);clearTimeout(L),t?(p.log("onEngageEnd with params: "+JSON.stringify(t),p.LogLevels.verbose),Ln(n,t.inventoryId),u.Utils.isDefined(t)&&t.toRemove&&(p.log("removing ad id: "+n,p.LogLevels.verbose),Ke(n,t.inventoryId))):p.log("Tried to end engage with no ad",p.LogLevels.error)},en=function(e){var n=p.AdUtils.getAdId(e),t=Ge(n,e.inventoryId);u.Utils.isDefined(t)&&t.toRemove&&(p.log("removing ad id: "+n,p.LogLevels.verbose),Ke(n,t.inventoryId))};function nn(e){k&&"pending"===k.state()&&(u.Utils.isDefined(e)?(p.log("handleVastAvailability - VAST failed to load with reason: "+e,p.LogLevels.verbose),k.reject()):(p.log("handleVastAvailability - VAST verified - resolve",p.LogLevels.verbose),k.resolve()))}function tn(e){var n="";return u.Utils.isDefined(q.demandSourceName)&&(n=q.demandSourceName),n+=q.productType+e}function rn(r){var a=p.AdUtils.getAdId(r),o=cn(r),s=r.inventoryId;if(r.ext.videoData.isVast&&V){var e=u.VastUtils.getVastViewCount(r),n=r.settings.preload,t=r.displayMode;V=u.VastUtils.setVastViewCount(V,e),(r=V).settings.preload=n,r.displayMode=t}else(r=u.VastUtils.setVastViewCount(r,0)).ext.vastExhaustIndex&&1<r.ext.vastExhaustIndex&&(V=r);return fe(r),B=new v.Deferred,r.vastIframeId=tn(a),Q.trackTimingStart(S.parseVast),$.parseVast(r,te.isPrecache(),y).then(function(e){if(null!==B){if(Q.trackTimingStop(S.parseVastSuccess,{generalMessage:o,eNameStart:S.parseVast}),!u.Utils.isDefined(r.toRemove)||!r.toRemove){e.ext.videoData.isVast=!0,u.Utils.isDefined(r.displayMode)&&(e.displayMode=r.displayMode),u.VastUtils.incrementVastViewCount(e),nn(e.errMsg);var n=r;return u.VastUtils.incrementVastViewCount(n),He(r=e,p.AdUtils.getAdId(r),s),B.resolve(n,e)}$.removeIframe(tn(a))}},function(e){if(null!==B){var n={generalMessage:o,eNameStart:S.parseVast};if(n=p.AdUtils.updateEventWithAdParams(y,r,n),e.isTimeLimitReached&&(n.callFailReason="timeout"),Q.trackTimingStop(S.parseVastFail,n),!u.Utils.isDefined(r.toRemove)||!r.toRemove){var t=u.VastUtils.incrementVastViewCount(r);nn(e.errMsg),X.publish("AdErrorState",[z.extendCallbackParamsWithProductConfig(q,{error:!0})]),p.log("Error in loading ad: "+e.errMsg,p.LogLevels.error);var i={generalMessage:e.errMsg,vastViewCount:u.VastUtils.getVastViewCountForEvent(t)};return i=p.AdUtils.updateEventWithAdParams(y,r,i),Q.trackEvent(S.adLoadedError,{},i),u.VastUtils.setMaxVastCount(r),Cn(Ge(a,s)),B.reject()}$.removeIframe(tn(a))}})}function an(e){return E=new v.Deferred,e.ext.viewUniqueId=p.HybridService.createHybridId(e,q),p.HybridService.loadHybridCampaign(p.AdUtils.getStoreAppId(e),e.ext.viewUniqueId).then(function(){if("resolved"!==E.state())return e.ext.forceOrientation="portrait",e.ext.isHybridFlow=!0,E.resolve()},function(){if("resolved"!==E.state())return Q.trackEvent(S.hybridFlowFail,{callFailReason:"Store load fail"}),e.ext.isHybridFlow=!1,E.resolve()})}function on(e,n){return sn(e)||ln(n)}function sn(e){return y.preFetchAllVasts&&e}function cn(e){var n;return sn(u.VastUtils.isVastCampaign(e))?n="preFetchAllVasts":ln(e.inventoryId)&&(n="vastAvailabilityValidation"),n}function ln(e){return te.isPrecache()&&u.VastUtils.areAllCampaignTypesAreVast(qe(e))}function dn(e){p.log("handleVastAvailability",p.LogLevels.verbose),fn(),un(e),Ve()}function un(e){v.when(k).then(function(){Z.allVastPromiseResolved(m.size(e),We(e))})}function fn(){k&&"pending"===k.state()||(k=new v.Deferred)}var gn=function(){return X.canInitCallToApi().then(function(){},function(){return p.log(c.errors.init[1001]+X.getStatusMsg(),p.LogLevels.error),c.errors.init[1001]}).then(function(){X.publish("InitiatedAPICall",[z.extendCallbackParamsWithProductConfig(q,{duringInit:!0})]);var e=new(Ot("./FetchDemand/FetchDirect.js"))(v.ajax,c.timerLengths.serverResponseTimeoutInMilis);return s++,u.Utils.decodeValues(i),f.BN===c.productType&&Q.trackEvent(S.getInventory),_.applyCommunicationSolution(window.timerService.timeElapsed(window.lastWebviewClosedTimer)),e.fetchFeed(H.getDestination(d),i)}).then(pn).then(mn,function(e,n){var t,i=new v.Deferred;switch(t=c.errors.init[1005],typeof e){case"object":e.responseText&&""!==e.responseText?t=e.responseText:e.errorMessage&&""!==e.errorMessage&&(t=e.errorMessage);break;case"string":""!==e&&(t=e)}return Ve(),"timeout"===n?i.reject(c.errors.load.timeout):i.reject(t),i.promise()})},pn=function(e){var n=new v.Deferred;if(u.Utils.isDefined(e.response)&&u.Utils.isDefined(e.response.errorCode)){Ve();var t=u.Utils.isDefined(e.response.errorMessage)&&e.response.errorMessage?e.response.errorMessage:c.errors.init[1003];n.reject(t)}else u.Utils.isDefined(e.seatbid)&&u.Utils.isDefined(e.seatbid.bid)&&u.Utils.isDefined(e.seatbid.ext)&&u.Utils.isDefined(e.seatbid.ext.labels)?n.resolve(e):(Ve(),n.reject(c.errors.init[1004]));return n.promise()};function vn(e){if(e){var n={blacklistedCampaigns:e.join(",")};p.getIABService().updateToken(n)}}var mn=function(e){var a=function(e){return gt()&&(y.disableTokenFiltering||void 0===e||0===e.length||(e.forEach(An),vn(H.filteredListService.getFilteredListCampaigns()))),u.Utils.returnResolvedPromise()};return function(e){X.setConnection(!0);var t=e.seatbid.bid,n=e.seatbid.ext;H.getAmountOfSupportedInventories()===f.DEFAULT_AMOUNT_OF_INVENTORIES&&m.reset();var i=m.getAvailableInventoryId();if(Q.updateBaseData({landingId:n.landingId,strategyId:n.strategyId}),e.seatbid.backfill){var r=e.seatbid.backfill;r.id=p.AdUtils.getAdId(r),ze(r,C.softprecache),i=m.setBackfillOffer(r,i)}return v.when(De(e),Ae(n)).then(ee.filterByAppInstalled.bind(null,t,y,c.filterDisableTypes)).then(a).then(function(e){for(var n=e&&e.length||0,t="",i=0;i<n;i++)t+=p.AdUtils.getAdType(e[i],y),i<n-1&&(t+=", ");return Q.updateBaseData({feedSize:n,feedCampaignOrder:t}),u.Utils.returnResolvedPromise()}.bind(null,t)).then(function(e){return e.some(p.OMIDService.isAdOmidSupported)&&p.OMIDService.downloadOmidJsBundle(),u.Utils.returnResolvedPromise()}.bind(null,t)).then(te.decidePrecacheStatus.bind(null,{numOfCampaigns:t.length,settings:y})).then(function(){return Z.setAMSettings({preFetchAllVasts:y.preFetchAllVasts,shouldRefreshInventory:Rn(y),isPreCache:te.isPrecache(),numOfBannersToInitSuccess:y.numOfBannersToInitSuccess,reportOnAdunitReady:y.reportOnAdunitReady}),t&&0<t.length?(A=!1,kn(),p.adUnitGlobals.updateAdUnitGlobals(!0,jn(),W,Q)):u.Utils.returnRejectedPromise("We did not receive any campaigns in inventory")}).then(function(){return v.when(Wn(t)?p.libsManager.manageDownloadLibsFileByFiletype(c.libsCacheFiles.dapi):u.Utils.returnResolvedPromise(),(n=t,te.isPrecache()&&Gn(n)?p.libsManager.manageDownloadLibsFileByFiletype(c.libsCacheFiles.externalObfuscation).then(function(e){Hn(n,e)}):u.Utils.returnResolvedPromise()));var n}).then(te.handleCacheClear).then(xe(t)).then(function(){return A=!0,Bn(),ke(t,i)}).fail(function(e){var n=e||"Fail parse adUnit info from api response";m.removeInventory(i),f.BN===c.productType&&Q.trackEvent(S.getInventoryFailed,{generalMessage:n}),Fn(),e&&p.log(e,p.LogLevels.error),Z.inventoryEmpty(e||n),Pt()&&Te()}),(new v.Deferred).resolve(v.extend({},e.seatbid.ext,{numOfAdUnits:e.seatbid.bid.length}))}(e)},bn=function(){v.each(T,function(e,n){clearTimeout(n)}),T=[]};function hn(){X.publish("Engaged",[z.extendCallbackParamsWithProductConfig(q,{duringEngage:!0})])}function Sn(){var e;e={productType:c.productType,message:O&&O.noInternet?O.noInternet:f.labels.noInternet,yes:"close",alwaysClose:!0},p.alert(e)}var yn=function(e,n,t){var i,r=p.AdUtils.getAdId(e);p.log("Error in loading ad - timeout in "+r,p.LogLevels.error),i=t?S.showAdFail:S.adLoadedError;var a={isprecache:te.isPrecache()};a=p.AdUtils.updateEventWithAdParams(y,e,a),Q.trackEvent(i,{generalMessage:"Error in loading ad - timeout"},a),z.extendCallbackParamsWithProductConfig(q,e),u.VastUtils.isVastCampaign(e)&&Cn(e),je(r,e.inventoryId),wn(null),ve(),$.removeIframe(tn(r)),y.viewType===f.viewTypes.externalView?p.removeAdUnitFromExternal(e):p.removeAdUnit(e)},Cn=function(e){On()||(e&&e.cid?p.blacklistService.addToBlacklistedCampaigns(q.productType,q.demandGroupName,e.cid):p.log("DemandSource | cannot add to blacklist with no ad",p.LogLevels.error))},An=function(e){e&&e.cid&&H.filteredListService.addToFilteredListCampaigns(e.cid)},Dn=function(){var e={errMsg:"",didSucceed:!0};return u.Utils.isDefined(y.allowMultiInitCalls)&&!y.allowMultiInitCalls?(e.errMsg=c.errors.init.multi,e.didSucceed=!1):X.allowExternalCallToApi()?r.shouldFail(p.getConfig())&&(e.errMsg=c.errors.init.deviceOsIsNotSupported,e.didSucceed=!1):(e.errMsg="Already attempting to initiate",e.didSucceed=!1),e},In=function(){D&&clearTimeout(D)},wn=function(e){I=e},Pn=function(){return I},Ln=function(e,n){var t=m.getBackfillOffer(n);t&&e==t.id&&(w=!1)},Tn=function(){w=!0},On=function(){return!0===w},Fn=function(){wn(null),ve(),Z.reset(),b.reset()},Un=function(){m.reset(),X.publish("InitiatedTimeoutAttempt",[z.extendCallbackParamsWithProductConfig(q,{duringAPITimeoutAttempts:!1})]),Fn()},xn=function(){var e=!1;if(q.productType===f.BN&&m){var n=m.getActiveInventoryId();n&&(e=m.isNextOfferAvailable(n))}return e},Nn=function(){var e=m.getActiveInventoryId();if(e){var n=Qe(e);m.removeOfferById(n.id,e),Re(e)}};function Mn(i,r,a){var e=function(e){if(!o){s=0,X.publish("InitiatedTimeoutAttempt",[z.extendCallbackParamsWithProductConfig(q,{duringAPITimeoutAttempts:!1})]),e=e||c.errors.init[1002],f.BN===c.productType&&(Q.trackEvent(S.getInventoryFailed,{generalMessage:e}),oe.resetExternalAdViewsIdentifiers());try{if("string"==typeof e){var n=parseInt(e);1001<n&&n<1006&&(e=c.errors.load.invalid)}}catch(e){}var t=z.extendCallbackParamsWithDemandConfig(q,{errMsg:e});p.callSDKFunction(a,t),u.PubSub.publish(c.productType+".failedToLoad",[t]),Pt()&&Te()}};if(Fn(),xn())Nn();else{var o=!1;(T.push(setTimeout(function(){e(c.errors.load.timeout),o=!0},7*c.timeUnit)),(new v.Deferred).resolve()).then(In).then(dt).then(gn).always(bn).then(function(e){o||(s=0,X.publish("InitiatedTimeoutAttempt",[z.extendCallbackParamsWithProductConfig(q,{duringAPITimeoutAttempts:!1})]),ie=!1,p.callSDKFunction(r,z.extendCallbackParamsWithDemandConfig(q,e)))},function(e){var n=new v.Deferred,t=H.doesAllowConsecutiveGatewayRequestsDuringLoad();return o||(e===c.errors.load.timeout&&t&&s<c.maxNumOfAttemptsToCallAPI?(X.publish("InitiatedTimeoutAttempt",[z.extendCallbackParamsWithProductConfig(q,{duringAPITimeoutAttempts:!0})]),setTimeout(function(){Mn(i,r,a)},c.timerLengths.initAttemptsDelay),n.resolve()):n.reject(e)),n.promise()}).then(null,e)}}function kn(){W=En(c.productType,y.adunitRetryAttempts,y.adunitRetryInterval,f.assetType.adunitAsset)}function Bn(){G=En(c.productType,y.adAssetRetryAttempts,y.adAssetRetryInterval,f.assetType.adAsset)}function En(e,n,t,i){return{productType:e,retryAttempts:n,retryInterval:t,assetType:i}}function Vn(e,n,i){if(e&&e.adm&&e.demandSourceName===d){p.log("loadAdWithAdm | resetting last response to none",p.LogLevels.verbose),p.unloadFramesByProduct(q),Fn(),_.applyCommunicationSolution(window.timerService.timeElapsed(window.lastWebviewClosedTimer));(X.publish("InitiatedAPICall",[z.extendCallbackParamsWithProductConfig(q,{duringInit:!0})]),u.Utils.returnResolvedPromise(e.adm)).then(pn).then(mn,function(e){var n;switch(n=c.errors.init[1005],typeof e){case"object":e.responseText&&""!==e.responseText?n=e.responseText:e.errorMessage&&""!==e.errorMessage&&(n=e.errorMessage);break;case"string":""!==e&&(n=e)}return Ve(),u.Utils.returnRejectedPromise(n)}).then(function(e){p.callSDKFunction(n,z.extendCallbackParamsWithDemandConfig(q,e))},function(e){try{if("string"==typeof e){var n=parseInt(e);1001<n&&n<1006&&(e=c.errors.load.invalid)}}catch(e){}var t=z.extendCallbackParamsWithDemandConfig(q,{errMsg:e});p.callSDKFunction(i,t),u.PubSub.publish(c.productType+".failedToLoad",[t]),Pt()&&Te()})}}function Rn(e){return!(e.singleInventoryPerSession&&!0===e.singleInventoryPerSession)}function Kn(){return!gt()}function jn(){return y.purgeAdunitLibsFile}function Wn(e){for(var n=0;n<e.length;n++){var t=e[n].ext.layoutData;if(u.Utils.isDefined(t)&&u.Utils.isDefined(t.html)&&0<t.html.length)return!0}return!1}function Gn(e){for(var n=!1,t=0;t<e.length;t++)if(p.AdUtils.isPlayablePrecachedAd(e[t])){n=!0;break}return n}function Hn(e,n){for(var t=0;t<e.length;t++)p.AdUtils.isPlayablePrecachedAd(e[t])&&(e[t].ext.ableToCache="success"===n)}function qn(e){var n=y.numOfBannersToCache,t=qe(e).slice(0,n),i=!0;return v.each(t,function(e,n){return!p.AdUtils.isCacheableAd(n)||Ue(n)||te.isAdInCache(p.AdUtils.getAdId(n))||te.getAdStatusInQueue(p.AdUtils.getAdId(n))===te.cachingStatus.pending||(i=!1),i}),i}function Jn(e){te.isPrecache()&&!qn(e.inventoryId)?te.updateCache(G):P&&u.VastUtils.isVastCanPlayAgain(e)&&te.cacheSingleAd(p.AdUtils.formatVastAdForPrecache(e,Ne.bind(null,e)),G)}function Qn(e,n){if(p.log("engageEnd",p.LogLevels.verbose),z.shouldReceiveMessage(q,e))if(e.productType!==f.BN){zn(e);var t=Xn(ft());_n(X)?e.engaged?t.handlePrefetchFailedOnVisible(e):t.handlePrefetchFailedOnBackground(e):e.engaged?t.handleAdClosed(e):t.handlePrefetchFailedOnBackground(e),(u.Utils.isFunction(n)?n:function(){})()}else en(e)}function _n(e){p.log("getAndResetErrorStateFromTaskManager",p.LogLevels.verbose);var n=e.getStatus().adErrorState;return e.publish("AdErrorState",[z.extendCallbackParamsWithProductConfig(q,{error:!1})]),n}function zn(e){p.log("_resetPreloadedAd",p.LogLevels.verbose),Ze(e),Q.resetBaseData(f.baseDataKeys),b.setCanPreloadFlag(!0)}function Xn(e){return e?$n:Yn}var $n={handleCappingOnAdClosed:function(e){p.log("_handleCappingOnAdClosed | ManuelLoad",p.LogLevels.verbose),this.publishNoMoreOffers(f.noMoreOffersReason.noMoreOffersToShowInFeed),Te(e)},handlePrefetchFailedOnBackground:function(e){p.log("_backgroundPrefetchFailed | ManualLoad",p.LogLevels.verbose),l.getNextAd(!1,e.inventoryId,!0)?Jn(e):this.publishNoMoreOffers(f.noMoreOffersReason.noMoreOffersToShowInFeed)},handlePrefetchFailedOnVisible:function(e){p.log("handlePrefetchFailedOnVisible | manuel load",p.LogLevels.verbose),Jn(e)},shouldPerformInternalLoad:function(){return c.overrideFeedSettings.isSupportFetchFeedOnAdCloseLogic&&c.overrideFeedSettings.shouldFetchNewFeedOnAdClose},handleAdClosed:function(e){if(p.log("handleAdClosed | manuel load",p.LogLevels.verbose),wt())this.handleCappingOnAdClosed(e);else{if(gt())return p.log("handleAdClosed | manuel load | isInAppBiddingInstance=true"),void m.removeInventory(e.inventoryId);if(this.shouldPerformInternalLoad())return m.removeInventory(e.inventoryId),void ye();p.log("handleAdClosed | manuel load | Do not perform internal load."),Fn(),m.reset(),u.PubSub.publish(c.productType+".resetStateManager",[q])}},publishNoMoreOffers:function(e){p.log("publishNoMoreOffers | ManualLoad",p.LogLevels.verbose);var n=z.extendCallbackParamsWithDemandConfig(q,{errorMsg:e||f.noMoreOffersReason.noMoreOffersToShowInFeed});u.PubSub.publish(c.productType+".NoMoreOffers",[n])}},Yn={handleCappingOnAdClosed:function(e){p.log("_handleCappingOnAdClosed | AutomaticLoad",p.LogLevels.verbose),Z.instanceReachCapping(f.noMoreOffersReason.noMoreOffersToShowInFeed,Te.bind(null,e))},handlePrefetchFailedOnBackground:function(e){p.log("_backgroundPrefetchFailed | AutomaticLoad",p.LogLevels.verbose),l.getNextAd(!1,e.inventoryId,!0)?this.bringNextAdFromExistingFeed(e):Rn(y)?this.bringNextAdFromNewFeed():this.endSessionOnInstance(e)},handlePrefetchFailedOnVisible:function(e){p.log("handlePrefetchFailedOnVisible | automatic load",p.LogLevels.verbose),Jn(e)},handleAdClosed:function(e){(p.log("handleAdClosed | automatic load",p.LogLevels.verbose),wt())?this.handleCappingOnAdClosed(e):l.getNextAd(!0,e.inventoryId,!0)?St()&&Rn(y)?(m.removeInventory(e.inventoryId),this.bringNextAdFromNewFeed(St())):this.bringNextAdFromExistingFeed(e):Rn(y)?(m.removeInventory(e.inventoryId),this.bringNextAdFromNewFeed()):this.endSessionOnInstance(e)},bringNextAdFromNewFeed:function(e){p.log("bringNextAdFromNewFeed | AutomaticLoad",p.LogLevels.verbose),ht(!1);var n=e?f.noMoreOffersReason.refreshFeedAfterClosingAd:f.noMoreOffersReason.noMoreOffersToShowInFeed;ye(n)},bringNextAdFromExistingFeed:function(e){p.log("bringNextAdFromExistingFeed | AutomaticLoad",p.LogLevels.verbose),Jn(e),Z.adClosedMovingToNextAd(u.VastUtils.areAllCampaignTypesAreVast(qe(e.inventoryId)),f.noMoreOffersReason.noMoreOffersToShowInFeed)},endSessionOnInstance:function(e){p.log("endSessionOnInstance | AutomaticLoad",p.LogLevels.verbose),Z.sessionOver(f.noMoreOffersReason.noMoreOffersToShowInFeed,Te.bind(null,e))}};function Zn(e){if(z.shouldReceiveMessage(q,e)){var n=p.AdUtils.getAdId(e),t=Ge(n,e.inventoryId);X.publish("Engaged",[z.extendCallbackParamsWithParentProductConfig({duringEngage:!0})]);t.displayMode;if(u.VastUtils.isVastCampaign(t)){var i=u.VastUtils.getVastViewCount(t);Q.trackTimingStop(S.adVisible,{vastViewCount:u.VastUtils.getVastViewCountForEvent(i),eNameStart:S.showAdCalled}),u.VastUtils.isVastCanPlayAgain(t)||je(n,e.inventoryId)}else Q.trackTimingStop(S.adVisible,{eNameStart:S.showAdCalled}),je(n,e.inventoryId);re++,Q.trackTimingStart(S.adVisibleToClose)}}function et(e,n,t){return new(Ot("../../components/precacheManager.js"))(e,n,nt(t))}function nt(e){var n,t=q.productType+"_"+q.demandSourceName;return n=q.productType===f.IS?q.productType:f.BC,a.cacheBase=e?n:t,a.precachePath="../"+a.cacheBase+"/",v.extend(a,q),a}function tt(e){return q[e]}function it(e,n){e&&e.demandSourceName===d&&dt().then(function(e){u.Utils.isFunction(n)&&n({payload:e,eventics:Q})})}function rt(e,n,t){if(p.log("in load ad with params: "+JSON.stringify(e),p.LogLevels.verbose),e&&e.demandSourceName===d){var i=Dn();if(i.didSucceed)p.unloadFramesByProduct(q),p.log("resetting last response to none",p.LogLevels.verbose),Mn(e,n,t);else{var r=ft()?S.loadAdFailed:S.initAdFail;Q.trackEvent(r,{callFailReason:i.errMsg,demandSourceName:d}),p.callSDKFunction(t,z.extendCallbackParamsWithDemandConfig(q,{errMsg:i.errMsg}))}}else Q.trackEvent(S.loadAdIgnored,{callFailReason:c.errors.general.dsNameNotValid})}function at(e,n,t){var i=Qe(m.getActiveInventoryId());p.RingerSwitchService.isInitiated()&&i&&(p.RingerSwitchService.startListener(ot(i.ext)),p.log("Ringer | startListener from DS.",p.LogLevels.info)),p.isLegacy(p.featureMap.demandState)||pt(),l.preload(!0,m.getActiveInventoryId()).then(function(){return l.show(Pn())}).then(function(){ct(n)},function(e){p.log("Cannot engage at this time "+X.getStatusMsg(),p.LogLevels.error),X.getStatus().isConnected||Sn(),lt(t,e)})}function ot(e){return e?{ringerUpdateDelay:y.ringerUpdateDelay,shouldSetRingerUpdateDelay:p.AdUtils.isPlayableCampaign(e)||p.AdUtils.isMRAIDCampaign(e)||p.AdUtils.isExternalCampaign(e)}:{}}function st(){Z.instanceOnHold()}function ct(e){Q.trackTimingStop(S.showAdSuccess,{eNameStart:S.showAdCalled}),p.callSDKFunction(e,z.extendCallbackParamsWithDemandConfig(q)),J.onShowSuccess(q)}function lt(e,n){var t="Cannot engage offer at this time";u.PubSub.publish(c.productType+".failedToShow",[{errMsg:t}]);var i=n||t;i!==f.errors.showAdFailedReasons.preloadNoAd&&i!==f.errors.showAdFailedReasons.showNoAd&&(i=i+". "+X.getStatusMsg()),Q.trackEvent(S.showAdFail,{callFailReason:i}),p.callSDKFunction(e,z.extendCallbackParamsWithDemandConfig(q,{errMsg:t}))}function dt(){return ne.createPayload(re-1,ie,s).then(function(e){return i=e})}function ut(){return e&&e.integrationType}function ft(){return e&&e.integrationType===f.integrationType.manual}function gt(){return e&&e.isInAppBidding}function pt(){K=new v.Deferred;var n=u.PubSub.subscribe(R+".getDemandSourceStateSuccess",function(e){z.shouldReceiveMessage(q,e)&&(u.PubSub.unsubscribe(n),u.PubSub.unsubscribe(t),"resolved"!==K.state()&&(j=e&&e.state||j,K.resolve(e)))}),t=u.PubSub.subscribe(R+".getDemandSourceStateFail",function(e){z.shouldReceiveMessage(q,e)&&(u.PubSub.unsubscribe(t),u.PubSub.unsubscribe(n),"resolved"!==K.state()&&K.resolve())}),e=z.extendCallbackParamsWithParentProductConfig(q);p.callSDKFunction("getDemandSourceState",e,"getDemandSourceStateSuccess","getDemandSourceStateFail")}function vt(){return U&&U.confirmCloseMsg[f.confirmCloseMsgMap[0]]}function mt(e){var n=p.AdUtils.getAdId(e),t=a.precachePath+n+"/";u.AdAssets.updateAdunitPrecachePath(e,t,p.AdUtils.isPlayablePrecachedAd(e))}function bt(e,n,t){var i=!1;return e&&!n&&(p.AdUtils.isPlayablePrecachedAd(t)?u.AdAssets.isAdAbleToCache(t)&&(i=!0):u.VastUtils.isVastCampaign(t)&&!Ue(t)||(i=!0)),i}function ht(e){ae=e}function St(){return ae}function yt(e,n,t){var i=c.timerLengths.loadAdTimeout;clearTimeout(L),L=setTimeout(function(){yn(e,n,t)},i)}function Ct(e){!P&&u.VastUtils.isVastCampaign(e)&&(null!==B||u.Utils.isDefined(e.toRemove)&&e.toRemove||rn(e).then(null,me.bind(null,e)))}function At(e){var n=v.extend({name:"hybridCampaignStatusChange"},e);p.postAdUnitEvent(JSON.stringify(n),!0)}function Dt(e){At({viewUniqueId:e.ext.viewUniqueId,status:e.ext.isHybridFlow?"success":"fail"}),p.HybridService.isHybridCampaign(e,y)&&null!==E&&"pending"===E.state()&&(E.resolve(),Q.trackEvent(S.hybridFallback),p.HybridService.clearAppPage(e.ext.viewUniqueId),u.PubSub.publish("HybridService.closeHybridFlow",[{viewUniqueId:e.ext.viewUniqueId}]))}function It(r,a,o,s){oe.checkStatusOfAdView().then(function(e){var n=Qe(s);p.AdUtils.setViewType(r,n,f.viewTypes.externalView);var t=p.AdUtils.updateEventWithAdParams(r,n,{});Q.updateBaseData(t),wn(n),o.shouldBuildAdUnitUrlForExternal=!0;var i=g.getAdunitUrl(!1,a,o);e.isExternalAdViewInitiated?(ue(n),oe.updateAdInAdView(i,n,a,r)):(yt(n,i,!1),oe.createAdUrlInAdView(i,n,a,r)),p.addAdToLoadedCreatives(n)})}function wt(){var e=j===f.demandSourceStates.cappedPerSession;return e&&u.Utils.isDefined(q)&&p.log("isDemandCapped | demandSource "+q.demandSourceName+" is capped"),e}function Pt(){return c.isExhaustInstanceAllowed&&q.demandType===f.demandSourceType.instance}function Lt(){gt()&&c&&(c.isExhaustInstanceAllowed=!1)}var Tt={name:d,init:function(){l=this,t||(Fn(),te=et(u,p,z.isLegacy(q)),se(),te.init(),X.init(),p.initEventics(z.extendCallbackParamsWithParentProductConfig(q,{})),Lt(),t=!0)},isNextAvailable:function(e){if(te.isPrecache()){var n=qe(e);return te.isNextAvailable(n)||n&&n[0]&&!n[0].isCacheable}return m.isNextOfferAvailable(e)||u.VastUtils.isVastCanPlayAgain(Qe(e))},prepareAdToEngageEnd:function(e){return Ue(e)?te.deleteCachedCampaign(p.AdUtils.getAdId(e)):u.Utils.returnResolvedPromise()},getNextAd:function(e,n,t){var i=l.isNextAvailable(n);return te.isPrecache()&&!i&&(i=_e(t||e,n)),!i&&On()&&(i=m.getBackfillOffer(n)),i},attemptToPreloadAd:function(e,n){var t=wt();if(!t||e){var i=qe(n),r=Qe(n),a=sn(u.VastUtils.isVastCampaign(r))||u.VastUtils.areAllCampaignTypesAreVast(i),o=te.isPrecache();Z.preLoadNext(u.VastUtils.areAllCampaignTypesAreVast(i),dn.bind(null,n),u.VastUtils.isVastCampaign(r)),b.canPreloadCandidateAd(t,e,r,a,o)&&l.preloadAd(e,n)}else p.log("Skipping preload on capped demand",p.LogLevels.verbose)},preloadAd:function(e,n){l.preload(e,n).then(function(){e&&l.show(Pn())})},preload:function(e,n){var t,i=new v.Deferred;return X.canPreload()?(t=Pn()||Qe(n))||(t=_e(e,n),ze(t,C.softprecache),t)?(v.extend(!0,t,q),p.isContainerLoaded(t)?i.resolve():p.MOATService.vastContainsMOATData(t)||p.MOATService.containsMOATData(t)?setTimeout(function(){l.preloadFlow(t,e,i)},0):l.preloadFlow(t,e,i),i.promise()):(p.log("Cannot preload with no offer",p.LogLevels.error),u.Utils.returnRejectedPromise(f.errors.showAdFailedReasons.preloadNoAd)):(p.log("Cannot preload at this time, "+X.getStatusMsg(),p.LogLevels.error),u.Utils.returnRejectedPromise(f.errors.showAdFailedReasons.taskManagerPreload))},preloadFlow:function(e,n,t){b.preloadAdFinished();var i=!1,r=te.isPrecache(),a={preload:!n};e.displayMode==C.softprecache&&(i=!0),bt(r,i,e)&&mt(e),p.log("line[1019]: preload with "+JSON.stringify(e),p.LogLevels.verbose);var o=p.AdUtils.updateEventWithAdParams(y,e,{});Q.updateBaseData(o),wn(e);var s=i?g.getAdunitUrl(!1,q,F):g.getAdunitUrl(r,q,F);yt(e,s,n),v.extend(y,a),p.AdUtils.setViewType(y,e),!p.HybridService.isHybridCampaign(e,y)||null!==E||n||u.Utils.isDefined(e.toRemove)&&e.toRemove||an(e),h.shouldShowInStandAloneView(p.getConfig())&&p.AdUtils.extendSettingsWithStandaloneViewSupport(y),e=p.StoreKitService.updateAdWithStoreAppId(e,y),p.loadAdUnitUrl(e,s,q,y),Ct(e),t.resolve()},show:function(e){return e?X.canEngage()?(hn(),Dt(e),p.displayAdUnitFrame(e),u.Utils.returnResolvedPromise()):u.Utils.returnRejectedPromise(f.errors.showAdFailedReasons.taskManagerEngage):u.Utils.returnRejectedPromise(f.errors.showAdFailedReasons.showNoAd)},getConfirmCloseMsg:vt,getDSEventics:de,adVisible:Zn,engageEnd:Qn,initProduct:it,instanceOnHold:st,loadAd:rt,updateEventicsWithAdData:he,showAd:at,onShowAdFailed:lt,getProperty:tt,getIntegrationType:ut,isInAppBiddingInstance:gt,loadAdWithAdm:Vn,isDemandCapped:wt,reset:Un};return l=Tt,Tt}e.exports=t},{"../../components/CampaignsFilter.js":8,"../../components/VastService.js":50,"../../components/precacheManager.js":59,"../../patches/PatchIOSLoadAfterLoad.js":125,"../../patches/PublisherPatchEasybrain.js":128,"./../../components/MultipleInventories.js":29,"./../../components/sdkPluginType/SDKPluginTypeHandler.js":62,"./../RewardedVideo/availabilityManager.js":102,"./../RewardedVideo/availabilityReporter.js":103,"./../RewardedVideo/dsTaskManager.js":104,"./DemandEntityBuilder.js":77,"./FetchDemand/FetchDirect.js":80,"./FetchDemand/FetcherPatch.js":81,"./PayloadBuilder.js":82,"./PreloadAdManager":84}],86:[function(e,n,t){n.exports=function(e,n){var t,i=(e=e||{}).retriesLogic||{},r=e.Features||{},a=e.ProductName;return{initiated:!1,overrideFeedSettings:r,productType:a,errors:{init:{missingData:"Failed to get required parameters",multi:"Multiple Init calls not allowed",1001:"Trying to call API while during an un-finished process",1002:"1002",1003:"1003",1004:"Invalid API response",1005:"1005",deviceOsIsNotSupported:"Device OS is not Supported"},load:{noMoreOffers:"Failed to load "+a+" ad",duringLoad:"Load "+a+" is already in progress",duringShow:"Can not Load "+a+" when showing ad",timeout:"API request timeout",invalid:"Invalid API response",instanceExhausted:"Instance already exhausted",inStateVisibleOrInShowingProcess:"in state visible or inShowingProcess",inLoadingStateOrWaitingToLoad:"in state waitingToLoad or internalLoadingProcess",instanceOnHold:"Instance on Hold"},show:{isConnected:"no internet connection",duringEngage:"already engaged with an offer",notLoaded:"ad was not loaded, try to load before calling to show",duringLoad:a+" load is in progress",visible:a+" is already showing",instanceExhausted:"Can not show - Instance already exhausted"},vast:{noOffers:"empty"},general:{dsNotSet:"trying to call demandSource function, but demandSource object is not set",dsNameNotValid:"demand source name is not valid"}},displayMode:{nonprecache:"nonprecache",precache:"precache",softprecache:"softprecache"},libsCacheFiles:{dapi:"dapi",externalObfuscation:"externalObfuscation"},responseTypesWithReason:{none:0,ready:1,notReady:2},precacheConfig:{maxCachedCampaigns:10,nonPrecacheFallback:3e5,cacheBase:null,precachePath:null},timeUnit:6e4,timerLengths:{initAttemptsDelay:i.initAttemptsDelay||500,serverResponseTimeoutInMilis:i.serverResponseTimeoutInMilis,riDelay:12e4,loadAdTimeout:16e3},customDialog:4,filterDisableTypes:[],maxNumOfAttemptsToCallAPI:i.maxNumOfAttemptsToCallAPI||2,eventicsCategories:n,isExhaustInstanceAllowed:(t=r,void 0===t.isExhaustInstanceAllowed||t.isExhaustInstanceAllowed)}}},{}],87:[function(t,e,n){e.exports=function(e){var n={prod:t("./EnvironmentProduction"),staging:t("./EnvironmentStaging")};return n[e.environment]?new n[e.environment](e,t("./constants")):new n.staging(e,t("./constants"))}},{"./EnvironmentProduction":88,"./EnvironmentStaging":89,"./constants":90}],88:[function(e,n,t){n.exports=function(e,n){var t,i,r=n.fileExtension,a=n.controllerFolder,o=n.cacheRootFolder,s=n.jQueryFileName,c=e.controllerVersion,l=e.schema,d=e.cdnDomain,u=e.scdnDomain,f=e.environment,g=o[e.deviceOs],p=e.cdnService,v=e.domain;function m(){return l+"//"+d+"/mobileSDKController"}function b(){return g}return{getControllerHost:m,getControllerJsUrl:function(){return m()+"/versions/"+c+"/sdk_controller"+r+".js"},getJQueryUrls:function(){return[l+"//code.jquery.com/"+s,l+"//"+d+"/libs/"+s]},getConfig:function(){return{controllerVersion:c,schema:l,cdnDomain:d,environment:f,cacheRootFolder:g,serviceCdn:p,domain:v}},getCacheControllerJsUrl:function(){return b()+"/"+a+c+"/sdk_controller"+r+".js"},getCacheJQueryPath:function(){return b()+"/assets/"+s},getAppConfigDomain:function(){return l+"//"+p},getMicroJobUrl:function(){return l+"//"+d+"/users/microjob/sdkconfig.json"},getUrlToCdnAdUnit:function(){return t.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+u},setController:function(e){t=e},getStaticGlobalsUrl:function(e){return l+"//"+u+"/adunit/dist/versions/"+e+"/prod/"},getAssetsJsonUrl:function(){return l+"//"+u+"/adunit/dist/adunitAssets.json"},getAppConfigUrl:function(){return l+"//"+p+"/delivery/mobile/adUnit/getAppConfig.php"},setBaseServerUrlForOfferwall:function(e){i=e},getBaseServerUrlForOfferwall:function(){return i?l+"//"+i:""},getCacheRootFolder:b,getExternalLibrariesUrl:function(){return m()+"/libs/"},getCacheLibsPath:function(){return b()+"/libs/"}}}},{}],89:[function(e,n,t){n.exports=function(e,n){n.fileExtension;var t=n.controllerFolder,i=n.cacheRootFolder,r=n.jQueryFileName,a=e.controllerVersion,o=e.schema,s=e.cdnDomain,c=(e.scdnDomain,e.environment),l=e.stagingCdnDomain,d=i[e.deviceOs],u=e.cdnService,f=e.domain;function g(){var e=l.split(".")[0];return o+"//"+l+"/users/staging/"+e}function p(){return d}return{getControllerHost:g,getControllerJsUrl:function(){return g()+"/controller/"+a+"/sdk_controller.js"},getJQueryUrls:function(){return[o+"//code.jquery.com/"+r,o+"//"+s+"/libs/"+r]},getConfig:function(){return{controllerVersion:a,schema:o,cdnDomain:s,environment:c,cacheRootFolder:d,stagingCdnDomain:l,domain:f}},getCacheControllerJsUrl:function(){return e=a,p()+"/"+t+e+"/sdk_controller.js";var e},getCacheJQueryPath:function(){return p()+"/assets/"+r},getAppConfigDomain:function(){return o+"//"+u},getMicroJobUrl:function(){return o+"//"+s+"/users/microjob/sdkconfig_staging.json"},getUrlToCdnAdUnit:function(){var e=l.split(".")[0];return o+"//"+l+"/users/staging/"+e},setController:function(e){},getStaticGlobalsUrl:function(e){var n=l.split(".")[0];return o+"//"+l+"/users/staging/"+n+"/adunit/dist/versions/"+e+"/stage/"},getAssetsJsonUrl:function(){var e=l.split(".")[0];return o+"//"+l+"/users/staging/"+e+"/adunit/dist/adunitAssets.json"},getAppConfigUrl:function(){return o+"//"+u+"/delivery/mobile/adUnit/getAppConfig.php"},setBaseServerUrlForOfferwall:function(e){},getBaseServerUrlForOfferwall:function(){return""},getCacheRootFolder:p,getExternalLibrariesUrl:function(){return g()+"/common/libs/"},getCacheLibsPath:function(){return p()+"/libs/"}}}},{}],90:[function(e,n,t){n.exports={fileExtension:".min.gz",controllerFolder:"controller_",cacheRootFolder:{ios:"../SSAPublisher",android:"../supersonicads"},jQueryFileName:"jquery-1.9.1.min.js"}},{}],91:[function(An,e,n){function t(c,l){"use strict";var t=An("../components/Constants.js"),d=An("./DemandSource/EventCategories.js")(t.IS),r,i=!1,a,e=l.MRAID,u=l.adUnitUrl,f,g="Interstitial",n="NativeCallback",o="TaskManager",s="PrecacheManager",p={videoIS:"videoInterstitial",imageIS:"imageInterstitial"},v=2,m={productType:g,maxCachedCampaigns:10,cacheBase:null,precachePath:null,nonPrecacheFallback:5*t.timeunit},b={productType:g},h={init:{missingData:"Failed to get required parameters",multi:"Multiple Init calls not allowed",invalid:"Invalid API response",timeout:"API request timeout"},load:{isConnected:"no internet connection",duringEngage:"already engaged with an offer",adState:{0:"not initiated yet",1:"not ready yet",5:"error loading ad"}},show:{isConnected:"no internet connection",duringEngage:"already engaged with an offer",available:"ad not available"}},S={1e3:"Ad not available",1001:"Not initiated yet",1002:"Multiple Init calls not allowed",1003:"Failed to get required parameters or they are invalid",1004:"Invalid API response",1005:"API request timeout",1006:"Already engaged with an offer",1007:"Not ready yet",1008:"Not ready",1009:"No internet connection",1010:"Failed to pre-load creative assets",1011:"Failed to load interstitial ad",1012:"Already engaged with another offer",1013:"Failed to init interstitial",1014:"Failed to load interstitial ad",1015:"Failed to show interstitial ad",1020:"Ad state error",1021:"Trying to call API while during an un-finished process",1022:"Failed on get inventory",1023:"No offers on prepare ad unit assets",1024:"Failed updating ad unit assets",1025:"No more offers",1026:"Cannot load at this time"},y={initISSuccess:null,initISFailure:null,loadISSuccess:null,loadISFailure:null,showISSuccess:null,showISFailure:null},C={none:0,ready:1,noOffers:2,noOffersRI:3},A={initial:0,notready:1,initiated:2,pending:3,loaded:4,error:5,opened:6},D=null,I=6e4,w={initAttemptsDelay:1e4,apiResponseTimeout:1e4,loader:5e3,riDelay:2*I,loadedState:30*I,p:5e3,np:12e3,buffer:2*I},P={},L="",T={},O={},F=!1,U=!1,x=!0,N=[],M=0,k=0,B="about:blank",E=A.initial,V=C.none,R,K=null,j=null,W=!1,G=!1,H,q=null,J=null,Q=null,_=null,z=null,X={seatbid:{}},$,Y,Z=1,ee=l.Cache,ne=l.adUnitGlobals,te=An("../components/CampaignsFilter.js")(c,l).factory(g),ie=(re=!1,ae=!1,oe=!1,se=!1,ce=!1,le=!0,{init:function(){re||(c.PubSub.subscribe(o+".Engaged",function(e){c.Utils.isDefined(e.duringEngage)&&(c.Utils.isDefined(e.productType)&&e.productType!==g?oe=e.duringEngage:ae=e.duringEngage),l.log("line[191]: IS engaged "+ae+", other engaged: "+oe,l.LogLevels.verbose)}),c.PubSub.subscribe(o+".CacheUpdateStatus",function(e){c.Utils.isDefined(e.duringCacheUpdate)&&c.Utils.isDefined(e.productType)&&e.productType===g&&(se=e.duringCacheUpdate)}),c.PubSub.subscribe(o+".AdStatusChange",function(e){c.Utils.isDefined(e.state)&&c.Utils.isDefined(e.productType)&&e.productType===g&&(l.log("Ad state changed from "+E+" to "+e.state,l.LogLevels.verbose),E=e.state)}),c.PubSub.subscribe(n+".enterBackground",function(){ce=!0}),c.PubSub.subscribe(n+".enterForeground",function(){ce=!1}),c.PubSub.subscribe(n+".viewableChange",function(e){}),c.PubSub.subscribe(n+".deviceStatusChanged",function(e){c.Utils.isDefined(e.connectionType)&&(le="none"!==e.connectionType&&"notReachable"!==e.connectionType)}),re=!0)},canLoad:function(){return(E===A.error||E===A.initiated)&&!ae&&le},canEngage:function(){return!ae&&!l.getCurrentDisplayedAd()&&le},canForceEngage:function(){return!ae&&!l.getCurrentDisplayedAd()&&le},canInitCallToApi:function(){return W?!se&&le:!(ae&&l.getCurrentDisplayedAdType()===g)&&!ce&&!se&&le},setConnection:function(e){le=e},getStatusMsg:function(){return"duringEngage:"+ae+" duringCacheUpdate:"+se+" appInBackground:"+ce+" isConnected:"+le+" ad state:"+E},getStatus:function(){return{duringEngage:ae,duringCacheUpdate:se,appInBackground:ce,isConnected:le,adState:E}},publish:function(e,n){return c.PubSub.publish(o+"."+e,n)},subscribe:function(e,n){return c.PubSub.subscribe(o+"."+e,n)},unsubscribe:function(e){return c.PubSub.unsubscribe(e)}}),re,ae,oe,se,ce,le,de=function(e){l.log("on creative opened",3),Y.trackTimingStart(d.adVisibleToClose),Y.trackEvent(d.adVisible),ie.publish("AdStatusChange",[{state:A.opened,productType:g}]),U=!0,Ge(e),He(e)},ue=function(){var e=We();return e&&(l.log("pre load on get config is: "+O.preload,3),e.settings=e.settings||{},e.settings.preload=O.preload),e},fe=function(e){var n,t=l.getApiData({scdn:1,protocol:0,defaultProtocol:1}),i=l.decideUrlProtocolAccordingToHTTPSCompliance(),r=t.scdn;return n="prod"!==l.getEnv()?l.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env:i+"//"+r,a.extend(!0,e,{settings:{protocol:i,urltocdn:n,precache:f.isPrecache()}})};function ge(e,n,t){var i=on();return y.initISSuccess=n,y.initISFailure=t,l.initEventics(b),Y.trackEvent(d.initAd),i.allowed?E===A.pending||E===A.loaded?(en(),void c.PubSub.publish(g+".CacheReady",[{productType:g,numOfAdUnits:N.length}])):(V=C.none,l.log("IS - resetting last response to none",l.LogLevels.verbose),void r.initInterstitial(e).then(en,Ye)):(Ze(),void Ye(i.errMsg))}function pe(e,n,t){y.loadISSuccess=n,y.loadISFailure=t,r.loadInterstitial(e).then(tn,nn)}function ve(e,n,t){be(e,n,t)}var me=function(){c.PubSub.subscribe(s+".cacheUpdatedCallback",function(e){if(!e||e.productType===g){l.log("IS |  cacheUpdatedCallback "+JSON.stringify(e),l.LogLevels.verbose);var n=N.length,t=f.getCacheSizeByType(g),i=O.numOfBannersToInitSuccess<=n?O.numOfBannersToInitSuccess:n,r=f.areCampaignsAvailable(N,i);0===t?Ue("Cache updated with zero campaigns"):F&&r&&Ne()}}),c.PubSub.subscribe(s+".campaignSavedCallback",function(e){if(!e||e.productType===g){l.log("IS campaignSavedCallback "+JSON.stringify(e),l.LogLevels.verbose);var n,t=-1,i={};c.Utils.isDefined(e.id)&&(n=je(e.id),t=c.Utils.isDefined(n.inventoryIndex)?n.inventoryIndex:-1,i=l.AdUtils.updateEventWithAdParams(O,n,{})),a.extend(i,{eNameStart:{name:d.campaignSavedCache.name+""},inventoryIndex:t}),Y.trackTimingStop(d.campaignSavedCache,i)}}),c.PubSub.subscribe(s+".campaignDownloadStartedCallback",function(e){if(!e||e.productType===g){var n=a.extend({},d.campaignSavedCache);n.name=n.name+(e.id||""),Y.trackTimingStart(n)}}),c.PubSub.subscribe(s+".campaignDeletedCallback",function(e){if(!e||e.productType===g){var n={};if(c.Utils.isDefined(e.id)){var t=je(e.id);n=l.AdUtils.updateEventWithAdParams(O,t,{})}l.log("IS campaignDeletedCallback "+JSON.stringify(e),l.LogLevels.verbose),Y.trackEvent(d.campaignDeletedCache,n)}}),c.PubSub.subscribe(s+".cacheAdsSuccessCallback",function(e){e&&e.productType!==g||l.log("IS cacheAdsSuccessCallback "+JSON.stringify(e),l.LogLevels.verbose)}),c.PubSub.subscribe(s+".cacheAdsFailedCallback",function(e){if(!e||e.productType===g){l.log("IS cacheAdsFailedCallback "+JSON.stringify(e),l.LogLevels.verbose);for(var n=e.deletedOffers.length,t=e.deletedOffers,i=0;i<n;i++){var r=je(t[i]),a=l.AdUtils.updateEventWithAdParams(O,r,{});Y.trackEvent(d.campaignFailedToCache,a),He(t[i])}var o=N.length,s=O.numOfBannersToInitSuccess<=o?O.numOfBannersToInitSuccess:o,c=f.areCampaignsAvailable(N,s);F&&c?Ne():Ue(e.errorLog)}}),c.PubSub.subscribe("SDKController.AdVideoEnded",function(e){e.productType===g&&l.log("Got AdVideoEnded in IS",l.LogLevels.info)}),c.PubSub.subscribe("SDKController.engageEnd",function(e,n){e.productType===g&&(Xe(),c.Utils.isFunction(n)&&n.call())}),c.PubSub.subscribe(g+".GetConfig",function(e){if(e.productType===g){var n=ue();n&&fe(n),e.callback&&e.callback.call(null,n),clearTimeout(H),E!==A.error&&c.Utils.isDefined(e.errMsg)&&Qe(e)}}),c.PubSub.subscribe("SDKController.AdLoaded",function(e){e.productType===g&&E!==A.error&&E!==A.loaded?Je(e):l.log("Controller | IS | try to load when error or already loaded. adState: "+E,l.LogLevels.info)}),c.PubSub.subscribe("SDKController.AdError",function(e){e.productType===g&&(clearTimeout(H),c.Utils.isDefined(e.errMsg)&&Qe(e))}),c.PubSub.subscribe("SDKController.AdPlaying",function(e){}),c.PubSub.subscribe("SDKController.AdPaused",function(e){}),c.PubSub.subscribe("SDKController.AdStarted",function(e){e.productType===g&&l.log("Got AdStarted in IS",l.LogLevels.info)}),c.PubSub.subscribe("SDKController.AdClicked",function(e){e.productType===g&&l.callSDKFunction("adClicked",{productType:g})}),c.PubSub.subscribe("SDKController.AdVisible",function(e){he(e)}),c.PubSub.subscribe("SDKController.onAdWindowsClosed",function(e){e.productType!==g&&E===A.error&&qe()}),ie.subscribe("AdStatusChange",function(e){e.productType===g&&$e(e)}),c.PubSub.subscribe("SDKController.Analytics",function(e){if(e.productType===g&&e&&e.action){var n=e.action,t=e.eventParam;"fireEvent"===n?Y.trackEvent(t.eName,t.label,t.data):"startTiming"===n?Y.trackTimingStart(t.eName,t.data):"stopTiming"===n?Y.trackTimingStop(t.eName,t.data):"setCustomData"===n&&Y.updateBaseData(t.data)}}),c.PubSub.subscribe(n+".initInterstitial",function(e,n,t){}),c.PubSub.subscribe(n+".loadInterstitial",function(e,n,t){}),c.PubSub.subscribe(n+".showInterstitial",function(e,n,t){}),c.PubSub.subscribe(n+".forceShowInterstitial",function(e,n,t){be(e,n,t)}),c.PubSub.subscribe(g+".ActionClick",function(e){l.OpenURLService.open(e)||l.log(g+" failed to perform ActionClick",l.LogLevels.info)})};function be(e,n,t){y.showISSuccess=n,y.showISFailure=t,r.showInterstitial(e).then(an,rn)}var he=function(e){e.productType!==g?(ie.publish("Engaged",[{duringEngage:!0,productType:e.productType}]),E!==A.pending&&E!==A.loaded||l.log("line[456]: IS on engage with another offer",l.LogLevels.verbose)):(E===A.loaded&&(e?(l.log("creative open from ad visible",l.LogLevels.verbose),de(e.crid)):l.log("opened with no current ad",l.LogLevels.error)),Z++)},Se=function(e){var n="Cannot load Interstitial ad: ";return e.isConnected||(n+=h.load.isConnected),e.duringEngage?n+=h.load.duringEngage:c.Utils.isDefined(h.load.adState[e.adState])&&(n+=h.load.adState[e.adState]),n},ye=function(e){var n="Cannot engage interstitial ad: ";return D||(n+=h.show.available),e.isConnected||(n+=h.show.isConnected),e.duringEngage?n+=h.show.duringEngage:l.getCurrentDisplayedAd()&&(n+=S[1012]),n},Ce=function(){var e=ie.canInitCallToApi();return l.log("can init again?"+e+ie.getStatusMsg(),l.LogLevels.info),e?(Ue(),Ae(O.refreshInterval),l.log("Resetting last response to no offers RI",l.LogLevels.verbose),V=C.noOffersRI,r.initInterstitial()):j=setTimeout(function(){Ce()},w.riDelay),e},Ae=function(e){l.log("setting refresh interval to: "+e,l.LogLevels.info),K&&clearInterval(K),0!==e&&(K=setInterval(function(){Ce()||clearInterval(K)},e*I))},De=function(e){var n=e.ext||{};a.extend(n,l.getApplicationExternalConfig().getABTestConfiguration("Interstitial",n.landingId)),K&&clearInterval(K),c.Utils.isDefined(n.refreshinterval)&&0!==n.refreshinterval&&Ae(n.refreshinterval),n.numOfBannersToCache=1,n.numOfBannersToInitSuccess=1,O=n},Ie=function(e){return!J||"pending"!==J.state()&&"resolved"!==J.state()?J=f.decidePrecacheStatus(e).then(function(){return F=!1,0<e.numOfCampaigns?ne.updateAdUnitGlobals(f.isPrecache()):(N=[],c.Utils.returnRejectedPromise("We did not receive any campaigns in inventory",1023))}).then(f.handleCacheClear).then(function(){return F=!0,c.Utils.returnResolvedPromise()},function(e){return xe(),c.Utils.returnRejectedPromise(e,1024)}):J},we=function(e,n){var t,i=[];for(t=0;t<e.length;t++)f.isAdInCache(l.AdUtils.getAdId(n[t]))||i.push(n[t]);return i},Pe=function(e){var n={};return n.id=l.AdUtils.getAdId(e),n.bannerID=l.AdUtils.getBannerId(e),n.creativeId=l.AdUtils.getCreativeId(e),n.title="",n.staticContent=c.AdAssets.extractStaticFiles(e),n.lastUpdateTime=c.Utils.isDefined(e.lastUpdateTime)?e.lastUpdateTime:0,n},Le=function(e){var n=[];return a.each(e,function(){n.push(Pe(this))}),n},Te=function(e){a.each(e,function(e,n){n.inventoryIndex=e,f.isPrecache()&&f.setAdInventoryIndex(l.AdUtils.getAdId(n),e)})},Oe=function(e){var t=[];return a.each(e,function(e,n){n.ext&&n.ext.appData&&n.ext.appData.adAssets&&(n.ext.appData.appImages=n.ext.appData.adAssets,delete n.ext.appData.adAssets),t.push(n)}),t},Fe=function(t){var i,e,r=f.isPrecache(),a=t.length;t=Oe(t),Te(t),i=Le(t);var n=function(){if(0!==a)if(N=t.slice(0),r){if(f.areCampaignsAvailable(i,O.numOfBannersToInitSuccess))return Y.trackEvent(d.campaignsAvailableFromCache),void Ne();var e=we(t,i),n={cacheTimeoutSuccessCallback:function(){Fe(t)},cacheTimeoutFailCallback:Ue,applicationUserId:T.applicationUserId,applicationKey:T.applicationKey,newAdsToEnterCache:e};f.handleCacheAds(n)}else Ne();else Ue()};r&&(e=f.mergeCampaigns(i),l.log("IS | updateCurrentAds after merge "+JSON.stringify(e),l.LogLevels.verbose)),!r||O.purgeCacheOnInit?(l.log("already purged cache so go strait to adding the new ads",l.LogLevels.verbose),n()):f.clearCacheByType(e).always(n)},Ue=function(){ie.publish("AdStatusChange",[{state:A.notready,productType:g}]),_&&_.reject("load Intertitial failed",1025),Me(!1)};function xe(){E!==A.initial&&ie.publish("AdStatusChange",[{state:A.error,productType:g}]),Me(!1)}var Ne=function(){(V===C.none||V===C.noOffers||V===C.noOffersRI||W)&&(ie.publish("AdStatusChange",[{state:A.initiated,productType:g}]),W||(c.PubSub.publish(g+".CacheReady",[{productType:g,numOfAdUnits:N.length}]),V=C.ready),G?r.loadInterstitial():pn())},Me=function(e){"boolean"==typeof e?D!==e&&(D=e,l.log("available: "+e,l.LogLevels.verbose),l.callSDKFunction("interstitialAvailability",{available:e})):l.log("IS available param is not a boolean",l.LogLevels.error)},ke=function(e){var n=null;return c.Utils.isDefined(e)&&(c.Utils.isDefined(e.applicationUserId)&&""!==e.applicationUserId?n=e.applicationUserId:c.Utils.isDefined(e["deviceIds[IFA]"])&&""!==e["deviceIds[IFA]"]?n=e["deviceIds[IFA]"]:c.Utils.isDefined(e["deviceIds[IDFV]"])&&""!==e["deviceIds[IDFV]"]?n=e["deviceIds[IDFV]"]:c.Utils.isDefined(e["deviceIds[AID]"])&&""!==e["deviceIds[AID]"]&&(n=e["deviceIds[AID]"])),n};function Be(){if(ie.canInitCallToApi())return c.Utils.returnResolvedPromise();var e="trying to call API while during an un-finished process";return l.log(e+ie.getStatusMsg(),l.LogLevels.error),c.Utils.returnRejectedPromise(e,1021)}function Ee(e){var n=new a.Deferred;return(T=e).impressionsCount=Z-1,l.shouldExtendApiDataWithDebugData()?l.extendApiDataWithDebugParams(T).then(function(e){n.resolve(e)}):n.resolve(T),n.promise()}function Ve(e,n){J=null,(q=e.seatbid.bid||e.seatbid[0]&&e.seatbid[0].bid)&&1<q.length&&(q=[q[0]]);var t=e.seatbid.ext||e.seatbid[0]&&e.seatbid[0].ext;if(Y.updateBaseData({landingId:t.landingId,strategyId:t.strategyId}),G){var i=Ie({numOfCampaigns:q.length,settings:O});return i.then(Fe.bind(null,q)),i}return c.Utils.returnResolvedPromise()}var Re=function(){var t=new a.Deferred;return k++,c.Utils.decodeValues(T),$.getInventory(T).then(function(e){t.resolve(e)},function(e){var n;e&&(n=e.errorMessage),n&&-1!==n.indexOf("timeout")&&k<3?setTimeout(function(){Re().then(function(e){t.resolve(e)},t.reject)},w.initAttemptsDelay):t.reject(n,1022)}).always(function(){ie.setConnection(!0)}),t.promise()},Ke=function(){k=0;var t=ke(T);return Re().then(function(e){De(e.seatbid.ext?e.seatbid:e.seatbid[0]);var n=e.seatbid.bid||e.seatbid[0].bid;return n&&1<n.length&&(n=[n[0]]),te.filterByAppInstalled(n,O).then(function(){return c.Utils.returnResolvedPromise(e,t)})}).then(Ve)},je=function(e){var n,t=null,i=N.length;for(n=0;n<i;n++)if(l.AdUtils.getAdId(N[n])==e){t=N[n];break}return t||l.log("Error in getCreativeById, id "+e+" not found in "+JSON.stringify(N),1),t},We=function(){return N&&0<N.length?a.extend(!0,N[M],l.getFormattedDeviceData()):null},Ge=function(){return!0},He=function(e){var n,t=N.length;if(l.log("removing current creative",l.LogLevels.verbose),O.preload)for(n=0;n<t;n++)if(l.AdUtils.getAdId(N[n])==e){N.splice(n,1);break}qe()},qe=function(){l.log("self initiating call to API",l.LogLevels.verbose),Me(!1),r.initInterstitial(R,!0).then(null,function(e){return xe(),c.Utils.returnRejectedPromise(e)})},Je=function(e){clearTimeout(H),c.Utils.isDefined(e.errMsg)?Qe(e):(ie.publish("AdStatusChange",[{state:A.loaded,productType:g}]),l.onAdLoaded(We()),c.Utils.isDefined(e.enableBackButton)&&l.setBackButtonState(e.enableBackButton))},Qe=function(e){var n="Ad loaded with error: "+e.errMsg;Y.trackEvent(d.adLoadedError,{generalMessage:e.errMsg}),ze(e,n)},_e=function(e){ze(e,"Timeout in loading ad")};function ze(e,n){var t=e.crid;ie.publish("AdStatusChange",[{state:A.error,errMsg:n,productType:g}]),l.log(n,l.LogLevels.error),Ge(t),He(t),e.productType=g,l.removeAdUnit(e)}var Xe=function(){ie.publish("Engaged",[{duringEngage:!1,productType:g}]),Y.unsetParamFromBaseData("landingId"),G&&r.loadInterstitial()},$e=function(e){e&&e.state&&(e.state===A.error?(clearTimeout(H),h.load.adState[A.error]=e.errMsg,_&&_.reject(e.errMsg,1020),Me(!1)):e.state===A.loaded&&_&&_.resolve())};function Ye(e){e=e||S[1013],Y.trackEvent(d.initAdFail,{callFailReason:e}),l.callSDKFunction(y.initISFailure,{errMsg:e})}function Ze(){!l.isLegacy(l.featureMap.loadIS)&&l.isSupportedOsVersion(g)||(E=E.error)}function en(){x=!1,l.callSDKFunction(y.initISSuccess)}function nn(e){e=e||S[1014],l.callSDKFunction(y.loadISFailure,{errMsg:e})}function tn(){l.callSDKFunction(y.loadISSuccess)}function rn(e){e=e||S[1015],Y.trackEvent(d.showAdFail,{callFailReason:e}),l.callSDKFunction(y.showISFailure,{errMsg:e})}function an(){l.callSDKFunction(y.showISSuccess),Y.trackEvent(d.showAdSuccess)}function on(){var e={allowed:!0};return l.isLegacy(l.featureMap.loadIS)?(e.allowed=!1,e.errMsg="SDK version "+l.getApiData({SDKVersion:1}).SDKVersion+" is not supported"):l.isSupportedOsVersion(g)?x?l.isLimitedDeviceModel()&&(e.errMsg="Device is not supported",e.allowed=!1):(e.allowed=!1,e.errMsg=h.init.multi):(e.allowed=!1,e.errMsg="Operating system version "+l.getApiData({deviceOSVersion:1}).deviceOSVersion+" is not supported"),e}function sn(){return j&&(clearTimeout(j),j=null),c.Utils.returnResolvedPromise()}function cn(){return Be().then(l.getAPIRequiredData).then(Ee).then(Ke).then(function(){q&&0<q.length?ie.publish("AdStatusChange",[{state:A.initiated,productType:g}]):Ue()})}function ln(e,n){if(Q&&"pending"===Q.state())return Q;W=n;var t=l.getApplicationInfo(b,e).then(sn);return Q=t,(G||n)&&(Q=t.then(cn)),Q}function dn(e){var n=l.getApiData({deviceOs:1}).deviceOs;O.standaloneView=e.type===p.imageIS&&e.templateid==v&&n===t.deviceOs.ios,O.translucentView=e.type===p.imageIS&&e.templateid==v&&n===t.deviceOs.android}function un(){return E===A.initial&&!G&&Q&&"resolved"===Q.state()?cn():E===A.error?c.Utils.returnRejectedPromise(null,1020):c.Utils.returnResolvedPromise()}function fn(){return Y.trackEvent(d.loadIS),Y.trackTimingStart(d.loadAdToAdReady),Y.trackTimingStart(d.loadAdToShowAd),un().then(r.load).then(Me.bind(null,!0)).then(function(){Y.trackTimingStop(d.loadAdSuccess,{eNameStart:d.loadAdToAdReady})},function(e,n){n=n||"1014",Y.trackTimingStop(d.loadAdFailed,{eNameStart:d.loadAdToAdReady,callFailReason:S[n]}),c.Utils.returnRejectedPromise(e)}).always(function(){_=null})}function gn(){var e,n;return _&&"pending"===_.state()?_.promise():(_||(_=new a.Deferred),E===A.loaded||D?_.resolve():ie.canLoad()?(Q&&"rejected"===Q.state()&&qe(),a.when(Q).then(function(){return te.filterByAppInstalled(q,O).then(function(){return 0<q.length?c.Utils.returnResolvedPromise(q):(Ue(),c.Utils.returnRejectedPromise(Se(ie.getStatus()),1025))})}).then(function(){a.extend(O,{preload:!0}),ie.publish("AdStatusChange",[{state:A.pending,productType:g}])}).then(function(){return G?(pn(),c.Utils.returnResolvedPromise(q)):Ie({numOfCampaigns:q.length,settings:O}).then(function(){return Fe(q),c.Utils.returnResolvedPromise(q)})}.bind(null,q)).then(null,_.reject)):(n=ie.getStatus(),e=Se(n),l.log(e,l.LogLevels.error),G&&((E!==A.initial||Q&&"pending"===Q.state())&&E!==A.notready||(Y.trackEvent(d.initBeforeLoad),qe())),_.reject(e,1026)),_.promise())}function pn(){var e,n,t=f.isPrecache();if(e=We()){var i=je(l.AdUtils.getAdId(e)),r=l.AdUtils.updateEventWithAdParams(O,i,{});if(Y.updateBaseData(r),t){var a=l.AdUtils.getAdId(e),o=m.precachePath+a+"/";e=c.AdAssets.updateAdunitPrecachePath(e,o)}B=u.getAdunitUrl(t,b),dn(e.ext);var s=w.np;clearTimeout(H),H=setTimeout(function(){_e(e)},s),l.loadAdUnitUrl(e,B,b,O)}else n="No available creative in load attempt",l.log(n,l.LogLevels.error),ie.publish("AdStatusChange",[{state:A.notready,productType:g}]),_.reject(n)}function vn(){return r.show().always(function(){z=null})}function mn(){var e;if(z&&"pending"===z.state())return z.promise();if(z||(z=new a.Deferred),l.log(ie.getStatusMsg(),l.LogLevels.verbose),!ie.canEngage())return e=ye(ie.getStatus()),z.reject(e),z.promise();Y.trackTimingStop(d.showAd,{eNameStart:d.loadAdToShowAd});var n=We();ie.publish("Engaged",[{duringEngage:!0,productType:g}]);return l.loadAdUnitUrl(n,B,b,{preload:!1}),l.displayAdUnitFrame(n),z.resolve(),z.promise()}var bn=function(){var e=l.getProtocol();P={dev:e+t.gatewayDestinationMap.IS.production,stage:e+t.gatewayDestinationMap.IS.production,prod:e+t.gatewayDestinationMap.IS.production}},hn=function(e){return P[e]||P.prod};function Sn(){m.cacheBase=b.productType,m.precachePath="../"+m.cacheBase+"/",a.extend(m,b)}function yn(){return m}var Cn={init:function(){r=this,a=l.jQuery(),bn();var e=hn(l.getEnv());if(f=new(An("../components/precacheManager.js"))(c,l,yn()),$=new(An("../components/FetcherService.js"))(e,X,w.apiResponseTimeout),!i){N=[];var n={productChance:(l.getEnv(),1),baseData:{productType:g}};Y=c.Eventics.createEventic(n),Sn(),ie.init(),me(),f.init(),L=ne.getStaticGlobalsUrl(),G=l.isLegacy(l.featureMap.selfLoadingIS),i=!0}},getCurrentAd:function(){return a.extend(We(),{type:g})},isNextAvailable:function(){return!1},initInterstitial:ln,loadInterstitial:fn,showInterstitial:vn,load:gn,show:mn,initProduct:ge,loadProduct:pe,showProduct:ve,className:g};return Cn}e.exports=t},{"../components/CampaignsFilter.js":8,"../components/Constants.js":9,"../components/FetcherService.js":14,"../components/precacheManager.js":59,"./DemandSource/EventCategories.js":78}],92:[function(e,n,t){n.exports=function(e,n,t){var i=n.shouldFetchNewFeedOnAdCloseFlag(t.IS);return i=void 0===i||i,{NativeAPI:e.NativeAPI,ControllerCallbacks:e.ControllerCallbacks,AdUnitCallbacks:e.AdUnitCallbacks,ControllerNativeAPI:e.NativeAPI,retriesLogic:e.retriesLogic,DemandName:"InterstitialDS",ProductName:t.IS,Features:{allowMultiInitCalls:!0,reportOnAdunitReady:!0,shouldFetchNewFeedOnAdClose:i,isSupportFetchFeedOnAdCloseLogic:!0,preFetchAllVasts:!0,allowConsecutiveGatewayRequestsDuringLoad:!0,isExhaustInstanceAllowed:!0},gatewayDestinationMap:{prod:t.gatewayDestinationMap.IS.production},amountOfInventories:1}}},{}],93:[function(a,e,n){e.exports=function(t,i){var r=a("../components/Constants.js");return{create:function(){if(i.isLegacy(i.featureMap.MDS[r.RV]))return new(a("./Interstitial.js"))(t,i);var e=a("./AdapterSharedConfig.js"),n=a("./InterstitialDemandSource/AdConfiguration.js")(e,i.SupplyUtils,r);return new(a("./ProductAdapter.js"))(t,i,n,r)}}}},{"../components/Constants.js":9,"./AdapterSharedConfig.js":73,"./Interstitial.js":91,"./InterstitialDemandSource/AdConfiguration.js":92,"./ProductAdapter.js":95}],94:[function(Bn,e,n){function t(c,s){"use strict";var i=Bn("../components/Constants.js"),r,t=!1,n=10,a=6e4,l="https://guc-api.sonic-us.supersonicads.com/api/v1/guc.php?format=json",o="https://guc-api.sonic-us.supersonicads.com/api/v1/myOffers",d="openRTB",u=i.OW,f="TaskManager",g=i.CB,p=window.jQuery,e,v={},m,b={},h={},S={productType:u},y=i.confirmCloseMsgMap,C={missingData:"Failed to get required parameters",invalid:"Invalid API response",appInfo:"Failed to retrieve application info",timeout:"API request timeout",server:"Server error",engaged:"Already engaged with OfferWall product",adunitAssetsTimeout:"Timeout in loading ad unit static assets",closeBeforeVisible:"User closed before ad loaded",missingDeviceIds:"Missing deviceIds",preconditions:"Failed to initiated OW, preconditions did not pass"},A={adunit:"adunit",inventory:"inventory",inventoryInBackground:"inventoryInBackground",preConditions:"preConditions",close:"close"},D={v:1,controllerId:1,applicationKey:0,applicationUserId:0,debug:0,language:0,maxVideoLength:0,itemName:0,itemCount:0,timestamp:0,localTime:1,timezoneOffset:1,itemSignature:0,disableCache:0,showDeliveryLimitationsLog:0,disableSession:0,minimumOfferCommission:0,minimumOfferCommissionSignature:0,applicationUserGender:0,applicationUserAgeGroup:0,applicationUserCreationDate:0,applicationUserCreationDateSignature:0,demoCampaigns:0,appOrientation:1,mobileCarrier:0,connectionType:1,iphoneAppOnIpadDevice:0,deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceOEM:0,deviceVolume:0,immersiveMode:0,"deviceIds[OpenUDID]":0,"deviceIds[IFA]":0,"deviceIds[IDFV]":0,"deviceIds[SERIAL]":0,"deviceIds[AndroidID]":0,"deviceIds[IMEI]":0,"deviceIds[AID]":0,displaySizeWidth:0,displaySizeHeight:0,deviceWidthDP:0,deviceHeightDP:0,deviceScreenScale:0,deviceLanguage:0,deviceModel:0,diskFreeSize:1,country:0,pageSize:0,page:0,landingId:0,customParams:0,admin:0,useClientSideCallbacks:0,isLimitAdTrackingEnabled:0,SDKPluginType:0,bundleId:0,jb:0,gpi:0,allowArbitraryLoads:0,allowArbitraryLoadsInWebContent:0,mcc:0,mnc:0,appVersion:0,batteryLevel:0,androidIsVersion:0,cdnCn:0,sdkAbName:0,segmentId:0,segmentName:0,consent:0,moatSupported:0},I={settings:{},textData:{},offers:[]},w={SDKVersion:1},P={id:0,url:""},L={openAppStoreSheet:!0,preload:!1},T={osNotSupported:"Sorry, your operating system version is not supported.",dialogErrorMessage:"Sorry, we were unable to display the wall at the moment. Please try again later.",noOffers:"Sorry, we currently have no offers to display. Please try again later.",noInternet:"No internet connection. Please connect and try again."},O={showOWCalled:{name:"showOWCalled",id:16},showOWFail:{name:"showOWFail",id:17},owVisible:{name:"owVisible",id:18},inventoryGetToReceived:{name:"inventoryGetToReceived",id:-12},initControllerToShowOWCalled:{name:"initControllerToShowOWCalled",id:-13},showOWCalledToOwVisible:{name:"showOWCalledToOwVisible",id:-14},adVisibleToClose:{name:"adVisibleToClose",id:-5},initOW:{name:"initOW",id:13},initOWFail:{name:"initOWFail",id:14},initOWSuccess:{name:"initOWSuccess",id:127},staticAssetsLoaded:{name:"staticAssetsLoaded",id:126},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156}},F={initOWSuccess:null,initOWFailure:null},U=0,x,N={},M,k,B,E,V,R=!1,K=!1,j=null,W=null,G=s.adUnitGlobals,H="#/?productType="+u+"&mode=msdkctrl",q=null,J=null,Q=null,_=null,z=null,X=!1,$=null,Y,Z={adUnitAssetsTimeout:6e4,pollAPITimeout:1e4},ee={offers:[],settings:{},textData:{noOffers:T.noOffers},ext:{emptyOWReason:"default empty OW reason"}},ne={precache:!1,getInventoryOnInit:!1,refreshInterval:0},te=Bn("../components/CampaignsFilter.js")(c,s).factory(u),ie,re,ae,oe=(se=!1,ce=!1,le=!1,de=!0,ue=!1,{init:function(){se||(c.PubSub.subscribe(f+".Engaged",function(e){c.Utils.isDefined(e.duringEngage)&&(ce=e.duringEngage)}),c.PubSub.subscribe(g+".enterBackground",function(){le=!0}),c.PubSub.subscribe(g+".enterForeground",function(e){le=!1,!me()||e&&c.Utils.isDefined(e.active)&&!e.active||(s.log("poll on CPI offer closed/external browser offer closed (iOS flow)",s.LogLevels.verbose),K=!1,De())}),c.PubSub.subscribe(g+".viewableChange",function(e){e&&c.Utils.isDefined(e.isViewable)&&(!ue||!e.isViewable||c.Utils.isDefined(e.webview)&&"main"!==e.webview||(ue=!1,s.postAdUnitEvent(JSON.stringify({name:"OfferClosed"}))),me()&&e.isViewable&&c.Utils.isDefined(e.webview)&&"main"===e.webview&&(s.log("poll on CPI offer closed/external browser offer closed (Android flow)",s.LogLevels.verbose),K=!1,De()))}),c.PubSub.subscribe(g+".deviceStatusChanged",function(e){c.Utils.isDefined(e.connectionType)&&(de="none"!==e.connectionType&&"notReachable"!==e.connectionType)}),se=!0)},canEngage:function(){if(ce||!de)return!1;var e=s.getCurrentDisplayedAd();return!e||e.productType===i.BN},isConnected:function(){return de},setConnection:function(e){de=e},setAdOpened:function(e){ue=e},getStatusMsg:function(){return" duringEngage:"+ce+" appInBackground:"+le+" isConnected:"+de},getStatus:function(){return{duringEngage:ce,appInBackground:le,isConnected:de,isAdOpened:ue}},duringEngage:function(){return ce},publish:function(e,n){c.PubSub.publish(f+"."+e,n)},waitUntilAppInForeground:function(){var e=p.Deferred();return le?(s.log("Waiting for app to be in foreground",s.LogLevels.verbose),c.PubSub.subscribeOnce(g+".enterForeground",function(){e.resolve()})):e.resolve(),e.promise()},waitUntilConnected:function(){var n=p.Deferred();if(de)n.resolve();else{s.log("Waiting for internet connection",s.LogLevels.verbose);var t=c.PubSub.subscribe(g+".deviceStatusChanged",function(e){c.Utils.isDefined(e.connectionType)&&(de="none"!==e.connectionType&&"notReachable"!==e.connectionType)&&(c.PubSub.unsubscribe(t),n.resolve())})}return n.promise()}}),se,ce,le,de,ue,fe=function(){c.PubSub.subscribe(u+".ActionClick",function(e){s.OpenURLService.openForOW(e)||s.log(u+" failed to perform ActionClick",s.LogLevels.info)}),c.PubSub.subscribe("SDKController.AdClosed",function(e){if(e.productType===u){var n="ios"===s.getApiData({deviceOs:1}).deviceOs;oe.getStatus().isAdOpened&&n&&(s.postAdUnitEvent(JSON.stringify({name:"OfferClosed"})),oe.setAdOpened(!1),me()&&(s.log("poll on ad closed",s.LogLevels.verbose),De()))}}),c.PubSub.subscribe("SDKController.AdOpened",function(e){e.productType===u&&(oe.setAdOpened(!0),R&&Se(e.bannerId,!0))}),c.PubSub.subscribe("SDKController.engageEnd",function(e,n){e.productType===u&&(R&&(s.log("poll on engageEnd(OW closed)",s.LogLevels.verbose),De()),oe.publish("Engaged",[{duringEngage:!1,productType:u}]),ie.unsetParamFromBaseData("landingId"),c.Utils.isFunction(n)&&n.call(),X&&"pending"===J.state()&&Be("User closed before visible"),q&&q.always(function(){q=null;Ne(!0)}))}),c.PubSub.subscribe("SDKController.adLoaded",function(e){e.adType===u&&(s.log("received OW ad loaded event",s.LogLevels.verbose),s.onAdLoaded(P))}),c.PubSub.subscribe("SDKController.AdVisible",function(e){e.productType===u&&(s.log("line[324]: OW Ad Visible",s.LogLevels.verbose),ie.trackTimingStop(O.owVisible,{eNameStart:O.showOWCalledToOwVisible}),ie.trackTimingStart(O.adVisibleToClose))}),c.PubSub.subscribe("SDKController.Analytics",function(e){if(e.productType===u&&e&&e.action){var n=e.action,t=e.eventParam;"fireEvent"===n?ie.trackEvent(t.eName,t.label,t.data):"startTiming"===n?ie.trackTimingStart(t.eName,t.data):"stopTiming"===n?ie.trackTimingStop(t.eName,t.data):"setCustomData"===n?ie.updateBaseData(t.data):"unsetCustomData"===n&&(t&&t.data&&"bannerId"===t.data?ie.resetBaseData(i.baseDataKeys):ie.unsetParamFromBaseData(t.data))}}),c.PubSub.subscribe(g+".initOfferWall",function(e,n,t){s.log("OfferWall.js | CB.init called",s.LogLevels.verbose),s.getApplicationInfo(S).then(ve,function(e){s.callSDKFunction(t,{errMsg:e||C.appInfo})}).then(yn).then(function(){return s.callSDKFunction(n),c.Utils.returnResolvedPromise()},function(e){return s.callSDKFunction(t,{errMsg:e}),c.Utils.returnResolvedPromise()}).then(Fe).then(function(){R&&De()})}),c.PubSub.subscribe(g+".showOfferWall",function(e,n,t){e&&s.AppOrientationManager.updateAppOrientationByNewRestriction(e.orientationRestriction),r.showOfferWall().then(function(){s.callSDKFunction(n,{placementId:rn()})},function(e){s.callSDKFunction(t,{errMsg:e})}).always(function(){wn(In())&&(q=null)})}),c.PubSub.subscribe(g+".getUserCredits",function(e,n,t){if(s.checkRequiredCallbackParams(["applicationKey","applicationUserId","productType"],e,"getOfferWallCredits",t).didSucceed&&e.productType===u){if(c.Utils.decodeValues(e),On(e)&&oe.duringEngage()){var i="Could not provide credits, user provided is different from current user";return s.callSDKFunction(t,{errMsg:i}),void s.log(i,s.LogLevels.error)}Fe(!0,e).then(function(){De(e,t)},function(e){s.log(e,s.LogLevels.error),s.callSDKFunction(t,{errMsg:"Failed to initiate client side callbacks"})})}}),c.PubSub.subscribe("SDKController.OWOfferClicked",function(e){s.getCurrentDisplayedAdType()===u&&be(e)}),c.PubSub.subscribe("SDKController.videoOfferClosed",function(){s.RingerSwitchService.isInitiated()&&(s.RingerSwitchService.stopListener(),s.log("Ringer | stop detecting ringer status changes from OW videoOfferClosed event.",s.LogLevels.info)),me()&&(K=!1,De())}),c.PubSub.subscribe("SDKController.dialogBoxResume",function(e){pe(e)&&ie.trackEvent(O.dialogBoxResume)}),c.PubSub.subscribe("SDKController.dialogBoxExit",function(e){pe(e)&&ie.trackEvent(O.dialogBoxExit)}),c.PubSub.subscribe(u+".GetCompletionOffers",function(e){if(c.Utils.isDefined(e.productType)){var n=Ge();ae.getInventory(n.data,o,"json").then(ge.bind(null,e),ge.bind(null,e))}})};function ge(e,n){ae.isValidResponseStructure(n)&&(n=cn(n)),e&&e.callback&&e.callback.call(null,n)}function pe(e){return e&&e.productType===S.productType}function ve(){return s._getApplicationConfigurationFromServer().then(function(){return ne=p.extend(!0,ne,s.getOfferWallConfiguration()),c.Utils.returnResolvedPromise(ne)},function(e){return s.log(e,s.LogLevels.error),c.Utils.returnResolvedPromise(ne)})}function me(){return R&&K}function be(e){s.log("Marked offer clicked for CSC with type "+e.type,s.LogLevels.verbose),K=!0}function he(e){return x=e&&e.placementId||U,s.log("Updated placement to "+x,s.LogLevels.verbose),x}var Se=function(e,n){V&&"pending"===V.state()&&p.when(V).always(function(){Se(e,n)}),(N[e]=n)?M++:M--,p.when(E).always(function(){s.log("poll counter set to: "+M,s.LogLevels.verbose),V=s.setUserData(b.applicationKey,b.applicationUserId,{counter:M}),p.when(V).always(function(){V=null})})},ye=function(){var e=new p.Deferred,n={counter:0,timestamp:0};return p.when(E,V).always(function(){p.when(s.getUserData(W,j)).then(function(e){M=n.counter=c.Utils.isDefined(e.counter)?e.counter:0,k=n.timestamp=c.Utils.isDefined(e.timestamp)?e.timestamp:0}).always(function(){p.when(s.setUserData(W,j,n)).then(function(){s.log("initiation done with resolve",s.LogLevels.verbose),e.resolve()},function(){s.log("initiation done with reject",s.LogLevels.error),e.reject()})})}),e.promise()};function Ce(){if(!re){re=!0,s.initEventics(S);var e={owPageNumber:0,isPrecache:ne.precache};ie.updateBaseData(e)}}var Ae=function(e){var n,t;if(E){if("pending"===E.state())return E.promise()}else E=new p.Deferred;return n=c.PubSub.subscribe(g+".adCreditedSuccess",function(){k=e.timestamp,E.resolve(),c.PubSub.clearHandlers([n,t])}),t=c.PubSub.subscribe(g+".adCreditedFailed",function(e){E.reject(e.errMsg),c.PubSub.clearHandlers([n,t])}),p.when(V).always(function(){s.callSDKFunction("adCredited",e,"adCreditedSuccess","adCreditedFailed")}),E.promise()},De=function(n,t){var i={},r=[];if(s.log("In poll with counter "+M,s.LogLevels.verbose),!c.Utils.isDefined(n)&&M<=0||B&&"pending"===B.state())s.log("Exit poll, p:"+(B?B.state():null)+" a:"+(E?E.state():null),s.LogLevels.verbose);else{var e=s.getApiData(w),a=0;if(c.Utils.isDefined(e.errMsg)||!c.Utils.isDefined(W)||!c.Utils.isDefined(j))return s.log(e.errMsg,s.LogLevels.error),void(c.Utils.isDefined(n)&&c.Utils.isDefined(t)&&s.callSDKFunction(t,{errMsg:"Failed to make polling request, missing data"}));c.Utils.decodeValues(e);var o={aid:W,auid:j,SDKVersion:e.SDKVersion,timestamp:k};He(o),B=p.ajax({url:l,data:o,timeout:Z.pollAPITimeout,type:"GET",dataType:"jsonp"}),p.when(B).then(function(e){if(s.log("Received poll data",s.LogLevels.verbose),!(c.Utils.isDefined(e.rewardsData)&&c.Utils.isDefined(e.sig)&&c.Utils.isDefined(e.rewardsSummary)))return s.log("Poll data error",s.LogLevels.error),void(c.Utils.isDefined(n)&&c.Utils.isDefined(t)&&s.callSDKFunction(t,{errMsg:"Failed to retrieve user completion data, data error"}));!c.Utils.isEmptyObject(e.rewardsData)||c.Utils.isDefined(n)?(s.log(a,s.LogLevels.verbose),i={productType:u,credits:e.rewardsFromTime,total:e.rewardsSummary,signature:e.sig,timestamp:e.latestCompletionTime,externalPoll:c.Utils.isDefined(n),totalCreditsFlag:0===k},p.when(E).always(function(){E=null,p.when(Ae(i)).then(function(){p.each(e.rewardsData,function(){this.b&&N[this.b]&&Se(this.b,!1),r.push(this.id),a+=this.r?this.r:0}),0<r.length&&p.ajax({url:e.callbackURL,type:"GET",dataType:"jsonp",data:{vt:r.join(","),applicationKey:W,applicationUserId:j},success:function(){s.log("successfully updated server on csc",s.LogLevels.verbose)},error:function(e){s.log("failed to update server on csc",s.LogLevels.error)}})}).always(function(){E=null})})):s.log("no new completions",s.LogLevels.verbose)},function(e){s.log("Error retrieve user completion data",s.LogLevels.verbose),c.Utils.isDefined(n)&&c.Utils.isDefined(t)&&s.callSDKFunction(t,{errMsg:"Failed to retrieve user completion data"})})}};function Ie(){return oe.canEngage()?c.Utils.returnResolvedPromise():oe.isConnected()?c.Utils.returnRejectedPromise(C.engaged):c.Utils.returnRejectedPromise(T.noInternet)}function we(e){e&&(v=e)}function Pe(e){return e in v?v[e]:null}function Le(e,n){var t;return t=e?n:b=s.getApiData(D),c.Utils.returnResolvedPromise(t)}function Te(e){return R=e&&("true"===e.useClientSideCallbacks||"boolean"==typeof e.useClientSideCallbacks&&e.useClientSideCallbacks),c.Utils.returnResolvedPromise(e)}function Oe(e){var n=On(e);return c.Utils.returnResolvedPromise(n,e)}function Fe(t,e){return Le(t,e).then(Te).then(Oe).then(function(e,n){return e&&(R||t)?(s.log("Initiating CSC",s.LogLevels.verbose),Fn(n),ye()):c.Utils.returnResolvedPromise()})}function Ue(){return Ie().then(s.getApplicationInfo.bind(s,S)).then(function(){return he(s.getApiData({placementId:1})),Fe()})}function xe(){s.log("In Refresh Interval",s.LogLevels.verbose),oe.duringEngage()?s.log("Refresh Interval Popped, but during engage - ignore",s.LogLevels.verbose):oe.waitUntilAppInForeground().then(oe.waitUntilConnected).then(function(){s.log("Refresh Interval Popped, calling refreshOfferWall",s.LogLevels.verbose),s.unloadFramesByProduct(S),Ne()})}function Ne(e){Ve(),oe.isConnected()&&($e(),ne.precache?mn():e&&!ne.getInventoryOnInit||Ee())}function Me(){$=setTimeout(function(){s.log("Adunit static assets timer popped",s.LogLevels.verbose),Be(C.adunitAssetsTimeout)},Z.adUnitAssetsTimeout)}function ke(e){clearTimeout($),s.log("Resolve adunit static assets promise",s.LogLevels.verbose),J.resolve(e)}function Be(e){clearTimeout($),s.log("Reject adunit static assets promise - "+JSON.stringify(e),s.LogLevels.verbose),J.reject.apply(J.reject,arguments)}function Ee(){var e=Ge();e.errMsg||pn(e).always(Cn)}function Ve(){_=z=Q=null}function Re(){var e=c.PubSub.subscribe(u+".GetConfig",function(e){s.log("Received event OW getConfig",s.LogLevels.verbose),ke(e)});return function(){c.PubSub.unsubscribe(e)}}function Ke(){var e=c.PubSub.subscribe(f+".Engaged",function(e){e.productType===u&&(X=!0)});return function(){c.PubSub.unsubscribe(e)}}function je(){J=new p.Deferred,ie.trackTimingStart(O.staticAssetsLoaded);var e=Re();return p.when(m?(s.log("Using cached adunit url: "+m,s.LogLevels.verbose),c.Utils.returnResolvedPromise({html:m})):G.getGlobalAssetsJSON()).then(function(e){if(m||(G.setAdunitVersion(e),m=G.getAdunitGlobalsHTML()),X)Be("User closed before visible");else if("rejected"===Q.state())Be("Finished when flow already failed");else{var n=G.getStaticGlobalsUrl()+m+H;setTimeout(function(){s.updateAdUnitUrl(P,n,S,{preload:!0,forceCreation:!0})},0),Me()}},Be),J.promise().then(function(e){return ie.trackTimingStop(O.staticAssetsLoaded),e}).always(function(){e()})}function We(){var e={pass:!0,reason:"ok"};return oe.isConnected()?s.isSupportedOsVersion(u)?s.isLimitedDeviceModel()&&(e.reason="Device is not supported",e.pass=!1):(e.pass=!1,e.reason="Operating system version "+s.getConfigurationHelper().getDeviceOsVersion()+" is not supported"):(e.pass=!1,e.reason=T.noInternet),e}function Ge(){var e={data:null,errMsg:null},n=s.getApiData(D);return c.Utils.isDefined(n.errMsg)?e.errMsg=n.errMsg:n==={}?e.errMsg=C.missingData:(n.format=d,He(n),c.Utils.decodeValues(n),e.data=n,b=n),e}function He(e){var n=s.getSDKDataByKey(i.abTests.abt);n&&n.hasOwnProperty(i.abtParamByProductType[u])&&0<n[i.abtParamByProductType[u]].length&&(e.abt=n[i.abtParamByProductType[u]])}function qe(e){if(Q&&"pending"===Q.state()){var n={eNameStart:O.initOW,callFailReason:e.errMsg};e.errCode&&(n.errorCode=e.errCode),e.failFlow!=A.preConditions&&ie.trackTimingStop(O.initOWFail,n),s.log("Rejecting Init OW flow - "+e.errMsg,s.LogLevels.verbose),Q.reject(e)}}function Je(e,n){return{failFlow:e,errMsg:n}}function Qe(){return Je(A.close,"User closed before visible",!0)}function _e(e,n,t){var i=Je(e,n);return i.errCode=t||0,i}function ze(){return q&&"pending"===q.state()}function Xe(){return Q&&"pending"===Q.state()}function $e(){Y&&(clearTimeout(Y),Y=null)}function Ye(){var e=s.getApiData({scdn:1,protocol:0,defaultProtocol:1}),n=s.decideUrlProtocolAccordingToHTTPSCompliance(),t=e.scdn;return{protocol:n,urltocdn:"prod"!==s.getEnv()?s.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env:n+"//"+t,preload:ne.precache,hasNotch:s.getNotchService().hasNotch()}}function Ze(e,n){ie.trackTimingStop(O.initOWSuccess,{eNameStart:O.initOW});var t=ze(),i=e.offers&&0<e.offers.length;if(t||i)return T.confirmCloseMsg=e.textData.confirmCloseMsg,p.extend(e.settings,Ye(),s.getFormattedDeviceData()),nn(e),tn(e),an(e).then(function(e){en(e),n.callback.call(null,e)});var r=Je(A.inventoryInBackground,"Empty Inventory");return s.log("No inventory available while preloading in background - Remove iframe",s.LogLevels.verbose),s.unloadFramesByProduct(S),qe(r),c.Utils.returnRejectedPromise(r)}function en(e){var n={settings:{deviceId:s.getDeviceId(),appKey:s.getSDKDataByKey(i.requiredSDKDataKeys.applicationKey)}};return p.extend(!0,e,n)}function nn(e){s.getConfig().mobileSDKSettings.deviceOs!==i.deviceOs.ios&&e.settings.forceOWOrientation&&(P.ext={forceOrientation:e.settings.forceOWOrientation})}function tn(e){if(e.settings.allowPopup)for(var n=e.offers,t=0;t<n.length;t++)if(3669653==n[t].campaignId){n[t].isPopup=!0;var i=s.decideUrlProtocolAccordingToHTTPSCompliance();return void(n[t].assets.banner=i+"//static.ssacdn.com/operations/1280x800_hs_image001_nb_en_32584/1280x800_hs_image001_nb_en.jpg")}}function rn(){return x||U}function an(e){var n=new p.Deferred;if(!e.settings.placementsFlow)return n.resolve(cn(e));if(ze())n.resolve(ln(e));else{s.log("Waiting for show before resolving getConfig",s.LogLevels.verbose);var t=c.PubSub.subscribe(g+".showOfferWall",function(){c.PubSub.unsubscribe(t),s.getApplicationInfo(S).then(function(){he(s.getApiData({placementId:1})),n.resolve(ln(e))})})}return n.promise()}function on(e,n){if(!e)return!1;if(e.offers&&0<e.offers.length){var t=e.offers[0];return t.rewards&&t.rewards[n]}return!!e.settings.currency&&e.settings.currency[n]}function sn(e,n){if(!e.intermediateData||!e.intermediateData.text)return e;var t=e.currency||n,i=e.intermediateData.text.actionButton,r=e.intermediateData.text.instructionDescription,a=e.intermediateData.text.instructions,o={"{{rewardCount}}":e.rewards,"{{currencyName}}":t};if(0<i.length&&(e.intermediateData.text.actionButton=c.Utils.replacePlaceHolder(i,o)),0<r.length&&(e.intermediateData.text.instructionDescription=c.Utils.replacePlaceHolder(r,o)),0<a.length)for(var s=0;s<a.length;s++)a[s]=c.Utils.replacePlaceHolder(a[s],o);return e}function cn(e){for(var n=e.offers,t=0;t<n.length;t++)n[t]=sn(n[t],e.settings.currency);return e}function ln(e){var n=e.offers,t=rn();on(e,t)||(t=he({placementId:U})),e.settings.placementId=t;for(var i=0;i<n.length;i++)n[i].textData=n[i].textData[t],n[i].rewards=n[i].rewards[t],n[i]=sn(n[i],e.settings.currency[t]);try{e.settings.currency=e.settings.currency[t],e.settings.doublePromotionData=e.settings.doublePromotionData[t],e.settings.linksData.contactSupport.label=e.settings.linksData.contactSupport.label[t],e.textData.header=e.textData.header[t]}catch(e){s.log("Failed to interpolate inventory response",s.LogLevels.error)}return e}function dn(e,t){t.failFlow!==A.close?(ze()?t.failFlow===A.inventory&&e.then(function(e){var n=p.extend({},ee);n.ext.emptyOWReason=t.errMsg,en(n),e.callback.call(null,n)}):(t.failFlow===A.inventory&&(t=Je(A.inventoryInBackground,"Failed to get Inventory"),s.log("Inventory failed while preloading in background - Remove iframe",s.LogLevels.verbose)),s.unloadFramesByProduct(S)),qe(t)):qe(t)}function un(e){return s.log("Get Inventory",s.LogLevels.verbose),ae.getInventory(e.data,s.getBaseServerUrl()).then(function(e){if(X){var n=Qe();return c.Utils.returnRejectedPromise(n)}return e},function(e){return X?Qe():_e(A.inventory,e.errorMessage,e.errorCode)}).then(function(e){return te.filterByAppInstalled(e.offers,e.settings).then(function(){return c.Utils.returnResolvedPromise(e)})})}function fn(){return s.log("Load Adunit",s.LogLevels.verbose),je().then(null,function(e){return X?Qe():Je(A.adunit,e)})}function gn(){if(s.log("OfferWall.js | _handlePreConditions",s.LogLevels.verbose),_&&"pending"===_.state())return s.log("OfferWall.js | _handlePreConditions already has deferred "+_.state(),s.LogLevels.verbose),_;var e;_=new p.Deferred,X=!1,Ce(),ie.trackEvent(O.initOW),ie.trackTimingStart(O.initOW),$e();var n=!0,t=We();t.pass||(qe(e=Je(A.preConditions,t.reason)),n=!1);var i=Ge();return i.errMsg&&(qe(e=Je(A.preConditions,i.errMsg)),n=!1),n?_.resolve(i):_.reject(e),_.promise()}function pn(e){return s.log("OfferWall.js | _getInventoryWithPromise",s.LogLevels.verbose),z&&"rejected"!==z.state()?(s.log("OfferWall.js | _getInventoryWithPromise already has deferred "+z.state(),s.LogLevels.verbose),z):z=un(e).then(function(e){e.settings=e.settings||{};var n=e.settings;return n.shouldStartMuted=s.AdUtils.isCampaignShouldStartMuted(s.getConfig().controllerConfig,i.OW),we(p.extend(n,s.getApplicationExternalConfig().getABTestConfiguration("Offerwall",e.settings.templateId))),vn({feedSize:e.offers.length,landingId:e.settings.templateId,strategyId:e.settings.strategyId}),c.Utils.returnResolvedPromise(e)})}function vn(e){ie.updateBaseData(e)}function mn(){return s.log("OfferWall.js | _initOfferWall",s.LogLevels.verbose),Q&&"rejected"!==Q.state()?s.log("OfferWall.js | _initOfferWall using cached promise in Init OW flow",s.LogLevels.verbose):(Q=new p.Deferred,hn().then(function(){Q.resolve()})),Q.promise()}function bn(n){var t=new p.Deferred;return s.shouldExtendApiDataWithDebugData()?s.extendApiDataWithDebugParams(n.data).then(function(e){n.data=e,t.resolve(n)}):t.resolve(n),t.promise()}function hn(){var n=null;return gn().then(function(e){return bn(e)}).then(function(e){return n=fn(),p.when(pn(e),n)}).then(function(e,n){return Ze(e,n)},function(e){return dn(n,e)}).always(Cn)}function Sn(){return gn().then(pn,function(e){return e&&e.errMsg||(e={errMsg:C.preconditions}),s.log("OfferWall.js | CB.init preConditionsFailed "+JSON.stringify(e),s.LogLevels.verbose),c.Utils.returnRejectedPromise(e.errMsg)}).then(null,function(e){return s.log("OfferWall.js | CB.init getInventoryPromise fail",s.LogLevels.verbose),e=e||C.server,c.Utils.returnRejectedPromise(e)}).always(Cn)}function yn(){return ne.precache?(mn(),c.Utils.returnResolvedPromise()):ne.getInventoryOnInit?Sn():c.Utils.returnResolvedPromise()}function Cn(){if(!Y&&(ne.precache||ne.getInventoryOnInit)&&!wn(In())){var e=isNaN(ne.refreshInterval)||0===ne.refreshInterval?n:ne.refreshInterval;s.log("Setting OW refresh interval - "+e+" minutes",s.LogLevels.verbose),Y=setTimeout(xe,e*a)}}function An(){X&&c.Utils.returnRejectedPromise(Qe().errMsg)}function Dn(e){"object"!=typeof e&&(e={errMsg:e});var n=e.errMsg||"Generic error on ShowOfferWall";return X?n:e.failFlow===A.adunit?(ie.trackEvent(O.showOWFail,{callFailReason:n}),xn(n),n):e.failFlow===A.preConditions?(xn(n),n):(s.log("Empty OfferWall error",s.LogLevels.verbose),Tn(),c.Utils.returnResolvedPromise())}function In(){var e,n=Pe("standaloneOfferWallData");if(n&&n.url){var t=n.url,i=rn();c.Utils.isDefined(i)&&(t=c.Utils.replacePlaceHolder(t,{"{{PlacementId}}":i})),-1===t.indexOf("openOWInStandalone")&&(t+="&openOWInStandalone=true"),e=p.extend({},n,{url:t})}return e}function wn(e){return e&&e.openInStandaloneOfferWall&&e.url}function Pn(){return q&&"rejected"!==q.state()?(s.log("line[354]: Recalling showOW before resolving previous flow",s.LogLevels.error),ie.trackEvent(O.showOWFail,{callFailReason:"Recalling showOW before resolving previous flow"}),q):(q=new p.Deferred,Ce(),ie.incrementSessionNumber(),ie.trackTimingStart(O.initControllerToShowOWCalled,s.getApiData({controllerTimeLoaded:1}).controllerTimeLoaded),ie.trackTimingStop(O.showOWCalled,{eNameStart:O.initControllerToShowOWCalled}),ie.trackTimingStart(O.showOWCalledToOwVisible),Ue().then(function(){if(wn(t=In()))return c.Utils.returnResolvedPromise();var e=mn();return n=Ke(),Ln(e),e.then(An,Dn)},function(e){return xn(e),e}).always(function(){n&&n()}).then(function(){if(wn(t)){var e={url:t.url,method:"external_browser"};s.openUrl(e)}else Tn();s.log("Resolving ShowOfferWall",s.LogLevels.verbose),q.resolve.apply(this,arguments)},function(e){s.log("Rejecting ShowOfferWall",s.LogLevels.verbose),q.reject(e)}),q.promise());var n,t}function Ln(e){if(P.url=null,"resolved"!==e.state()||!ne.precache){var n=!!Pe(i.offerWallSetting.immersive)&&Pe(i.offerWallSetting.immersive);s.loadAdUnitUrl(P,P.url,S,{preload:!1,immersive:n,OLXD:Pe(i.offerWallSetting.OLXD)}),s.displayAdUnitFrame(P)}}function Tn(){s.loadAdUnitUrl(P,P.url,S,{preload:!1}),s.displayAdUnitFrame(P)}var On=function(e){var n=e.applicationUserId,t=e.applicationKey;return n!==j||t!==W},Fn=function(e){j=e.applicationUserId,W=e.applicationKey};function Un(e){return T.dialogErrorMessage}function xn(e){s.log("No OfferWall dialog error",s.LogLevels.verbose);var n={productType:u,message:Un(e),alwaysClose:!0,yes:"close",no:"OK"};s.alert(n)}function Nn(){var e=s.getProtocol();h={dev:e+i.gatewayDestinationMap.OW.production,stage:e+i.gatewayDestinationMap.OW.production,prod:e+i.gatewayDestinationMap.OW.production}}function Mn(e){return h[e]||h.prod}var kn={init:function(){r=this,p=s.jQuery(),Nn();var e=Mn(s.getEnv());if(!t){var n={productChance:(s.getEnv(),1),baseData:{productType:u}};"android"===s.getConfig().mobileSDKSettings.deviceOs&&(D.deviceApiLevel=0),ie=c.Eventics.createEventic(n),ae=new(Bn("../components/FetcherService.js"))(e,I),oe.init(),fe(),t=!0}},getNextBtnText:function(){return c.Utils.isDefined(T.next)?T.next:"Next"},getConfirmCloseMsg:function(){return T.confirmCloseMsg&&T.confirmCloseMsg[y[0]]},showOfferWall:Pn,isNextAvailable:function(){return!1},getBack:function(){return P.url}};return p.extend(kn,{_promisedCanEngage:Ie,_initiateClientSideCallbacks:Fe,_preShowOfferWall:Ue,_refreshInterval:xe,_refreshOfferWall:Ne,_setAdunitAssetsTimer:Me,_resolveAdunitAssetsPromise:ke,_rejectAdunitAssetsPromise:Be,_subscribeGetConfig:Re,_subscribeCloseDuringShow:Ke,_loadAdunitToIframe:je,_verifyRestrictions:We,_getAPIRequiredData:Ge,_rejectInitWithReason:qe,_generateErrorObject:Je,_generateCloseBeforeVisibleErrorObject:Qe,_isDuringShow:ze,_isDuringInit:Xe,_clearRefreshInterval:$e,_handleDependenciesResolve:Ze,_handleDependenciesReject:dn,_getInventory:un,_loadAdunit:fn,_handleInitOfferWallError:Dn,_showLoaderIfNeeded:Ln,_initOfferWallByConfig:yn,_displayOfferWall:Tn,_getInventoryAndPreload:hn,_initOfferWall:mn,_setOfferWallSettings:we,_getOfferWallSetting:Pe}),kn}e.exports=t},{"../components/CampaignsFilter.js":8,"../components/Constants.js":9,"../components/FetcherService.js":14}],95:[function(N,e,n){e.exports=function(b,f,g,p){"use strict";var r,n,t=f.instancesManager.getManualLoadInstancesBuilder(),v=new(N("./DemandSource/EventCategories.js"))(g.ProductName),m=new(N("./DemandSource/dsConfig.js"))(g,v),o=new(N("./prdTaskManager.js"))(b,f,g.ProductName,p),e=new(N("../components/FilteredListService")),a={},s={},i=!1,h=f.DemandUtils,c=[],l={loadSuccess:null,loadFailure:null};function S(e,n){var t=P(e);return t||(t=L(n)),t}function y(e){return n=e,!(f.getConfig().mobileSDKSettings.deviceOs===p.deviceOs.ios&&!n.isViewControllerSet);var n}function d(e,n,t){var i=O(e),r=U(e);if(D(r,i),w(i))!function(e,n,t){var i=m.errors.load.instanceExhausted;e.productType=g.ProductName;var r=h.extendCallbackParamsWithDemandConfig(e,{errMsg:i});n.trackEvent(v.loadAdFailedForExhaustedInstance,{},r),f.callSDKFunction(t,r)}(e,r,t);else{var a=S(i,e);if(C(a)){if(e&&e.productType===p.BN){if(!y(e))return o=e,r.trackEvent(v.loadAdFailed,{callfailreason:"Missing Parameter : View Controller"}),void f.callSDKFunction(s,h.extendCallbackParamsWithDemandConfig(o,{errMsg:"Missing Parameter : View Controller"}));f.addExternalAdViewIdAndSetStatus(e)}var o,s,c,l,d,u;l=e,d=n,u=t,(c=a).statesManager.load(c.loadAd,d,u,c.readyStateParams,l)}else A(e,r,t)}}function C(e){return e&&e.statesManager}function A(e,n,t){F(e,n,t,m.errors.general.dsNotSet)}function u(e,n,t){var i,r,a,o,s,c,l,d,u=O(e),f=S(u,e),g=x(f),p=function(e){if(!e)return null;try{var n=b.Utils.parseJSON(decodeURIComponent(e));return b.Utils.isEmptyObject(n)&&(n=null),n}catch(e){}return null}(e.adm),v=(i=e)&&i.dynamicDemandSource?i.dynamicDemandSource:null,m=(d="-1",(l=p)&&l.seatbid.ext.hasOwnProperty("auction")?l.seatbid.ext.auction.id:d);g.updateBaseData({auctionId:m,dynamicDemandSource:v}),D(g,u),C(f)?p?(r=f,o=p,s=n,c=t,(a=e).adm=o,r.statesManager.loadWithADM(r.loadAdWithAdm,s,c,r.readyStateParams,a)):F(e,g,t,"unable to parse adm from native SDK"):A(e,g,t)}function D(e,n){f.log("productAdapter - load",f.LogLevels.verbose),e.trackEvent(v.loadAd,{demandSourceName:n})}function I(e){return e&&e.productType===g.ProductName}function w(e){return-1!==c.indexOf(e)}function P(e){return e?r[e]:null}function L(e){return function(e){if(e){var n=e.demandSourceName;if(r[n])return r[n];f.log("initiating "+g.ProductName+" demand source with configuration "+JSON.stringify(e),f.LogLevels.verbose);var t={productChance:1,baseData:{productType:g.ProductName,demandSourceName:n,integrationType:p.integrationType.manual,isBiddingInstance:e.isInAppBidding}},i=b.Eventics.createEventic(t);return r[n]=new(N("./DemandSource/ProductInstance.js"))(b,f,p,e,m,i),r[n].statesManager=new(N("./ProductAdapter/ProductStatesManager.js"))(b,f,e,m,p,r[n].getDSEventics(),g.NativeAPI),r[n].init(),r[n]}}(t.createDemandEntityConfigObj(g.ProductName,O(e),T(e),e.demandSourceId))}function T(e){var n=!1;return e&&e.inAppBidding&&"true"===e.inAppBidding.toLowerCase()&&(n=!0),n}function O(e){return e&&e.demandSourceName?e.demandSourceName:g.DemandName}function F(e,n,t,i){e.productType=g.ProductName;var r=h.extendCallbackParamsWithDemandConfig(e,{errMsg:i});n.trackEvent(v.loadAdFailed,{callfailreason:i}),f.callSDKFunction(t,r)}function U(e){return x(r[O(e)])}function x(e){return e&&e.getDSEventics()?e.getDSEventics():n}return{init:function(){if(r=this,!i){var e={productChance:1,baseData:{productType:g.ProductName,integrationType:p.integrationType.manual}};n=b.Eventics.createEventic(e),function(){var e=f.getProtocol();a={dev:e+g.gatewayDestinationMap.prod,stage:e+g.gatewayDestinationMap.prod,prod:e+g.gatewayDestinationMap.prod};var n,t,i=f.getApiData({destinationMap:0});if(i&&i.destinationMap)for(n in s=i.destinationMap)t=s[n],s[n]&&0<s[n].length&&-1===s[n].indexOf(e)&&(s[n]=e+t)}(),b.PubSub.subscribe(g.AdUnitCallbacks.engageEnd,function(e,n){if(I(e)){var t=P(e.demandSourceName);t&&t.statesManager&&((e&&e.engaged||g.shouldResetOnEngageEnd)&&t.statesManager.engageEnd(),t.engageEnd(e,function(){o.publish("Engaged",[{duringEngage:!1,productType:g.ProductName}]),b.Utils.isFunction(n)&&n()}))}}),b.PubSub.subscribe(g.AdUnitCallbacks.adClicked,function(e){if(I(e)){var n=f.getCurrentDisplayedAd();n&&f.callSDKFunction(g.ControllerNativeAPI.adClicked,h.extendCallbackParamsWithProductConfig(n,{}))}}),b.PubSub.subscribe(g.AdUnitCallbacks.adVisible,function(e){if(I(e)){var n=P(e.demandSourceName);n?(n.adVisible(e),n.statesManager&&n.statesManager.adVisible()):f.log(g.AdUnitCallbacks.adVisible+" called without an active demand source name",f.LogLevels.verbose)}}),b.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.cacheReady,function(e){var n=P(e.demandSourceName);n&&n.statesManager&&(n.readyStateParams=e,n.statesManager.cacheReady(l.loadSuccess,e))}),b.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.allOffersVast,function(e){var n=P(e.demandSourceName);n&&n.statesManager&&n.statesManager.allOffersVast(l.loadFailure,e.errorMsg)}),b.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.noMoreOffers,function(e){var n=P(e.demandSourceName);n&&n.statesManager&&n.statesManager.noMoreOffers(l.loadFailure,e.errorMsg)}),b.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.failedToShow,function(e){var n=P(e.demandSourceName);n&&n.statesManager&&(f.log(g.ProductName+" failed to show - can not engage ad",f.LogLevels.error),n.statesManager.failedToShow())}),b.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.failedToLoad,function(e){var n=P(e.demandSourceName);n&&n.statesManager&&(f.log(g.ProductName+" failed to load",f.LogLevels.error),U(e).trackEvent(v.loadAdFailed,{callFailReason:e.errMsg}),n.statesManager.failedToLoad())}),b.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.actionClick,function(e){f.OpenURLService.open(e)||f.log(g.ProductName+" failed to perform ActionClick",f.LogLevels.info)}),b.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.exhaustedDemandSource,function(e){var n=O(e),t=P(n);f.log("exhaustedDemandSource: "+n,f.LogLevels.verbose),t&&(t.exhausted=!0),c.push(n),e&&e.engaged||(f.log("Demand source deleted in BG: "+n,f.LogLevels.verbose),delete r[n])}),b.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.fallbackToNonPrecache,function(e){var n=P(e.demandSourceName);n&&n.statesManager&&n.statesManager.noMoreOffers(l.loadFailure,"failed due to fallbackToNonPrecache flow on manual load")}),b.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.resetStateManager,function(e){var n=P(O(e));n&&n.statesManager&&n.statesManager.resetAdState()}),b.PubSub.subscribe("SDKController"+g.ControllerCallbacks.onAdWindowsClosed,function(e){if(I(e)){var n=P(e.demandSourceName);n&&n.exhausted&&(f.log("Demand source deleted: "+e.demandSourceName,f.LogLevels.verbose),delete r[e.demandSourceName])}}),g.ControllerCallbacks.reset&&b.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.reset,function(e){var n=P(e.demandSourceName);if(n)return f.getExternalContainer().resetReportAdVisibilityFlags(),U(e).trackEvent(v.bannerDestroyed),n.statesManager.resetAdState(),void n.reset();f.log("Reset called without an active demand source name",f.LogLevels.verbose)}),o.init(),i=!0}},getProductType:function(){return g.ProductName},getDestination:function(e){return s&&s[e]?s[e]:a[f.getEnv()]},getAmountOfSupportedInventories:function(){return g.amountOfInventories},shouldAvoidHandleFrameClose:function(){return g.shouldAvoidHandleFrameClose},doesAllowConsecutiveGatewayRequestsDuringLoad:function(){return g.Features.allowConsecutiveGatewayRequestsDuringLoad},getProductTM:function(){return o},getConfirmCloseMsg:function(e){return r[e]?r[e].getConfirmCloseMsg():null},initProduct:function(e,n,t){var i=O(e);U(e).trackEvent(v.initAd,{demandSourceName:i});var r=f.getSDKLimitationData(g.ProductName);if(!r.didSucceed)return U(e).trackEvent(v.initAdFail,{},{callFailReason:r.errMsg,demandSourceName:i}),void f.callSDKFunction(t,{errMsg:r.errMsg,demandSourceName:i});var a=L(e);a&&(a.initProduct&&b.Utils.isFunction(a.initProduct)&&a.initProduct(e),a.statesManager&&a.statesManager.init(n))},loadProduct:function(e,n,t){f.log("productAdapter - loadProduct",f.LogLevels.verbose),l.loadSuccess=n,l.loadFailure=t,T(e)?u(e,n,t):d(e,n,t)},showProduct:function(e,n,t){var i,r=O(e);if(U(e).trackEvent(v.showAd),e&&f.AppOrientationManager.updateAppOrientationByNewRestriction(e.orientationRestriction),w(r)){var a={errMsg:m.errors.show.instanceExhausted,demandSourceName:r};return U(e).trackEvent(v.showAdFail,{callfailreason:m.errors.show.instanceExhausted}),void f.callSDKFunction(t,a)}if(!(i=P(r)))return U(e).trackEvent(v.showAdFail,{callfailreason:m.errors.general.dsNotSet}),void f.callSDKFunction(t,{errMsg:m.errors.general.dsNotSet});o.canEngage()?(U(e).trackTimingStart(v.showAdCalled),i.statesManager&&i.statesManager.show(i.showAd,n,t)):i.onShowAdFailed(t)},isManualIntegration:!0,className:"ProductAdapter",filteredListService:e}}},{"../components/FilteredListService":16,"./DemandSource/EventCategories.js":78,"./DemandSource/ProductInstance.js":85,"./DemandSource/dsConfig.js":86,"./ProductAdapter/ProductStatesManager.js":97,"./prdTaskManager.js":124}],96:[function(e,n,t){n.exports={NativePrefix:"NativeCallback",className:"ProductAdapter",adStates:{notSet:0,waitingToLoad:1,inLoadingProcess:2,internalLoadingProcess:3,loaded:4,loadedFromInternalLoad:5,visible:6,inShowingProcess:7,failedInBackground:8}}},{}],97:[function(q,e,n){function t(a,s,c,l,r,d,o){var e=q("./ProductAdapterConstants.js"),u=e.adStates,n=u.notSet,f=l.eventicsCategories,g=!1,p=!1,v=s.DemandUtils,m=!1,b=v.extendCallbackParamsWithDemandConfig(c);function h(e){return n===e}function S(e){n=parseInt(e,10)}function t(){return n}function y(){return S(u.notSet)}function i(){return h(u.loadedFromInternalLoad)||h(u.loaded)}function C(e,n,t){if(g)g=!1;else if(h(u.waitingToLoad))S(u.internalLoadingProcess);else{if(h(u.inLoadingProcess)||p||c.productType===r.BN&&h(u.loaded)){d.trackEvent(t,{callFailReason:n},b);var i=v.extendCallbackParamsWithDemandConfig(c,{errMsg:l.errors.load.noMoreOffers});s.callSDKFunction(e,i),a.PubSub.publish("ProductStatesManager.stateResolved",[v.extendCallbackParamsWithProductConfig(c,{response:!1})])}p=!1,y()}}function A(e){if(o)if(e===o.load){if(h(u.inLoadingProcess)||h(u.waitingToLoad))return l.errors.load.duringLoad;if(h(u.visible)||h(u.inShowingProcess))return l.errors.load.duringShow}else if(e===o.show){if(h(u.notSet))return l.errors.show.notLoaded;if(h(u.inLoadingProcess)||h(u.waitingToLoad))return l.errors.show.duringLoad;if(h(u.visible)||h(u.inShowingProcess))return l.errors.show.visible}}function D(e,n){if(o)if(e===o.load)(h(u.inLoadingProcess)||h(u.waitingToLoad))&&s.log(A(o.load),s.LogLevels.error);else if(e===o.show)if(h(u.notSet)||B()||h(u.inLoadingProcess)){var t=v.extendCallbackParamsWithDemandConfig(c,{errMsg:A(o.show)});s.callSDKFunction(n,t)}else(h(u.visible)||h(u.inShowingProcess))&&s.log(A(o.show),s.LogLevels.error)}function I(e){var n=v.isLegacy(c)?{}:b;m=!0,s.callSDKFunction(e,n)}function w(e,n,t,i){c.productType!==r.BN?P(e,n,t,i):L(e,n,t,i)}function P(e,n,t,i){if(h(u.notSet)||h(u.loaded))S(u.inLoadingProcess),e(b,function(){},t);else if(h(u.loadedFromInternalLoad))d.trackEvent(f.loadAdSuccess,{},b),s.callSDKFunction(n,v.extendCallbackParamsWithDemandConfig(c,i)),S(u.loaded),a.PubSub.publish("ProductStatesManager.stateResolved",[v.extendCallbackParamsWithProductConfig(c,{response:!0})]);else if(g||p){var r=g?l.errors.load.inStateVisibleOrInShowingProcess:l.errors.load.inLoadingStateOrWaitingToLoad;d.trackEvent(f.loadAdIgnored,{callfailreason:r},b)}else h(u.visible)||h(u.inShowingProcess)?g=!0:B()?p=!0:(d.trackEvent(f.loadAdFailed,{callfailreason:A(o.load)},b),D(o.load))}function L(e,n,t,i){d.trackTimingStart(f.bannerLoadToLoadSuccess);var r=function(){};h(u.notSet)?(S(u.inLoadingProcess),e(b,r,t)):h(u.loaded)?(S(u.notSet),e(b,void 0,t)):h(u.visible)||h(u.inShowingProcess)?(S(u.inLoadingProcess),e(b,r,t)):B()?p=!0:h(u.inLoadingProcess)?d.trackEvent(f.bannerReloadDuringLoad,v.extendCallbackParamsWithDemandConfig(c)):(d.trackEvent(f.loadAdFailed,{callfailreason:A(o.load)},b),D(o.load))}function T(e,n,t,i,r){if(!m){var a="instance was not initiated",o=v.extendCallbackParamsWithDemandConfig(c,{errMsg:a});return d.trackEvent(f.loadAdFailed,{callfailreason:a},b),void s.callSDKFunction(t,o)}if(h(B()))return d.trackEvent(f.loadAdIgnored,{callfailreason:l.errors.load.inLoadingStateOrWaitingToLoad},b),void s.log("productStateManager | loadWithADM | already in loading process",s.LogLevels.verbose);S(u.inLoadingProcess),e(r,function(){},t)}function O(e,n,t){i()?(S(u.inShowingProcess),e(b,n,t)):(d.trackEvent(f.showAdFail,{callfailreason:A(o.show)},b),D(o.show,t))}function F(e,n){c.productType!==r.BN?U(e,n):x(e,n)}function U(e,n){var t=!1;(h(u.inLoadingProcess)||p)&&(t=!0),p=!1,h(u.internalLoadingProcess)?S(u.loadedFromInternalLoad):S(u.loaded),t&&(d.trackEvent(f.loadAdSuccess,{},b),s.callSDKFunction(e,v.extendCallbackParamsWithDemandConfig(c,n)),a.PubSub.publish("ProductStatesManager.stateResolved",[v.extendCallbackParamsWithProductConfig(c,{response:!0})]))}function x(e,n){(h(u.inLoadingProcess)||h(u.visible)||p)&&(d.trackTimingStop(f.loadAdSuccess,{eNameStart:f.bannerLoadToLoadSuccess}),d.trackTimingStart(f.bannerLoadSuccessToVisible),s.callSDKFunction(e,v.extendCallbackParamsWithDemandConfig(c,n)),a.PubSub.publish("ProductStatesManager.stateResolved",[v.extendCallbackParamsWithProductConfig(c,{response:!0})])),p=!1,S(u.loaded)}function N(e,n){C(e,n,f.loadAdFailed)}function M(e,n){C(e,n,f.loadAdFailed)}function k(e,n){C(e,n,f.loadAdFailedForOnHoldInstance)}function B(){return h(u.waitingToLoad)||h(u.internalLoadingProcess)}function E(){y()}function V(){y()}function R(){c.productType===r.BN?j():K()}function K(){S(g?u.inLoadingProcess:u.waitingToLoad)}function j(){S(u.notSet)}function W(){S(u.visible)}function G(){return h(u.failedInBackground)}var H={getAdState:t,init:I,load:w,show:O,cacheReady:F,allOffersVast:N,noMoreOffers:M,failedToShow:E,failedToLoad:V,instanceLoadFailedOnHold:k,engageEnd:R,isFailedInBG:G,adVisible:W,loadWithADM:T,resetAdState:y};return H}e.exports=t},{"./ProductAdapterConstants.js":96}],98:[function(c,e,n){e.exports=function(a,r,e){"use strict";var n,t=c("./AdapterSharedConfig.js"),i=[];function o(e){return r.RewardedVideo||(r.RewardedVideo=r.RewardedAdFactory.create({isManualLoadFlow:e.isManualLoadFlow}),r.BrandConnect=r.RewardedVideo,r.RewardedVideo.init()),r.RewardedVideo}function s(e){return e&&"true"===e.rewarded?o({isManualLoadFlow:!0}):(r.Interstitial||(r.Interstitial=r.InterstitialFactory.create(),r.Interstitial.init()),r.Interstitial)}return{initModule:function(){n||(i.push(a.PubSub.subscribe(e.CB+t.NativeAPI.init,function(e,n,t){var i,r;(i=e)&&i.apiVersion&&(r=a.Utils.apiVersionCompareTo(i.apiVersion,"1")),0<r&&(n=t=function(){}),s(e).initProduct(e,n,t)})),i.push(a.PubSub.subscribe(e.CB+t.NativeAPI.load,function(e,n,t){s(e).loadProduct(e,n,t)})),i.push(a.PubSub.subscribe(e.CB+t.NativeAPI.show,function(e,n,t){var i;(i=e,i&&"true"===i.rewarded?r.RewardedVideo:r.Interstitial).showProduct(e,n,t)})),i.push(a.PubSub.subscribe(e.CB+".initRewardedVideo",function(e,n,t){o({isManualLoadFlow:!1}).initRewardedVideo(e,n,t)})),i.push(a.PubSub.subscribe(e.CB+".showRewardedVideo",function(e,n,t){r.RewardedVideo.showRewardedVideo(e,n,t)})),i.push(a.PubSub.subscribe(e.CB+".initBrandConnect",function(e,n,t){o({isManualLoadFlow:!1}).initBrandConnect(e,n,t)})),i.push(a.PubSub.subscribe(e.CB+".showBrandConnect",function(e,n,t){r.RewardedVideo.showBrandConnect(e,n,t)})),i.push(a.PubSub.subscribe(e.CB+".initBanner",function(e,n,t){(r.Banner||(r.Banner=r.BannerFactory.create(),r.Banner.init()),r.Banner).initProduct(e,n,t)})),i.push(a.PubSub.subscribe(e.CB+".loadBanner",function(e,n,t){r.Banner.loadProduct(e,n,t)})),i.push(a.PubSub.subscribe(e.CB+".bannerViewVisible",function(e,n,t){r.Banner.showProduct(e,n,t)})),n=!0)},destroyListeners:function(){jQuery.each(i,function(e,n){a.PubSub.unsubscribe(n)}),n=!1},className:"ProductRouter"}}},{"./AdapterSharedConfig.js":73}],99:[function(c,e,n){e.exports=function(a,o){var s=c("../components/Constants.js");return{create:function(e){var n;if(!0===e.isManualLoadFlow){var t=c("./ProductAdapter.js"),i=c("./AdapterSharedConfig.js"),r=c("./RewardedVideo/RewardedAdConfiguration.js")(i,o.SupplyUtils,s);n=new t(a,o,r,s)}else n=new(c("./RewardedVideo/RewardedVideo.js"))(a,o);return n}}}},{"../components/Constants.js":9,"./AdapterSharedConfig.js":73,"./ProductAdapter.js":95,"./RewardedVideo/RewardedAdConfiguration.js":100,"./RewardedVideo/RewardedVideo.js":101}],100:[function(e,n,t){n.exports=function(e,n,t){var i=n.shouldFetchNewFeedOnAdCloseFlag(t.RV);return i=void 0===i||i,{NativeAPI:e.NativeAPI,ControllerCallbacks:e.ControllerCallbacks,AdUnitCallbacks:e.AdUnitCallbacks,ControllerNativeAPI:e.NativeAPI,retriesLogic:e.retriesLogic,DemandName:"SupersonicAds",ProductName:t.RV,Features:{allowMultiInitCalls:!0,reportOnAdunitReady:!0,shouldFetchNewFeedOnAdClose:i,isSupportFetchFeedOnAdCloseLogic:!0,preFetchAllVasts:!0,allowConsecutiveGatewayRequestsDuringLoad:!0,isExhaustInstanceAllowed:!0},gatewayDestinationMap:{prod:t.gatewayDestinationMap.RV.production},amountOfInventories:1}}},{}],101:[function(x,e,n){function t(i,c){"use strict";var l,n=!1,o=x("../../components/Constants.js"),e={preFetchAllVasts:!0,shouldFetchNewFeedOnAdClose:!1,isSupportFetchFeedOnAdCloseLogic:!1},d=o.RV,t={ProductName:d,Features:e,retriesLogic:{maxNumOfAttemptsToCallAPI:2,initAttemptsDelay:500,serverResponseTimeoutInMilis:1e4}},u=new(x("./../DemandSource/EventCategories.js"))(d),r=new(x("./../DemandSource/dsConfig.js"))(t,u),a=new(x("./../prdTaskManager.js"))(i,c,d,o),f,s={},g={},p;function v(n,t,i){if(!n||!n.demandSourceName)return f.trackEvent(u.initAdFail,{callFailReason:"Missing demand name on initiation"}),void c.callSDKFunction(i,{errMsg:"Missing demand name on initiation"});var e=c.getSDKLimitationData(d);if(e.didSucceed){var r=c.instancesManager.createUninitializedDemandInstance(d,n.demandSourceName,!1);A(r);var a=l[r.demandSourceName],o=a.initProduct.bind(null,n,function(e){e&&e.eventics&&(e.eventics.trackEvent(u.initAd),e.eventics.trackTimingStart(u.initAdToAdReady)),a.loadAd(n,t,i)},i),s=a.instanceOnHold;c.instancesManager.initiateDemandInstance(d,n.demandSourceName,o,s)}else C(n.demandSourceName,i,e)}function m(e,n,t){if(e&&e.demandSourceName){var i=O(e.demandSourceName);i?(y(i),c.AppOrientationManager.updateAppOrientationByNewRestriction(e.orientationRestriction),i.showAd(e,n,t)):c.callSDKFunction(t,{errMsg:"Error calling show, uninitialized product.",demandSourceName:e.demandSourceName})}else c.callSDKFunction(t,{errMsg:"Missing demand name on show."})}function b(n,t,i){if(c.isLegacy(c.featureMap.MDS[o.RV])){n||(n={}),n.demandSourceName=o.BC;var e=c.getSDKLimitationData(d);if(e.didSucceed){var r=c.instancesManager.createUninitializedDemandInstance(d,n.demandSourceName,!1);c.initEventics({productType:o.BC});var a=A(r);a.initProduct(n,function(e){e&&e.eventics&&(e.eventics.trackEvent(u.initAd),e.eventics.trackTimingStart(u.initAdToAdReady)),a.loadAd(n,t,i)},i)}else C(n.demandSourceName,i,e)}else c.callSDKFunction(i,{errMsg:"Unsupported API function, use initAds instead."})}function h(e,n,t){if(c.isLegacy(c.featureMap.MDS[o.RV])){var i=O(o.BC);i?(e||(e={}),e.demandSourceName=o.BC,y(i),i.showAd(e,n,t)):c.callSDKFunction(t,{errMsg:"Error calling show, uninitialized product."})}else c.callSDKFunction(t,{errMsg:"Unsupported API function, use showRewardedVideo instead."})}var S=function(){i.PubSub.subscribe(d+".exhaustedDemandSource",function(e){var n=e;I(e)&&n.demandSourceName&&l[n.demandSourceName]&&(l[n.demandSourceName].exhausted=!0,c.instancesManager.exhaustedDemandSource(d,n),e&&e.engaged||(c.log("Demand source deleted in BG: "+n.demandSourceName,c.LogLevels.verbose),delete l[n.demandSourceName]))}),i.PubSub.subscribe("SDKController.AdVisible",function(e){if(I(e)){a.publish("Engaged",[D({duringEngage:!0})]);var n=O(e.demandSourceName);n&&n.adVisible(e)}}),i.PubSub.subscribe("SDKController.onAdWindowsClosed",function(e){if(I(e)){var n=e.demandSourceName;n&&l[n]&&l[n].exhausted&&(c.log("Demand source deleted: "+n,c.LogLevels.verbose),delete l[n])}}),i.PubSub.subscribe("SDKController.engageEnd",function(e,n){if(I(e)){var t=O(e.demandSourceName);t&&t.engageEnd(e,function(){T(e.engaged),i.Utils.isFunction(n)&&n()})}}),i.PubSub.subscribe("SDKController.AdClicked",function(e){var n=c.getCurrentDisplayedAd();I(e)&&n&&"CPVI"===n.ext.type&&c.callSDKFunction("adClicked",{productType:d,demandSourceName:n.demandSourceName})}),i.PubSub.subscribe(d+".ActionClick",function(e){c.OpenURLService.open(e)||c.log(d+" failed to perform ActionClick",c.LogLevels.info)}),i.PubSub.subscribe(d+".failedToLoad",function(e){e&&e.demandSourceName&&f.trackEvent(u.initAdFail,{callFailReason:e.errMsg})})};function y(e){e.updateEventicsWithAdData(),e.getDSEventics().trackEvent(u.showAd),e.getDSEventics().trackTimingStart(u.showAdCalled)}function C(e,n,t){f.trackEvent(u.initAd,{callFailReason:t.errMsg,demandSourceName:e}),f.trackEvent(u.initAdFail,{callFailReason:t.errMsg,demandSourceName:e}),c.callSDKFunction(n,{errMsg:t.errMsg,demandSourceName:e})}function A(e){var n=e.demandSourceName;return l[n]||(l[n]=new(x("./../DemandSource/ProductInstance.js"))(i,c,o,e,r,null),l[n].init(),f=l[n].getDSEventics()),l[n]}function D(e){return(e=e||{}).productType=L(),e}function I(e){return e&&(e.productType===d||e.productType===o.BC)}function w(){var e=c.getProtocol();s={dev:e+o.gatewayDestinationMap.RV.production,stage:e+o.gatewayDestinationMap.RV.production,prod:e+o.gatewayDestinationMap.RV.production};var n,t,i=c.getApiData({destinationMap:0});if(i&&i.destinationMap)for(n in g=i.destinationMap)t=g[n],g[n]&&0<g[n].length&&-1===g[n].indexOf(e)&&(g[n]=e+t)}function P(e){return g&&g[e]?g[e]:s[c.getEnv()]}function L(){return p?o.BC:d}var T=function(e){e&&a.publish("Engaged",[{duringEngage:!1,productType:d}])};function O(e){return e?l[e]:(c.log("cannot extract demand source name from data",c.LogLevels.verbose),null)}function F(e){return l[e]?l[e].getConfirmCloseMsg():null}var U={name:"RewardedVideo",className:"RewardedVideo",init:function(){if(l=this,!n){var e={productChance:(c.getEnv(),1),baseData:{productType:d,integrationType:o.integrationType.automatic}};f=i.Eventics.createEventic(e),p=c.isLegacy(c.featureMap.MDS[o.RV]),S(),a.init(),w(),n=!0}},getProductType:L,getDestination:P,getProductTM:function(){return a},getConfirmCloseMsg:F,getAmountOfSupportedInventories:function(){return o.DEFAULT_AMOUNT_OF_INVENTORIES},doesAllowConsecutiveGatewayRequestsDuringLoad:function(){return!0},initRewardedVideo:v,showRewardedVideo:m,initBrandConnect:b,showBrandConnect:h};return l=U,U}e.exports=t},{"../../components/Constants.js":9,"./../DemandSource/EventCategories.js":78,"./../DemandSource/ProductInstance.js":85,"./../DemandSource/dsConfig.js":86,"./../prdTaskManager.js":124}],102:[function(e,n,t){n.exports=function(e,t,c,n,f){var g=n.eventicsCategories,i=n.responseTypesWithReason,p={};function r(e){e&&"RewardedVideo"===n.productType&&t.DemandUtils&&!t.DemandUtils.isManualRewardedVideoIntegration()&&f.trackEvent(g.noMoreOffers,{callFailReason:e}),c.publishAvailabilityFalse("NoMoreOffers",e)}function v(e,n){return p.preFetchAllVasts&&n||p.isPreCache&&e}function m(e,n,t,i,r,a,o){v(e,o)?(n(),r()):p.reportOnAdunitReady&&p.isPreCache&&0!==a||r()}function l(e,n){r(e),n()}function d(e,n){l(e,n)}function b(e,n){t.log("Availability Manager | reportAdAvailable",t.LogLevels.verbose),a(i.ready)||(a(i.none)&&f.trackTimingStop(g.adReady,{eNameStart:g.initAdToAdReady}),c.publishAvailabilityTrue(e,n))}function a(e){return c.isCurrentState(e)}function o(e,n){p.reportOnAdunitReady&&p.isPreCache&&0!==p.numOfBannersToInitSuccess?c.reportNotInInit():b(e,n)}return{setAMSettings:function(e,n){e&&"object"==typeof e&&(n?jQuery.extend(p,e):p=e)},cacheAdsFailed:function(e,n,t,i){e&&n?i():r(t)},cacheUpdate:function(e,n,t,i){0===e?r("Cache updated with zero campaigns"):n&&t&&i()},cacheTimeoutFail:function(e){r(e)},canReportAvailable:function(e,n,t,i){v(t,i)||o(e,n)},adLoadError:function(){r("Ad loaded with error")},inventoryEmpty:function(e){r(e)},engageEnd:function(e,n,t,i,r,a,o,s){e?d(r,a):(v(n,s)&&c.publishAvailabilityFalse("AllOffersVast",r),t||!p.isPreCache&&!i||(p.shouldRefreshInventory?o(r):l(r,a)))},reportBasedOnVast:m,shouldValidateVast:v,isCurrentState:a,preLoadNext:function(e,n,t){v(e,t)&&n()},allVastPromiseResolved:function(e,n){o(e,n)},notPreCacheMode:function(e){e()},preCacheMode:function(e,n,t,i,r,a,o,s){if(e&&f.trackEvent(g.campaignsAvailableFromCache),0===p.numOfBannersToInitSuccess)return c=t,l=o,d=r,u=a,v(i,s)?d():b(u,l),void c();var c,l,d,u;e?t():0===n&&m(i,r,0,0,t,n,s)},reset:function(){c.setLastResponse(i.none),p={}},adLoadedSuccessfully:function(e,n){(p.reportOnAdunitReady||p.preFetchAllVasts)&&p.isPreCache&&b(e,n)},instanceOnHold:function(){r("Instance on hold")},instanceReachCapping:function(e,n){d(e,n)},adClosedMovingToNextAd:function(e,n){v(e)&&c.publishAvailabilityFalse("AllOffersVast",n)},sessionOver:function(e,n){l(e,n)}}}},{}],103:[function(e,n,t){n.exports=function(a,e,o,s,n){var t=o.responseTypesWithReason,i=t.none,c=e.DemandUtils;function r(e){return i===e}function l(e,n,t,i,r){a.PubSub.publish(o.productType+"."+e,[c.extendCallbackParamsWithParentProductConfig(s,{numOfAdUnits:n,firstCampaignCredits:t,totalNumberCredits:i,errorMsg:r})])}function d(){n.publish("InitiatedAPICall",[c.extendCallbackParamsWithProductConfig(s,{duringInit:!1})])}return{setLastResponse:function(e){i=e},getLastResponse:function(){return i},publishAvailabilityTrue:function(e,n){d(),r(t.ready)||(l("CacheReady",e,1,n),i=t.ready)},publishAvailabilityFalse:function(e,n){d(),r(t.notReady)||("NoMoreOffers"===e||"AllOffersVast"===e&&r(t.ready))&&(l(e,0,0,0,n),i=t.notReady)},isCurrentState:r,reportNotInInit:d}}},{}],104:[function(e,n,t){n.exports=function(t,n,i,r){var a,e=!1,o=!1,s=!1,c=!1,l=!1,d=!1;function u(e){return e&&e.productType===i.productType&&(!i.demandSourceName||e.demandSourceName===i.demandSourceName)}return{init:function(){e||(t.PubSub.subscribe(r.taskManager+".InitiatedAPICall",function(e){u(e)&&t.Utils.isDefined(e.duringInit)&&(o=e.duringInit)}),t.PubSub.subscribe(r.taskManager+".AdErrorState",function(e){u(e)&&t.Utils.isDefined(e.error)&&(l=e.error)}),t.PubSub.subscribe(r.taskManager+".Engaged",function(e){u(e)&&t.Utils.isDefined(e.duringEngage)&&(s=e.duringEngage,n.log("duringEngage "+s+" on demand "+i.demandSourceName,n.LogLevels.verbose))}),t.PubSub.subscribe(r.taskManager+".CacheUpdateStatus",function(e){u(e)&&t.Utils.isDefined(e.duringCacheUpdate)&&(c=e.duringCacheUpdate)}),t.PubSub.subscribe(r.taskManager+".InitiatedTimeoutAttempt",function(e){u(e)&&t.Utils.isDefined(e.duringAPITimeoutAttempts)&&(d=e.duringAPITimeoutAttempts)}),e=!0,a=n[i.productType].getProductTM())},canEngage:function(){return!o&&!s&&a.canEngage()},canPreload:function(){return!l&&!o&&!s&&a.isConnected()},canInitCallToApi:function(){return s||o||c||!a.isConnected()?t.Utils.returnRejectedPromise():a.canInitCallToApi()},allowExternalCallToApi:function(){return!d},setConnection:function(e){return a.setConnection(e)},getStatusMsg:function(){return" duringInit:"+o+" duringEngage:"+s+" duringCacheUpdate:"+c+" error state:"+l+" during timeout attempts:"+d+a.getStatusMsg()},getStatus:function(){return{duringInit:o,duringEngage:s,duringCacheUpdate:c,adErrorState:l,timeoutAttempts:d,isConnected:a.isConnected()}},publish:function(e,n){t.PubSub.publish(r.taskManager+"."+e,n)}}}},{}],105:[function(t,e,n){e.exports=function(n,e,s,c){var l=t("./configurationValidator.js")(s,c.DebugLevels,c.errors),d=function(){var t=!0;return e.each(n.mobileSDKSettings,function(e,n){return e.match(/^deviceIds/)&&s.isDefined(n)&&n&&(t=!1),t}),t};return{parseConfiguration:function(e,n,t){var i,r,a=[],o=n.length;for(r=0;r<o;r++)s.isDefined(e[n[r]])||("applicationUserId"!==n[r]||d())&&a.push(n[r]);return 0<a.length?{didSucceed:(i={errMsg:c.errors.missing+JSON.stringify(a)},!1),errMsg:i}:l(e,t)},getDeviceApiLevel:function(){var e=n.mobileSDKSettings.deviceApiLevel;return"android"!==n.mobileSDKSettings.deviceOs||e?"ios"!==n.mobileSDKSettings.deviceOs||e||(e=n.mobileSDKSettings.deviceOSVersion.split(".")[0]):e=n.mobileSDKSettings.deviceOSVersion,e},getDeviceOsVersion:function(){var e=n.mobileSDKSettings.deviceOSVersion;return"android"===n.mobileSDKSettings.deviceOs&&(e=n.mobileSDKSettings.deviceApiLevel?n.mobileSDKSettings.deviceOSVersion:""),e}}}},{"./configurationValidator.js":111}],106:[function(e,n,t){n.exports=function(){return{adVisibleToClose:{name:"adVisibleToClose",id:-5},adClosed:{name:"adClosed",id:100},OWClosed:{name:"OWClosed",id:104},getApplicationConfigurationError:{name:"getApplicationConfigurationError",id:135},getExternalApplicationConfigurationError:{name:"getExternalApplicationConfigurationError",id:136},openUrlError:{name:"openUrlError",id:114},failedToStartStoreActivity:{name:"failedToStartStoreActivity",id:209},getUserUniqueIdFailure:{name:"getUserUniqueIdFailure",id:242},setUserUniqueIdFailure:{name:"setUserUniqueIdFailure",id:243},cdnABTestSuccess:{name:"cdnABTestSuccess",id:223},cdnABTestFail:{name:"cdnABTestFail",id:224},cdnABTestException:{name:"cdnABTestException",id:225},latencyTestSuccess:{name:"latencyTestSuccess",id:244},latencyTestFail:{name:"latencyTestFail",id:245},latencyTestException:{name:"latencyTestException",id:246},userClosedBeforeAdVisible:{name:"userClosedBeforeAdVisible",id:151},controllerException:{name:"controllerException",id:153},mismatchAdLoadError:{name:"mismatchAdLoadError",id:206},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},updateTokenFail:{name:"updateTokenFail",id:184},globalsInOldFormat:{name:"globalsInOldFormat",id:274},unauthorizedMessage:{name:"unauthorizedMessage",id:268},omidServiceFailure:{name:"omidServiceFailure",id:270}}}},{}],107:[function(n,e,t){e.exports=function(e,s){var c=n("../DemandSource/DemandEntityBuilder.js"),l=e&&e.instancesMap,d=e&&e.waterfallMap;return{createDemandEntityConfigObj:function(e,n,t,i){var r=function(e,n){var t=l&&l[s.sspProductNames[e]];if(t)for(var i=0;i<t.length;i++)if(-1!==t[i].instances.indexOf(n))return{demandGroupName:t[i].demandGroupName,isInstance:!0}}(e,n)||{},a=!0===r.isInstance?s.demandSourceType.instance:s.demandSourceType.demandSource,o={demandGroupName:r.demandGroupName,demandSourceName:n,demandType:a,isInAppBidding:t,integrationType:s.integrationType.manual,demandSourceId:i,waterfallPosition:function(e,n){var t=d&&d[s.sspProductNames[e]];if(t)return t[n]}(e,n)};return new c({productType:e},o)}}}},{"../DemandSource/DemandEntityBuilder.js":77}],108:[function(e,n,t){n.exports=function(i,r,a,o){var s="$$",c="MSFAPI";return{handler:function(e){return!!((n=e)&&"string"==typeof n.data&&0<n.data.length)&&(0===e.data.indexOf(s)?function(e){var n=e.slice(s.length);if(!n)return!1;var t=a.getParams(n);return a.isDefined(t.event)?(r.log("received event: "+t.event,r.LogLevels.verbose),i.publish("SDKController."+t.event,[t]),!0):a.isDefined(t.name)&&a.isDefined(t.parameters)?(r.log("received event: "+t.name,r.LogLevels.verbose),i.publish("SDKController."+t.name,[t.parameters]),!0):void 0}(e.data):-1!==e.data.indexOf(c)?(t=e.data,r.log("MOAT message was fired: "+t.toString(),r.LogLevels.verbose),!0):function(n){try{var e=JSON.parse(n);return a.extend(e.arguments,{callback:o(e.id)}),i.publish("SDKController."+e.method,[e.arguments]),!0}catch(e){r.log("SDKController | unable to parse message: "+JSON.stringify(n),r.LogLevels.error)}return!1}(e.data));var n,t}}}},{}],109:[function(Oi,e,n){function F(p,v,m){var i=Oi("./MessageHandler"),n=Oi("../../presenter/uiConfig.js"),r=Oi("../../components/Logger.js")(p.Utils),a=Oi("../AdUnitManager/AdUnitGlobals.js")(m),e=Oi("../AdUnitManager/LibsManager.js")(p.Utils),t=Oi("../../components/DisplayedAdManager.js"),o=Oi("../AdUnitUrl.js")(a),s=Oi("./mainConfig.js")(),c=new(Oi("../../components/ExternalConfig")),l=Oi("./instancesManager.js")(p,m),d=new(Oi("../../components/BlacklistService"))(m),b=new(Oi("../../components/FrameHelper.js"))(p,r,v,m),u=Oi("./ConfigurationHelper.js"),f=Oi("../../components/AdOrientationManager.js"),g=Oi("../../components/containers/ContainerManager.js"),h=Oi("../../components/containers/ExternalContainer.js"),S=Oi("./sessionConfig")(),y=Oi("../../components/NativeLifeCycleEventsConstants.js"),C=new(Oi("../../components/NotchFactory.js"))(v,m),A=Oi("../../components/inAppBidding/IABService.js"),D=Oi("../../components/FeatureCompatibilityService"),I,w,P,L,T,O,F,U,x,N,M,k,B,E=!1,V,R,K=p.Utils,j=p.PubSub,W=null,G=null,H=[],q=!1,J=!0,Q=!1,_="supersonicads",z="acknowledgeMessage",X=m.CB,$=m.BC,Y=m.RV,Z=m.OW,ee=m.IS,ne=m.BN,te=m.errors,ie=m.videoStates,re=m.closeButtonStates,ae=m.featureCompatibilityMap,oe=m.confirmCloseMsg,se=m.requiredDeviceInfo,ce=m.requiredAppInfo,le=m.optionalAppInfo,de={v:"3.0.50",controllerId:(new Date).getTime()+"_"+Math.random(),controllerTimeLoaded:(new Date).getTime(),mobileSDKSettings:{protocol:null,defaultProtocol:null,securedProtocol:null,domain:null,overrideDebug:!1,defaultDebug:0,debug:0,appOrientation:null,mobileCarrier:null,connectionType:null,iphoneAppOnIpadDevice:null,deviceOs:"",SDKVersion:null,deviceOSVersion:null,deviceApiLevel:null,bundleId:null,deviceOEM:null,deviceScreenScale:null,"deviceScreenSize[width]":null,"deviceScreenSize[height]":null,"deviceIds[OpenUDID]":null,"deviceIds[IFA]":null,"deviceIds[IDFV]":null,"deviceIds[SERIAL]":null,"deviceIds[AndroidID]":null,"deviceIds[IMEI]":null,"deviceIds[AID]":null,deviceWidthDP:null,deviceHeightDP:null,deviceLanguage:null,deviceModel:null,diskFreeSize:null,geoLocation:null,isLimitAdTrackingEnabled:null,unLocked:null,gpi:null,webviewType:null,allowArbitraryLoads:null,allowArbitraryLoadsInWebContent:null,mcc:null,mnc:null,appVersion:null,batteryLevel:null,androidIsVersion:null,safeAreaInsets:null},applicationSettings:{preCache:"device",applicationKey:null,applicationUserId:null,numOfCampaigns:null,campaignId:null,pageSize:null,landingId:null,page:null,applicationUserGender:null,applicationUserAgeGroup:null,applicationUserCreationDate:null,applicationUserCreationDateSignature:null,useClientSideCallbacks:null,SDKPluginType:null,disableCache:null,showDeliveryLimitationsLog:null,country:null,admin:null,placementId:null,consent:null,moatSupported:null},configMapping:{jb:function(){return de.mobileSDKSettings.unLocked}},controllerConfig:{fpf:null,destinationMap:null,isSecured:null,segmentId:null,segmentName:null,instancesMap:null,abt:null,waterfallMap:null},userType:SuperSonicGlobalConfig.userType},ue={localTime:function(){return(new Date).getTime()},timezoneOffset:function(){return(new Date).getTimezoneOffset()}},fe="mobileController.min.css",ge=SuperSonicGlobalConfig.mobileSDKSettings.isProd?"/versions/"+de.v+"/"+fe:de.v+"/"+fe,pe,ve,me,be,he,Se,ye,Ce=!1,Ae=!1,De=0,Ie=3,we,Pe={flag_none:0,flag_iap:1,flag_aia:2,flag_ugl:4,nflag_sl:8,flag_as:16},Le={flag_iap:function(){return!1},flag_aia:function(){return!1},flag_ugl:function(){return!1},nflag_sl:function(){return!1},flag_as:function(){return de.mobileSDKSettings.deviceOs===m.deviceOs.android}},Te={defaultBehavior:0,adunitResponsibility:1},Oe={close:1,nextFrame:2},Fe=n.style.iconBGConfig,Ue=m.defaultOrientation,xe={none:0,device:1,controller:2},Ne=n.style.defaultControlFrames,Me=m.blockedProductsPerApiLevel,ke=m.storeSearchKeys,Be={scrollHeight:""},Ee={BrandConnect:{},RewardedVideo:{},Interstitial:{},OfferWall:Te.defaultBehavior,Banner:Te.defaultBehavior},Ve={BrandConnect:{},RewardedVideo:{},Interstitial:{},OfferWall:re.close,Banner:re.close},Re={BrandConnect:re.close,RewardedVideo:re.close,Interstitial:re.close,OfferWall:re.close,Banner:re.close},Ke={cdns:[{cdnName:"a.akamaihd.net",assets:["https://akm.ssacdn.com/users/cdn/jsonFile.json","https://akm.ssacdn.com/users/cdn/videoFile.mp4","https://akm.ssacdn.com/users/cdn/imgFile.png"]},{cdnName:"cncn.ssacdn.com",assets:["https://cncn.ssacdn.com/users/cdn/jsonFile.json","https://cncn.ssacdn.com/users/cdn/videoFile.mp4","https://cncn.ssacdn.com/users/cdn/imgFile.png"]},{cdnName:"itcn.ssacdn.com",assets:["https://itcn.ssacdn.com/users/cdn/jsonFile.json","https://itcn.ssacdn.com/users/cdn/videoFile.mp4","https://itcn.ssacdn.com/users/cdn/imgFile.png"]}]},je=[{url:"https://pm-gateway.supersonicads.com/test",method:"GET",region:"all"},{url:"https://init.supersonicads.com/admin/healthCheck",method:"GET",region:"all"},{url:"https://ow-gateway.supersonicads.com/delivery/mobilePanel.php",method:"GET",region:"all"}],We,Ge,He=!1,qe={RewardedVideo:!1,Interstitial:!1,BrandConnect:!1},Je={},Qe=m.appConfigPath,_e=m.appExtConfigPath,ze=m.appExtConfigPathStaging,Xe=Math.floor(100*Math.random()),$e=!1,Ye=n.templates.mainDefaultTemplate,Ze=n.templates.defaultDialogBoxTemplate,en=n.templates.defaultNavigationTemplate,nn=n.templates.loaderOWTemplate,tn=n.templates.loaderOWOfferTemplate,rn=p.Eventics,an=Oi("../../modules/SDKController/EventCategories")(),on=function(e){var n=F.getDisplayedAdType(),t={productType:"UnKnown",action:"stopTiming",eventParam:{eName:an.adClosed,data:{eNameStart:an.adVisibleToClose}}};if(e&&(t.eventParam.data.generalMessage=e),n){n===m.OW&&(t.eventParam.eName=an.OWClosed),t.productType=n;var i=F.getDisplayedAdDemandName();i&&(t.demandSourceName=i),j.publish("SDKController.Analytics",[t]),j.publish("SDKController.adClosed",[{productType:t.productType,demandSourceName:t.demandSourceName}])}else j.publish("SDKController.Analytics",[t])},sn=function(e,n,t,i){var r,a=e.length,o=!0,s=[],c=null;for(r=0;r<a;r++)K.isDefined(n[e[r]])||(s.push(e[r]),o=!1);return o||(c=te.missing+JSON.stringify(s)+" in "+t,K.isDefined(i)&&i&&V.callSDKFunction(i,{errMsg:c}),V.log(c,V.LogLevels.error)),{didSucceed:o,errMsg:c}},cn=function(){v.fn.textfill2=function(e){var n,t,i=e.maxFontPixels,r=e.maxHeight,a=e.maxWidth,o=void 0!==e.parentContainer?v(e.parentContainer):null,s=v(this),c=null!==o?o.height():v(this).parent().height(),l=null!==o?o.width():v(this).parent().width();return void 0!==r&&(c=r),void 0!==a&&(l=a),s.each(function(){for(i=e.maxFontPixels;v(this).css({"font-size":i}),i-=1,e.lineHeight&&o.css({"line-height":e.lineHeight+"em"}),n=v(this).height(),t=v(this).width(),c<n||l<t&&3<i;);}),this},v.fn.textWidth=function(){var e,n=v(this).children(),t=v('<span style="display: inline-block;" />');return n.wrap(t),e=n.parent().width(),n.unwrap(),e}},ln=function(){j.subscribe(X+".initProducts",function(e,n,t){v.when(Dn(e)).then(function(){"use strict";K.isDefined(n)&&V.callSDKFunction(n),In(e)},function(e){"use strict";K.isDefined(t)&&V.callSDKFunction(t,{errMsg:e})})}),j.subscribe(X+".nativeNavigationPressed",function(){if(F.isDisplayed()){var e=F.getDisplayedAdType(),n=F.getDisplayedAdDemandName();Q||((n?Ee[e][n]:Ee[e])===Te.adunitResponsibility?xn("backButtonPressed"):Xn())}}),j.subscribe(X+".engageEnd",function(e){gn()||("forceClose"===e.action?(on(),jn(!1,!1),x.onEngageEnd()):"secondaryClose"===e.action&&(T.returnFromNavigationMode(Tn,Be,Fn),F.getDisplayedAdType()===Z&&j.publish("SDKController.AdClosed",[F.get()])))}),j.subscribe(X+".failedToStartStoreActivity",function(e){if(e){V.log("failedToStartStoreActivity | params: "+JSON.stringify(e),V.LogLevels.info);var n={};n.rvnomoreoffersreason=decodeURIComponent(e.url);var t=F.getDisplayedAdType();t&&(n.productType=t),be.trackEvent(an.failedToStartStoreActivity,{generalMessage:decodeURIComponent(e.errMsg)},n)}}),j.subscribe(X+".interceptedUrlToStore",function(e){F.isDisplayed()&&xn("interceptedUrlToStore$$intercept=true")}),j.subscribe(X+".enterBackground",function(e){V.log("entered BG",V.LogLevels.info);var n="";e&&K.isDefined(e.action)&&(n="$$action="+e.action),xn("enterBackground"+n)}),j.subscribe(X+".pageFinished",function(){xn("pageFinished")}),j.subscribe(X+".enterForeground",function(e){var n="enterForeground",t=T.getContainerState();V.log("line[1070]:entered FG, webview is "+JSON.stringify(t),V.LogLevels.info),e&&K.isDefined(e.active)&&(n+="$$active="+e.active),t.engaged&&t.opened&&de.mobileSDKSettings.deviceOs===m.deviceOs.android&&!t.standalone&&(F.isDisplayed()&&on(),jn(!1,!1)),xn(n)}),j.subscribe(X+".viewableChange",function(e){var n={name:"viewableChange"};if(e&&K.isDefined(e.isViewable)){if((Ce=e.isViewable)&&V.StoreKitService.isStoreKitVisible())return void V.log("viewableChange true but storeKit is visible - ignored",V.LogLevels.info);V.log("viewableChange to:"+e.isViewable,V.LogLevels.info),K.isDefined(e.webview)&&"main"!==e.webview||T.setContainerVisibility(e.isViewable),n.isViewable=e.isViewable,F.isDisplayed()&&Jn(),K.isDefined(e.webview)&&(n.webview=e.webview);var t=F.getDisplayedAdType();t&&(n.productType=t),e.changeReason&&(n.changeReason=e.changeReason)}xn(JSON.stringify(n)),e&&K.isDefined(e.isViewable)&&dn()}),j.subscribe(X+".deviceStatusChanged",function(e){var n=v.extend({name:"deviceStatusChanged"},e);xn(JSON.stringify(n)),p.Utils.isDefined(e.connectionType)&&(rn.updateBaseData({connectionType:e.connectionType}),J="none"!==e.connectionType&&"notReachable"!==e.connectionType)}),j.subscribe(X+".parseBandwidth",function(e){V.log(JSON.stringify(e),3)}),j.subscribe(X+".getBandwidthFailed",function(e){V.log(JSON.stringify(e),3),V.log("getBandwidth Failed",V.LogLevels.error)}),j.subscribe(X+".parseUDIA",function(e,n){V.log("retrieved UDIA"+JSON.stringify(e),V.LogLevels.verbose),K.isDefined(n)&&V.callSDKFunction(n)}),j.subscribe(X+".getUDIAFailed",function(e){V.log("Failed to retrieve UDIA",V.LogLevels.error)}),j.subscribe($+".CacheReady",function(e){V.log("Succeeded to init BC with:"+JSON.stringify(e),V.LogLevels.info),V.callSDKFunction("adUnitsReady",e)}),j.subscribe($+".NoMoreOffers",function(e){V.log("BC currently has no more offers",V.LogLevels.info),V.callSDKFunction("adUnitsReady",e)}),j.subscribe(Y+".CacheReady",function(e){V.log("Succeeded to init BC with:"+JSON.stringify(e),V.LogLevels.info),V.callSDKFunction("adUnitsReady",e)}),j.subscribe(Y+".NoMoreOffers",function(e){V.log("BC currently has no more offers",V.LogLevels.info),V.callSDKFunction("adUnitsReady",e)}),j.subscribe(Y+".AllOffersVast",function(e){V.log("RV rest of the feed is Vast",V.LogLevels.info),V.callSDKFunction("adUnitsReady",e)}),j.subscribe(ee+".CacheReady",function(e){V.log("Succeeded to init IS with:"+JSON.stringify(e),V.LogLevels.info),V.callSDKFunction("adUnitsReady",e)}),j.subscribe(ee+".NoMoreOffers",function(e){V.log("IS currently has no more offers",V.LogLevels.info),V.callSDKFunction("adUnitsReady",e)}),j.subscribe("SDKController.GetConfig",function(e){e&&e.productType&&j.publish(e.productType+".GetConfig",[e])}),j.subscribe("SDKController.GetCompletionOffers",function(e){e&&e.productType&&j.publish(e.productType+".GetCompletionOffers",[e])}),j.subscribe("SDKController.ActionClick",function(e){e&&e.productType&&j.publish(e.productType+".ActionClick",[e])}),j.subscribe("SDKController.OpenUrl",function(e){sn(["url","method"],e,"openUrl").didSucceed?(V.log("Request to open external url",V.LogLevels.info),On(e)):V.log("error calling open url with "+JSON.stringify(e),V.LogLevels.error)}),j.subscribe("SDKController.nativePixel",function(e){sn(["url"],e,"nativePixel").didSucceed?(V.log("Request to send click in native api",V.LogLevels.info),hi(e.url)):V.log("error sending safe click "+JSON.stringify(e),V.LogLevels.error)}),j.subscribe("SDKController.FirePixel",function(e){sn(["url"],e,"FirePixel").didSucceed?(V.log("Request to fire pixel from controller",V.LogLevels.info),"native"===e.type&&hi(e.url)||Si(e)):V.log("error firing pixel "+JSON.stringify(e),V.LogLevels.error)}),j.subscribe("SDKController.adEventNotification",function(e){V.log("ad notified controller with event: "+JSON.stringify(e),V.LogLevels.info),V.isLegacy(ae.postAdEventNotification)?V.log("postAdEventNotification on legacy SDK version",V.LogLevels.info):sn(["eventName","productType","dsName"],e,"adEventNotification").didSucceed&&yi(e.eventName,e.productType,e.dsName,e.extData)}),j.subscribe("SDKController.hideClose",function(e){var n=wn(V.AdUtils.getAdId(e),e);if(n){var t=T.getAdFrameByProductAndId(n);t.data("close",!1),b.isFrameDisplayed(t)&&Pn()}else V.log("line[1196]: ERROR",V.LogLevels.error)}),j.subscribe("SDKController.AdClose",function(e){e.ignoreClick?et():Xn()}),j.subscribe("SDKController.closeAdunit",function(e){on(),jn(!1)}),j.subscribe("SDKController.setBackButtonState",function(e){if(e&&e.state&&e.productType){var n="default"===e.state?Te.defaultBehavior:Te[e.state];e.demandSourceName?Ee[e.productType][e.demandSourceName]=n:Ee[e.productType]=n}}),j.subscribe("SDKController.setCloseButtonState",function(e){ei(e)}),j.subscribe("SDKController.ScrollHeight",function(e){var n,t,i;p.Utils.isDefined(e.value)&&(n=e.value,V.log("scroll height is: "+n,V.LogLevels.info),v.when($n()).then(function(e){i=F.getDisplayedAdType(),t=i&&"application"===Ue[i]&&P.isAppOrientation("portrait")?Math.max(e.height,e.width):i&&K.isDefined(i)&&"application"===Ue[i]&&P.isAppOrientation("landscape")?Math.min(e.height,e.width):e.height,n<t&&(n=t),V.log("min scroll height is: "+t+"scroll height was set to: "+n+" screen height: "+e.height,V.LogLevels.verbose),Be.scrollHeight=n,de.mobileSDKSettings.deviceOs!==m.deviceOs.android&&v("body").css("height",Be.scrollHeight)}))}),j.subscribe("SDKController.scrollTop",function(){V.log("scrollTop",V.LogLevels.verbose),setTimeout(function(){v("html,body").scrollTop(0)},1e3)}),j.subscribe("SDKController.getScreenSize",function(){v.when($n()).then(function(e){xn("screenSize$$width="+e.width+"&height="+e.height+"&orientation="+e.orientation+"&scrollTop="+e.scrollTop)})}),j.subscribe("SDKController.showNoConnectionMessage",function(){var e={productType:Z,message:"You are not connected to the internet, please connect and try again.",yes:"close",no:"OK"};V.alert(e)}),j.subscribe("SDKController.GetDeviceVolume",function(e){K.isDefined(e.callback)&&zt(e.callback)}),j.subscribe(y.serviceCallback+"."+y.AndroidEvents.onDestroy,function(e){V.log("SDKController | received event | onDestroy",V.LogLevels.verbose),gn()?V.log("SDKController | onDestroy - shouldAvoidHandleFrameClose, with params: "+JSON.stringify(e),V.LogLevels.verbose):pn()}),j.subscribe(m.CB+".unauthorizedMessage",function(e){be.trackEvent(an.unauthorizedMessage,{generalMessage:JSON.stringify(e)}),V.log("SDKController | Failed to authorize message",V.LogLevels.error)}),j.subscribe("SDKController.onOmidServiceFailure",function(e){be.trackEvent(an.omidServiceFailure,{generalMessage:e})})};function dn(){if(de.mobileSDKSettings.deviceOs===m.deviceOs.android&&20<=L.getDeviceApiLevel()){var e=n.style.backgroundColors;T.setSDKWebviewBGColor(e.black),T.setSDKWebviewBGColor(e.transparent)}}function un(){k=Oi("./videoStateHandler.js")(p.PubSub,V),B=Oi("./nativeConfigHandler.js")(p.PubSub,V)}function fn(){var e={productChance:(V.getEnv(),1),protocol:de.mobileSDKSettings.protocol?de.mobileSDKSettings.protocol:"https:",baseData:{productType:"controller"}};be=rn.createEventic(e)}function gn(){var e=ii(F.get());return e&&"function"==typeof e.shouldAvoidHandleFrameClose&&e.shouldAvoidHandleFrameClose()}function pn(){V.log("SDKController.js | handleFrameDestroyed",V.LogLevels.verbose),F.isDisplayed()&&on(m.adClosedErrorReason.unexpectedCloseActivityDestroy),jn(!1,!1),tt()}var vn=function(){v("body").append(Ye+Ze+en+nn);for(var e="",n=0;n<10;n++)e+=tn;v(".loaderOW .offers").prepend(e),at()};function mn(){j.subscribe(X+".acknowledgeMessage",function(e){V.acknowledgeMessage(e)})}function bn(e){var n=new i(p.PubSub,V,p.Utils,Nt);p.Msg.init(V,n.handler,ot),j.init();var t=Oi("../SDKInterface.js");ve=new t(de.mobileSDKSettings,m,V,e),mn()}function hn(){r.init(de.mobileSDKSettings.deviceOs,ve,de.mobileSDKSettings.debug,V.PixelTrackingService.firePixel),j.subscribe("SDKController.log",function(e){K.isDefined(e.debugLevel)&&K.isDefined(e.msg)&&("string"==typeof e.msg&&(e.msg=decodeURI(e.msg)),V.log(e.msg,e.debugLevel,e.origin))})}var Sn=function(){e.init(r,v,V.Cache),a.init(r,de.mobileSDKSettings,v,V.Cache,lt(),o,e,V.getEnv(),p,an),l.init(de.controllerConfig,r),d.init(r),F=new t(V.AdUtils),V.ProductRouter=Oi("../ProductRouter.js")(p,V,m),V.ProductRouter.initModule(),V.OfferWall.init()};function yn(){V.HTTPService.init(!V.isLegacy(ae.nativeHttpEngine)),V.OrientationService.init(!V.isLegacy(m.featureCompatibilityMap.appOrientationRestrictions),be),V.GDPRService.init(!V.isLegacy(m.featureCompatibilityMap.GDPRSupport)),Cn()&&V.RingerSwitchService.init(),V.NativeLifeCycleEventsService.init(),yt(),T=new g(p,V,de,m,v,V.AdUtils,V.ViewsManager,w,n,c,V.OrientationService,V.DemandUtils,b,V.RingerSwitchService,An(),V.AppOrientationManager,F),(O=new h(p,V,m,v,F)).initExternalContainer(),V.AndroidNomediaFileHandler.init(be),U=new A(p,V,m,be,an),N=new D(p,r,de.mobileSDKSettings.deviceOs,de.mobileSDKSettings.sdkVersion,de.controllerConfig)}function Cn(){return!V.isLegacy(m.featureCompatibilityMap.ringerSwitch)&&de.mobileSDKSettings.deviceOs===m.deviceOs.ios&&"wk"===de.mobileSDKSettings.webviewType}function An(){return{supportImmersive:V.isLegacy(ae.supportImmersive),supportOrientation:V.isLegacy(ae.supportOrientation),translucent:V.isLegacy(ae.translucent),supportAdCloseCB:!V.isLegacy(ae.adCloseCB)}}var Dn=function(e){var n=new v.Deferred;V.log("Products info received: "+JSON.stringify(e),V.LogLevels.info);var t,i,r,a=le.length,o=[];for(t=0;t<a;t++)K.isDefined(e[le[t]])||(de.applicationSettings[le[t]]=null);for(i in e)e.hasOwnProperty(i)&&i.match(/^custom/)&&o.push(i);return dt(o),(r=L.parseConfiguration(e,ce,de.applicationSettings)).didSucceed?n.resolve():n.reject(r.errMsg),n.promise()},In=function(e){v.each(e.products,function(e,n){p.hasOwnProperty(n)&&K.isFunction(p[n].init)&&p[n].init()})},wn=function(e,n){var t=null;return v.each(H,function(){return!!(V.AdUtils.getAdId(this)!=e||this.productType!==n.productType||n.demandSourceName&&this.demandSourceName!==n.demandSourceName)||(t=this,!1)}),t},Pn=function(){me.addClass("ssaOnAdUnitCloseVisible")},Ln=function(){me.removeClass("ssaOnAdUnitCloseVisible")},Tn=function(e,n,t){if(Kn()){var i=JSON.stringify({name:"dialogBoxAboutToClose",shouldResume:e});xn(i)}if(!n||!Kn())return v(".dialogBox").css("visibility","hidden"),v("#ssaDialogBoxOverlay").css("display","none"),K.isFunction(t)&&t.call(),void(b.getDisplayedAdFrame()&&xn("showFrame"));he.fadeOut(100,function(){v(".dialogBox").css("visibility","hidden"),v("#ssaDialogBoxOverlay").fadeOut(100,function(){K.isFunction(t)&&t.call(),b.getDisplayedAdFrame()&&xn("showFrame")})})},On=function(e,n){var i,r=[],t=null,a=null;function o(){var e=F.getDisplayedAdType();F.isDisplayed()&&j.publish("SDKController.AdOpened",[{productType:e}]),n&&n.call(null)}a=j.subscribe(X+".openUrlFailure",function(e){clearTimeout(i),j.clearHandlers(r),j.unsubscribe(a);var n=K.isDefined(e.errMsg)?e.errMsg:"Unknown reason for error",t=F.getDisplayedAdType()||"";be.trackEvent(an.openUrlError,{generalMessage:n},{productType:t}),V.log("SDK failed to open url",V.LogLevels.verbose)}),t=de.mobileSDKSettings.deviceOs===m.deviceOs.ios&&"webview"===e.method?j.subscribe(X+".openUrlSuccess",function(){clearTimeout(i),j.clearHandlers(r),e.controls&&T.changeToNavigationMode(Tn,me,Be,Fn),o()}):j.subscribe(X+".viewableChange",function(e){clearTimeout(i),j.clearHandlers(r),!K.isDefined(e.isViewable)||e.isViewable||de.mobileSDKSettings.deviceOs===m.deviceOs.android&&"main"!==e.webview||o()}),r.push(a),r.push(t),"storeKit"===e.method&&(de.mobileSDKSettings.deviceOs!==m.deviceOs.ios||V.isLegacy({ios:"5.17",android:"99"})?e.method="external_browser":e.method="store"),"webview"===e.method&&e.controls?de.mobileSDKSettings.deviceOs===m.deviceOs.android?V.callSDKFunction("openUrl",{url:e.url,method:"webview"},"openUrlSuccess","openUrlFailure"):V.callSDKFunction("openUrl",{url:e.url,method:e.method,controlFrames:Ne},"openUrlSuccess","openUrlFailure"):V.callSDKFunction("openUrl",{url:e.url,method:e.method,appId:e.appId,viewUniqueId:e.viewUniqueId},"openUrlSuccess","openUrlFailure"),i=setTimeout(function(){j.unsubscribe(t),"ios"===V.getApiData({deviceOs:1}).deviceOs&&parseFloat(V.getConfigurationHelper().getDeviceOsVersion())<8&&n&&n.call(null)},500)},Fn=function(){me.unbind("touchend").bind("touchend",Xn),Un(Oe.close),ye.unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault(),j.publish("SDKController.dialogBoxResume",[F.get()]),Tn(!0,!0)})},Un=function(t){Se.unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault();var n=J?t:Oe.close;switch(j.publish("SDKController.dialogBoxExit",[F.get()]),n){case Oe.nextFrame:xn("moveToNextFrame"),Tn(!1,!0);break;case Oe.close:F.isDisplayed()?(xn("confirmCloseClicked"),Tn(!1,!0)):jn(!0)}})},xn=function(n,e){if(V.log("postAdUnitEvent | should be posting to ad unit: "+n,V.LogLevels.verbose),e)V.log("postAdUnitEvent | posting to ALL ad unit frames: "+n,V.LogLevels.verbose),v.each(v(".ssaAdUnit"),function(){p.Msg.postMessage(n,"*",this.contentWindow)}),O.checkStatusOfAdView().then(function(e){e&&e.isExternalAdViewInitiated&&O.sendMessageToExternalAdView(n)});else{var t=b.getDisplayedAdFrame(),i=F.get();i&&i.settings.viewType===m.viewTypes.externalView?O.sendMessageToExternalAdView(n):i&&t?(V.log("postAdUnitEvent | posting to DISPLAYED ad unit: "+n,V.LogLevels.verbose),p.Msg.postMessage(n,"*",t[0].contentWindow)):V.log("postAdUnitEvent | can't find displayed ad: "+n,V.LogLevels.verbose)}};function Nn(){var e=F.getDisplayedAdType(),n=F.getDisplayedAdDemandName();V.log("in setDefaultBackAndCloseBehavior with product "+e+" and demand "+n,V.LogLevels.verbose),e&&(n?(Ve[e][n]=re.close,Ee[e][n]=Te.defaultBehavior):(Ve[e]=re.close,Ee[e]=Te.defaultBehavior))}function Mn(e){for(var n=v("#ssaDialogBox"),t=n[0]&&n[0].className.split(" "),i=0;i<t.length;i++){var r=t[i];r!==m.styleAccordingToProtocol.secured&&r!==m.styleAccordingToProtocol.unsecured||n.removeClass(r),r.match(/template.*/)&&n.removeClass(r)}var a=de.mobileSDKSettings.protocol===m.protocol.https?m.styleAccordingToProtocol.secured:m.styleAccordingToProtocol.unsecured;n.addClass(a),e.settings.templateid&&n.addClass("template"+e.settings.templateid)}function kn(e){e?Ln():Pn()}function Bn(){Rn()}var En=function(e,n){var t=v.Deferred(),i=b.getDisplayedAdFrame();return Un(Oe.close),T.displayContainer(e),v.when(Yn(e)).then(function(){nt(),Mn(e),x.onScreenVisible(),T.handleScreenVisible(n,i,e),t.resolve()}),t.promise()};function Vn(e){e&&(V.ImpressionsCounterService.setInstanceImpressionsCounter(e),U.updateToken(V.ImpressionsCounterService.getTokenCounters()))}var Rn=function(){var e=F.get(),n=F.getDisplayedAdType();Ae=!0,clearTimeout(we),e&&Qn(),e&&e.settings&&V.LastSeenCampaignService.setLastDisplayedAdCampaignId(e.cid,e.settings.landingId,n),Vn(e),V.log("SDKController | onAdVisible",V.LogLevels.verbose),j.publish("SDKController.AdVisible",[e]),xn("adVisible$$productType="+n)};function Kn(){return K.isVisible(he)}var jn=function(e,n){V.RingerSwitchService.isInitiated()&&V.RingerSwitchService.stopListener(),Be.scrollHeight="",v("body").css("height",Be.scrollHeight);var t=function(){Wn(n)};Kn()?Tn(!1,e,t):t()};function Wn(e){var n=function(){},t=F.get();F.reset(),e&&T.displayLoader(t.productType),V.callSDKFunction("setBackButtonState",{state:xe.controller}),e?Ln():n=Gn.bind(this,t),t?wt(t,{preloadNextInBG:!e},n):(T.unloadProductFromContainer(),n())}var Gn=function(e){V.log("SDKController | ad unit close done",V.LogLevels.verbose),e&&e.settings&&e.settings.setContainerBGColorBlack&&T.setContainerBGColorTransparent(),setTimeout(function(){V.log("SDKController | closing webview with currentAd "+JSON.stringify(e),V.LogLevels.verbose),T.hideContainer(e)},250)},Hn=function(n){v.each(H,function(e){return V.AdUtils.getAdId(this)!=n||(H.splice(e,1),!1)})},qn=function(e){var n=V.AdUtils.getAdId(e);v.each(H,function(e){return V.AdUtils.getAdId(this)==n})},Jn=function(){if(!Q){var e,n=F.getDisplayedAdType(),t=F.getDisplayedAdDemandName(),i=F.getDisplayedAdSettings();e=n===m.OW?i&&(i.OLXD||0===i.OLXD)?1e3*i.OLXD:m.closeAndBackDisabledTimerOW:m.closeAndBackDisabledTimer;var r={eventParam:{eName:an.userClosedBeforeAdVisible},action:"startTiming",productType:n,demandSourceName:t};j.publish("SDKController.Analytics",[r]),_n(),Q=!0,we=setTimeout(function(){Qn()},e)}},Qn=function(){zn(),Q=!1},_n=function(){v("#ssaNavigatorCloseButton").addClass("invisible")},zn=function(){v("#ssaNavigatorCloseButton").removeClass("invisible")},Xn=function(){T.hideLoader(),et();var e=F.getDisplayedAdType(),n=F.getDisplayedAdDemandName();if(!e)return on(),void jn(!1);if(!Ae&&!Q){var t={eventParam:{eName:an.userClosedBeforeAdVisible},action:"stopTiming",productType:e,demandSourceName:n};j.publish("SDKController.Analytics",[t])}switch(it(e)){case re.close:V.ViewsManager.waitForAllViews().then(function(){tt(),on(),jn(!1)});break;case re.confirm:Un(Oe.close),V.alert(rt(e,n));break;case re.confirmNextFrame:Un(Oe.nextFrame),V.alert(rt(e,n));break;case re.nextFrame:xn("moveToNextFrame");break;case re.ignore:}},$n=function(){var t="deviceScreenSize[width]",i="deviceScreenSize[height]",r=m.appInfo.orientation.portrait,a=m.appInfo.orientation.landscape,o=m.defaultOrientation,s=de.mobileSDKSettings[t],c=de.mobileSDKSettings[t],l=new v.Deferred;return v.when(V.OrientationService.oldGetOrientation()).then(function(e){var n=F.getDisplayedAdType();!n||o[n]!==a&&o[n]!==r||(e=o[n]),e===a&&(s=Math.max(de.mobileSDKSettings[t],de.mobileSDKSettings[i]),c=Math.min(de.mobileSDKSettings[t],de.mobileSDKSettings[i])),e===r&&(s=Math.min(de.mobileSDKSettings[t],de.mobileSDKSettings[i]),c=Math.max(de.mobileSDKSettings[t],de.mobileSDKSettings[i])),de.mobileSDKSettings.deviceOs===m.deviceOs.android&&(s/=de.mobileSDKSettings.deviceScreenScale,c/=de.mobileSDKSettings.deviceScreenScale),l.resolve({width:s,height:c,orientation:e,scrollTop:v(window).scrollTop()})}),l.promise()},Yn=function(){var n,t=new v.Deferred;return Ce?t.resolve():n=j.subscribe(X+".viewableChange",function(e){e&&K.isDefined(e.isViewable)&&e.isViewable&&(V.log("SDKController | viewableChange(screenVisible) to:"+e.isViewable,V.LogLevels.info),j.unsubscribe(n),t.resolve())}),t.promise()},Zn=function(e){V.AdUtils.getViewType(e)===m.viewTypes.externalView?(O.setAdIsLoadedInContainer(!0),O.onExternalViewLoaded(function(){F.set(e)},Bn)):T.onAdUnitLoaded(e,kn,Bn)},et=function(){V.callSDKFunction("removeCloseEventHandler",V.ViewsManager.getDisplayWebViewParams(!1))};function nt(){V.NativeLifeCycleEventsService.startNotify(y.AndroidEvents.onDestroy)}function tt(){V.NativeLifeCycleEventsService.stopNotify(y.AndroidEvents.onDestroy)}function it(e){var n=F.getDisplayedAdDemandName();if(e)return(n?Ve[e][n]:Ve[e])||Re[e]}function rt(e,n){var t=V[e];return t&&t.getConfirmCloseMsg&&t.getConfirmCloseMsg(n)||oe}var at=function(){me=v("#ssaNavigatorCloseButton"),he=v("#ssaDialogBox"),Se=v("#ssaDialogConfirmBtn"),ye=v("#ssaDialogCancelBtn"),pe=v("#ssaViewWrap"),Fn()},ot=function(){return!0},st=function(e){V.log(e,V.LogLevels.error)},ct=function(e){var n,t={};return K.isString(e)?(n=e.split(/\?(.+)/),t.name=n[0],t.parameters=e.split(/parameters=(.+)/)[1],t):null},lt=function(){return de.mobileSDKSettings.deviceOs===m.deviceOs.android?"supersonicads":"SSAPublisher"},dt=function(n){v.each(de.applicationSettings,function(e){e.match(/^custom/)&&-1===v.inArray(e,n)&&delete de.applicationSettings[e]})},ut=function(){var n={};return v.each(de.applicationSettings,function(e){e.match(/^custom/)&&(n[e]=de.applicationSettings[e])}),n},ft=function(e){var n=de.mobileSDKSettings.protocol+"//"+de.mobileSDKSettings.domain+"/l/?type={{logType}}&count={{count}}&applicationKey={{applicationKey}}&applicationUserId={{applicationUserId}}&SDKVersion={{SDKVersion}}&deviceOs={{deviceOs}}&deviceOSVersion={{deviceOSVersion}}&{{customQueryString}}",t=new Image,i={},r={logType:"",count:1,applicationKey:de.applicationSettings.applicationKey,applicationUserId:de.applicationSettings.applicationUserId,SDKVersion:de.mobileSDKSettings.SDKVersion,deviceOs:de.mobileSDKSettings.deviceOs,deviceOSVersion:de.mobileSDKSettings.deviceOSVersion,customQueryString:""};e=v.extend({"deviceIds[OpenUDID]":de.mobileSDKSettings["deviceIds[OpenUDID]"],"deviceIds[IFA]":de.mobileSDKSettings["deviceIds[IFA]"],"deviceIds[IDFV]":de.mobileSDKSettings["deviceIds[IDFV]"],"deviceIds[SERIAL]":de.mobileSDKSettings["deviceIds[SERIAL]"],"deviceIds[AndroidID]":de.mobileSDKSettings["deviceIds[AndroidID]"],"deviceIds[IMEI]":de.mobileSDKSettings["deviceIds[IMEI]"]},r,e),v.each(e,function(e,n){K.isDefined(r[e])||(i[e]=n)}),v.isEmptyObject(i)||(e.customQueryString+=K.serialize(i)),t.src=K.renderTemplate(n,e)},gt=function(){var t=0;return v.each(Le,function(e,n){n()&&(t|=Pe[e])}),t},pt=function(e){var t="";return K.isDefined(e)||(e=de),v.each(e,function(e,n){return!e.match(/^deviceIds/)||!K.isDefined(n)||null===n||(t=n,!1)}),t},vt=function(){var e=de.mobileSDKSettings;if(e.deviceScreenScale)try{var n=parseInt(e["deviceScreenSize[width]"])/(e.deviceOs!==m.deviceOs.ios?e.deviceScreenScale:1),t=parseInt(e["deviceScreenSize[height]"])/(e.deviceOs!==m.deviceOs.ios?e.deviceScreenScale:1);e.deviceHeightDP=parseInt(t),e.deviceWidthDP=parseInt(n)}catch(e){V.log("SDKController | Failed to parse screen DP",V.LogLevels.error)}},mt=function(){var n=new v.Deferred,t=!1,i=de.mobileSDKSettings;return M.checkIfAppInstallOnDevice(["com.google.market","com.android.vending"]).then(function(e){v.each(e,function(e,n){n.isInstalled&&(t=!0)}),i.gpi=t,n.resolve()},function(){i.gpi=t,n.reject("Unable to check if Google play services is installed on the device")}),n.promise()},bt=function(){var e,n,t,i=[],r=new v.Deferred;return e=j.subscribe(X+".parseDeviceStatus",function(e,n){j.clearHandlers(i),V.log("SDKController | Device status received: "+JSON.stringify(e),V.LogLevels.info),(t=L.parseConfiguration(e,se,de.mobileSDKSettings)).didSucceed?(V.callSDKFunction(n),P.init(de.controllerConfig.appOrientation,de.mobileSDKSettings),de.mobileSDKSettings.appOrientation=P.getOrientation(),de.mobileSDKSettings.displaySizeWidth=de.mobileSDKSettings["deviceScreenSize[width]"],de.mobileSDKSettings.displaySizeHeight=de.mobileSDKSettings["deviceScreenSize[height]"],vt(),(x=C.create(de.mobileSDKSettings)).onParseDeviceStatusSuccess(),si(de.mobileSDKSettings),r.resolve()):r.reject(t.errMsg)}),i.push(e),n=j.subscribe(X+".getDeviceStatusFailed",function(e){j.clearHandlers(i),st(e),r.reject(te.device)}),i.push(n),V.callSDKFunction("getDeviceStatus",{},"parseDeviceStatus","getDeviceStatusFailed"),r.promise()};function ht(e){if(e){var n=K.sortDataByDateKey(e);if(1<n.length){var t=n[1]?new Date(n[1][0]).getTime():n[0]?new Date(n[0][0]).getTime():null;isNaN(t)||(de.mobileSDKSettings.androidIsVersion=t)}}V.log("SDKController | androidIsVersion "+de.mobileSDKSettings.androidIsVersion,V.LogLevels.info)}var St=function(){var e,n,t=[],i=new v.Deferred;return V.isLegacy(ae.androidIsVersion)?i.resolve():(e=j.subscribe(X+".handleAppsInstallTimeSuccess",function(e,n){j.clearHandlers(t),ht(e),i.resolve()}),t.push(e),n=j.subscribe(X+".handleAppsInstallTimeFailed",function(e){j.clearHandlers(t),i.reject()}),t.push(n),V.callSDKFunction("getAppsInstallTime",{systemApps:"false"},"handleAppsInstallTimeSuccess","handleAppsInstallTimeFailed")),i.promise()},yt=function(){de.mobileSDKSettings.deviceOs!==m.deviceOs.ios&&V.callSDKFunction("setStoreSearchKeys",{searchKeys:ke[de.mobileSDKSettings.deviceOs]})},Ct=function(e){return K.isDefined(de[e])&&null!==de[e]||K.isDefined(de.applicationSettings[e])&&null!==de.applicationSettings[e]||K.isDefined(de.mobileSDKSettings[e])&&null!==de.mobileSDKSettings[e]||K.isDefined(de.controllerConfig[e])&&null!==de.controllerConfig[e]||K.isDefined(de.configMapping[e])&&null!==de.configMapping[e]()},At=function(e){return K.isDefined(ue[e])},Dt=function(e){var n;return K.isDefined(de[e])?n=de[e]:K.isDefined(de.applicationSettings[e])?n=de.applicationSettings[e]:K.isDefined(de.mobileSDKSettings[e])?n=de.mobileSDKSettings[e]:K.isDefined(de.controllerConfig[e])?n=de.controllerConfig[e]:K.isDefined(de.configMapping[e])?n=de.configMapping[e]():"customParam"===e&&(n=ut()),n},It=function(){var e,n,t=[],o=new v.Deferred;return e=j.subscribe(X+".parseCachedFilesMap",function(e,n){var t,i,r,a={};(r=sn(["path"],e,"parseCachedFileMap")).didSucceed?(t=decodeURIComponent(e.path).split("/"),""!==e.path?a[i=t[t.length-1]]=K.isDefined(e[i])?e[i]:e:a=e,V.log("SDKController | successfully received files map:"+JSON.stringify(e),V.LogLevels.info),delete e.path,xt(a).then(function(e){return V.log("SDKController | Finished purging cache on controller init, calling init with sorted:"+JSON.stringify(R.cachePriorityArray),V.LogLevels.verbose),V.log("SDKController | The file map after:"+JSON.stringify(e),V.LogLevels.verbose),V.Cache.init(e,R.cachePriorityArray)}).then(function(){V.log("SDKController | Cache module initiated",V.LogLevels.info),V.callSDKFunction(n),o.resolve()}).fail(function(e){e="SDKController | Cache module failed to initiated",V.log(e,V.LogLevels.error),o.reject(e)})):o.reject(r.errMsg)}),t.push(e),n=j.subscribe(X+".getCachedFilesMapFailed",function(e){V.log("SDKController | failed to receive files map:"+e,V.LogLevels.error),o.reject(te.filemap)}),t.push(n),V.callSDKFunction("getCachedFilesMap",{path:""},"parseCachedFilesMap","getCachedFilesMapFailed"),o.promise()},wt=function(n,t,i){t=t||{preloadNextInBG:!0},T.unloadAdFrame(n),Hn(V.AdUtils.getAdId(n));var r=ii(n),a=!1;p.Utils.isFunction(r.prepareAdToEngageEnd)&&r.prepareAdToEngageEnd(n).then(function(){a=r.getNextAd(!t.preloadNextInBG,n.inventoryId)}),V.log("engageEnd on controller with :"+n.engaged,V.LogLevels.verbose),p.PubSub.publish("SDKController.engageEnd",[n,function(){n.engaged&&T.unloadProductFromContainer(n);var e=!t.preloadNextInBG;p.Utils.isFunction(r.attemptToPreloadAd)&&a&&r.attemptToPreloadAd(e,n.inventoryId),i&&i(),k.getState()===ie.play&&k.handleOnEngageEnd(n)}])},Pt=function(){V.callSDKFunction("toggleUDIA",{toggle:gt()})},Lt=function(){V.callSDKFunction("getUDIA",{getByFlag:gt(),2:1},"parseUDIA","getUDIAFailed")},Tt=function(){var e=xe.controller;return de.mobileSDKSettings.deviceOs===m.deviceOs.android&&10==L.getDeviceApiLevel()&&(e=xe.device),e},Ot=function(e){return Ft(e),Ut(e),e&&e.applicationKey&&(de.applicationSettings.applicationKey=e.applicationKey),L.parseConfiguration(e,ce,de.applicationSettings)},Ft=function(e){var n,t=le.length;for(n=0;n<t;n++)K.isDefined(e[le[n]])||(de.applicationSettings[le[n]]=null)},Ut=function(e){var n,t=[];for(n in e)e.hasOwnProperty(n)&&n.match(/^custom/)&&t.push(n);dt(t)};function xt(r){var e,a,n,o=[],t=new v.Deferred,s=[],c=["temp","files","assets","libs","graphicAssets"],i=function(){var n=new v.Deferred,t=0;function i(){var e;(e=new v.Deferred,0<s.length&&v.each(s,function(e,n){R.cachePriorityArray&&R.cachePriorityArray[n]&&delete R.cachePriorityArray[n],delete r[n]}),"0"!==R.controllerVersion?(R.controllerVersion=de.v,V.setGlobalAppData(R).then(function(){e.resolve()},function(){e.reject("NewController: Save app global data failed")})):e.resolve(),e.promise()).then(function(){n.resolve(r)},function(e){n.reject(e)}),j.clearHandlers(o)}return e=j.subscribe(X+".deleteFolderSuccess",function(){V.log("NewController: A new controller version detected. Folder deleted successfully",V.LogLevels.verbose),++t>=s.length&&i()}),a=j.subscribe(X+".deleteFolderFailed",function(e){if(j.clearHandlers(o),p.Utils.isDefined(e.errCode)&&1==e.errCode)V.log("NewController: The folder requested for deletion was not found. Continue...",V.LogLevels.verbose),++t>=s.length&&i();else{j.clearHandlers(o),n.reject("NewController: Purge cache for new controller version failed.")}}),function(){var e="purgeCampaignsCache",n="purgeGlobalsCache",t=de.mobileSDKSettings;if(t.hasOwnProperty(e)&&!1===t[e])for(var i in r)-1===i.indexOf("RewardedVideo")&&-1===i.indexOf("Interstitial")||c.push(i);t.hasOwnProperty(n)&&!1===t[n]&&c.push("globals")}(),o.push(e),o.push(a),v.each(r,function(e,n){-1===c.indexOf(e)&&s.push(e)}),V.log(s+JSON.stringify(s),V.LogLevels.verbose),0<s.length?v.each(s,function(e,n){V.deleteFolder(n)}):i(),n.promise()};return function(){if(V.isLegacy(ae.userData)){V.log("NewController: Old controller version. UserData is not supported. Will purge anyway",V.LogLevels.verbose);var e=new v.Deferred;return e.resolve({controllerVersion:"0"}),e}return V.getGlobalAppData()}().then(function(e){V.log("SDKController | getGlobalAppData: "+JSON.stringify(e),V.LogLevels.verbose),n=(R=e).controllerVersion,K.isDefined(n)&&n!==de.v||!K.isDefined(n)?(V.log("NewController: A new controller version detected. Purging cache... old: "+n+"new: "+de.v,V.LogLevels.verbose),He=!0,i().then(function(e){t.resolve(e)},function(){t.reject()})):(V.log("NewController: Controller version did not change. Saved version: "+n+" Current version: "+de.v,V.LogLevels.verbose),t.resolve(r))},function(){V.log("SDKController | getGlobalAppData: failed! ",V.LogLevels.verbose),t.reject("getGlobalAppData: failed! ")}),t.promise()}function Nt(n){return function(e){xn(JSON.stringify({data:e,id:n}),!0)}}function Mt(){return de.controllerConfig&&void 0!==de.controllerConfig.abTest?de.controllerConfig.abTest:-4}function kt(e){We||V.getApplicationInfo(e).then(null,function(){var e=v.Deferred();return e.resolve(V.getConfig()),e.promise()}).always(function(e){var n=Bt(e);rn.init(n),We=!0})}function Bt(e){var n=-1;try{n=parseInt(L.getDeviceApiLevel())}catch(e){V.log("getEventicsBaseData | Error converting deviceApiLevel to Integer "+e,V.LogLevels.verbose)}return{sdkVersion:e.mobileSDKSettings.SDKVersion,controllerVersion:e.v,bfn:sonicVersionByConfig.buildNumber,bundleId:e.mobileSDKSettings.bundleId,connectionType:e.mobileSDKSettings.connectionType,applicationKey:e.applicationSettings.applicationKey,deviceId:ai(e.mobileSDKSettings),applicationUserId:e.applicationSettings.applicationUserId,deviceOs:e.mobileSDKSettings.deviceOs,deviceOsVersion:L.getDeviceOsVersion(),deviceApiLevel:n,deviceOEM:e.mobileSDKSettings.deviceOEM,deviceModel:e.mobileSDKSettings.deviceModel,appOrientation:P.getOrientation(),env:Ti.getEnv(),lat:"true"===e.mobileSDKSettings.isLimitAdTrackingEnabled,abTest:Mt(),usertype:e.userType,platformABGroup:V.getSDKDataByKey(m.abTests.controllerConfigGroup)}}function Et(){var e;switch(window.orientation){case-90:case 90:e="landscape";break;default:e="portrait"}return e}function Vt(){countViewport<10&&setTimeout(function(){addViewportFixMeta(),countViewport++,Vt()},100)}function Rt(e,n){var t,i=[],r=new v.Deferred,a=n.length;for(t=0;t<a;t++)i.push(Kt(e,n[t]));return v.when.apply(null,i).always(function(){V.deleteFolder(e),r.resolve(0)}),r.promise()}function Kt(r,a){var o=new v.Deferred,e=function(e){var n={timingValue:(new Date).getTime()-void 0,success:e},t=n.success?an.cdnABTestSuccess:an.cdnABTestFail,i={eNameStart:an.cdnABTestSuccess,timingValue:n.timingValue,rvnomoreoffersreason:r,generalMessage:a};be.trackTimingStop(t,i),o.resolve()};return be.trackTimingStart(an.cdnABTestSuccess),V.cacheAsset(r,a).then(e.bind(null,!0),e.bind(null,!1)),o.promise()}function jt(){try{var e=Ke,t=function(e,n){return Math.floor(Math.random()*(n-e+1)+e)},n=(a=c.getExtConfig()).Interstitial&&a.Interstitial.abtest&&a.Interstitial.abtest[3e3]&&a.Interstitial.abtest[3e3].cdnPercent?a.Interstitial.abtest[3e3].cdnPercent:0;if(0<n&&t(0,100)<n&&de&&de.controllerConfig&&"CN"===de.controllerConfig.country){var i=e.cdns,r=function(){if(0!==i.length){var e=t(0,i.length-1),n=i[e];i.splice(e,1),Rt(n.cdnName,n.assets).then(r)}};r()}}catch(e){V.log("_manageCdnABTest | catch: "+e,V.LogLevels.verbose),be.trackEvent(an.cdnABTestException,null,{generalMessage:e})}var a}function Wt(i){var r=new v.Deferred,e=function(e){var n=e?an.latencyTestSuccess:an.latencyTestFail,t={eNameStart:an.latencyTestSuccess,generalMessage:i.url};be.trackTimingStop(n,t),r.resolve()};return be.trackTimingStart(an.latencyTestSuccess),v.ajax({url:i.url,type:i.method?i.method:"GET",cache:!0,timeout:6e4}).then(e.bind(null,!0),e.bind(null,!1)),r.promise()}function Gt(){try{var e=je,t=function(e,n){return Math.floor(Math.random()*(n-e+1)+e)},n=(a=c.getExtConfig()).Interstitial&&a.Interstitial.abtest&&a.Interstitial.abtest[5e3]&&a.Interstitial.abtest[5e3].latencyTestPercent?a.Interstitial.abtest[5e3].latencyTestPercent:0;if(0<n&&t(0,100)<n){var i=e,r=function(){if(0!==i.length){var e=t(0,i.length-1),n=i[e];i.splice(e,1),Wt(n).then(r)}};r()}}catch(e){V.log("_manageLatencyABTest | catch: "+e,V.LogLevels.verbose),be.trackEvent(an.latencyTestException,null,{generalMessage:e})}var a;return p.Utils.returnResolvedPromise()}function Ht(){if(G&&"rejected"!==G.state())return p.Utils.returnResolvedPromise();var e="prod"===V.getEnv()?_e:ze,n=V.getBaseCdnUrl()+e;return G=v.ajax({url:n,type:"GET",dataType:"jsonp",cache:!0,jsonpCallback:"getExtConfig",timeout:2e4}).then(function(e,n,t){V.log("SDKController | MicroJob | Got Application configuration"+JSON.stringify(e)),c.setConfig(e);var i=e&&e.general&&e.general.eventProb||0;$e=Xe<i,Li(de.controllerConfig,c.getGeneralConfig())},function(e,n,t){var i="SDKController | MicroJob | Failed to receive configuration from server "+t;V.log(i,V.LogLevels.verbose),be.trackEvent(an.getExternalApplicationConfigurationError,{generalMessage:i})}).then(Gt).then(jt),p.Utils.returnResolvedPromise()}function qt(e){var n;V.isLegacy(V.featureMap.MOAT)||V.isLegacy(V.featureMap.OMID)&&((n=e)&&n.moat&&n.moat===m.moat.disabled||(V.MOATService.initWithOptions(),p.PubSub.subscribe("SDKController.MOATStartTracking",function(){V.MOATService.createAdTracker(),V.MOATService.startTracking()}),p.PubSub.subscribe("SDKController.MOATStopTracking",function(){V.MOATService.stopTracking()})))}function Jt(){if(W&&"rejected"!==W.state())return W;var e=V.apiWithCdn()+Qe,n=(V.getConfig().mobileSDKSettings.deviceOs,V.getApiData({bundleId:1,deviceOs:1}));if(n.errMsg)return p.Utils.returnRejectedPromise(n.errMsg);if(!n.bundleId)return p.Utils.returnRejectedPromise("Missing bundleId");if(!n.deviceOs)return p.Utils.returnRejectedPromise("Missing deviceOs");var i="Failed to receive configuration from server";return W=v.ajax({url:e,data:n,type:"GET",dataType:"jsonp",cache:!0,jsonpCallback:"getAppConfigReqCallBack",timeout:2e4}).then(function(e,n,t){return e&&e.errorCode?p.Utils.returnRejectedPromise(e.errorMessage||i):(V.log("Got application configuration from server"),p.Utils.returnResolvedPromise(e))},function(e,n,t){return p.Utils.returnRejectedPromise(n||i)}).then(V._parseReceivedApplicationConfiguration,function(e){return V.log("Failed to get application configuration from server - "+e,V.LogLevels.verbose),be.trackEvent(an.getApplicationConfigurationError,{generalMessage:e}),p.Utils.returnResolvedPromise()})}function Qt(e){Je=e||{},e&&e.generalConfiguration&&e.generalConfiguration.applicationKey&&!de.applicationSettings.applicationKey&&(de.applicationSettings.applicationKey=e.generalConfiguration.applicationKey),e&&e.offerWallConfiguration&&(e.offerWallConfiguration.baseServerUrl&&(de.mobileSDKSettings.baseServerUrl=e.offerWallConfiguration.baseServerUrl),e.offerWallConfiguration.serverType&&(de.mobileSDKSettings.serverType=e.offerWallConfiguration.serverType))}function _t(){return Je.offerWallConfiguration||{}}function zt(n){if(!V.isLegacy(ae.MOAT)){var e="deviceVolumeSuccess";j.subscribe(X+"."+e,function(e){V.log("Device volume received: "+(e?JSON.stringify(e):"empty"),V.LogLevels.verbose),n&&e&&n.call(null,{deviceVolume:e.deviceVolume||"0"})}),V.callSDKFunction("getDeviceVolume",{},e,e)}}function Xt(){var t,i,r=new v.Deferred;return t=j.subscribe(X+".getDebugParamsSuccess",function(e){V.log("getDebugParamsSuccess "+JSON.stringify(e),V.LogLevels.verbose);try{var n={};de.mobileSDKSettings.deviceOs===m.deviceOs.android?n=K.parseJSON(decodeURIComponent(e.SDK5DebugParams)):"object"==typeof e.SDK5DebugParams&&(n=e.SDK5DebugParams),r.resolve(n)}catch(e){V.log("getSDKDebugParams | getDebugParamsSuccess | parseJSONFailed |"+e,V.LogLevels.verbose),r.reject("failed to parse received SDK5 params")}j.clearHandlers([t,i])}),i=j.subscribe(X+".getDebugParamsFailed",function(e){var n="failed to get debug param";V.log("getSDKDebugParams | getDebugParamsFailed | "+n,V.LogLevels.verbose),r.reject(n),j.clearHandlers([t,i])}),V.callSDKFunction("getUserData",{key:"SDK5DebugParams"},"getDebugParamsSuccess","getDebugParamsFailed"),r.promise()}function $t(n){var t=new v.Deferred;return Xt().then(function(e){return p.Utils.returnResolvedPromise(v.extend(n,e))}).always(function(e){t.resolve(e||n)}),t.promise()}function Yt(e){var n="false";!0===e&&(n="true"),V.callSDKFunction("setAllowFileAccessFromFileURLs",{allowFileAccess:n})}function Zt(){return de.mobileSDKSettings&&de.mobileSDKSettings.bundleId&&-1!==m.testAppBundleIds.indexOf(de.mobileSDKSettings.bundleId)}function ei(e){V.log("setCloseButtonState params "+JSON.stringify(e),V.LogLevels.verbose),e&&e.state&&e.productType&&(e.demandSourceName?Ve[e.productType][e.demandSourceName]=re[e.state]:Ve[e.productType]=re[e.state])}function ni(){if(!Ge){var e=V.getApiData(s.deviceDataRequestObject);e&&0<Object.keys(e).length&&(Ge={os:e.deviceOs,osv:e.deviceOSVersion,apilvl:L.getDeviceApiLevel(),sdkv:e.SDKVersion,webviewType:de.mobileSDKSettings.webviewType})}return Ge||{}}function ti(){var e;return de.controllerConfig&&!0===de.controllerConfig.isSecured?e=m.protocol.https:de.mobileSDKSettings.deviceOs===m.deviceOs.android?e=m.protocol.http:de.mobileSDKSettings.deviceOs===m.deviceOs.ios&&(de.mobileSDKSettings.deviceOSVersion&&0<=K.versionCompare(de.mobileSDKSettings.deviceOSVersion,"10")?de.mobileSDKSettings.allowArbitraryLoadsInWebContent?(e=m.protocol.http,E=!0):de.mobileSDKSettings.allowArbitraryLoads?e=m.protocol.http:(e=m.protocol.https,E=!0):e=de.mobileSDKSettings.allowArbitraryLoads?m.protocol.http:m.protocol.https),e}function ii(e){var n=null;return e?(e.productType&&(n=V[e.productType],e.demandSourceName&&n&&(n=n[e.demandSourceName])),n):null}function ri(e){var n={class:"ssaAdUnit ",selector:".ssaAdUnit"};return e&&e.productType?(n.class+=e.productType+" ",n.selector+="."+e.productType,e.demandSourceName&&(n.class+=e.demandSourceName+" ",n.selector+="."+e.demandSourceName)):V.log("In getAdUnitClass with no ad",V.LogLevels.error),n}function ai(e){return e.deviceOs===m.deviceOs.ios?oi(e):e["deviceIds[AID]"]}function oi(e){return 0<=K.versionCompare(e.deviceOSVersion,"10")&&"true"===e.isLimitAdTrackingEnabled?e["deviceIds[IDFV]"]:e["deviceIds[IFA]"]}var si=function(e){e.deviceOs!==m.deviceOs.ios||-1!==K.versionCompare(e.deviceOSVersion,"10")&&"false"!==e.isLimitAdTrackingEnabled||(e["deviceIds[IDFV]"]=null)};function ci(){var e=V.Cache.getCacheByType({cacheBase:"assets"}),n=de.mobileSDKSettings.jQueryUrls;e&&-1<V.Cache.getFileIndexInCache(e.cache,n[0])?V.log("jQuery file already cache",V.LogLevels.verbose):(V.log("Start save jQuery to cache",V.LogLevels.verbose),V.cacheAsset("assets",n).then(function(){V.log("jQuery file saved successfully",V.LogLevels.verbose)},function(){V.log("jQuery file cache failed",V.LogLevels.verbose)}))}function li(){var e=de.mobileSDKSettings.controllerPathFolder+de.v,n=V.Cache.getCacheByType({cacheBase:e});n&&-1<V.Cache.getFileIndexInCache(n.cache,de.mobileSDKSettings.controllerJSUrl)?V.log("controller js file already cache",V.LogLevels.verbose):ui(e,de.mobileSDKSettings.controllerJSUrl)}function di(){var e=de.mobileSDKSettings.controllerPathFolder+de.v,n=V.Cache.getCacheByType({cacheBase:e}),t=de.mobileSDKSettings.rootPath+ge,i=de.mobileSDKSettings.cacheFolderPath+"/"+fe;n&&-1<V.Cache.getFileIndexInCache(n.cache,t)?fi(i):ui(e,t).then(function(){V.log("updateControllerCssToCache - cache css file succeeded",V.LogLevels.verbose),fi(i)},function(){V.log("updateControllerCssToCache - cache css file failed",V.LogLevels.verbose),fi(t)})}function ui(e,n){return V.log("Start saving file to cache, url: "+n,V.LogLevels.verbose),V.cacheAsset(e,n).then(function(){V.log("File saved successfully",V.LogLevels.verbose)},function(e){return V.log("File cache failed: "+e,V.LogLevels.verbose),e})}function fi(e){var n=v("head");0<v("#ssaMobileControllerCss").length||n.prepend('<link rel="stylesheet" id="ssaMobileControllerCss" type="text/css" />'),v("#ssaMobileControllerCss").attr("href",e)}function gi(){ci(),li(),di(),de.mobileSDKSettings.deviceOs===m.deviceOs.android&&V.AndroidNomediaFileHandler.updateNomediaFileToCache()}function pi(n){if(!n)return p.Utils.returnRejectedPromise("productType is empty");var e=null,t=null,i=new v.Deferred,r="getUserUniqueIdSuccess",a="getUserUniqueIdFailure";function o(){p.PubSub.unsubscribe(e),p.PubSub.unsubscribe(t)}return e=p.PubSub.subscribe(X+"."+r,function(e){e&&e.productType===n&&(V.log("succeeded to get "+n+" unique user "+JSON.stringify(e),V.LogLevels.verbose),o(),i.resolve(e))}),t=p.PubSub.subscribe(X+"."+a,function(e){e&&e.productType===n&&(V.log("failed to get "+n+" unique user",V.LogLevels.verbose),o(),be.trackEvent(an.getUserUniqueIdFailure),i.reject(e))}),V.callSDKFunction("getUserUniqueId",{productType:n},r,a),i.promise()}function vi(e){if(!e)return p.Utils.returnRejectedPromise("productType empty");var n=null,t=null,i=new v.Deferred;function r(){p.PubSub.unsubscribe(n),p.PubSub.unsubscribe(t)}return n=p.PubSub.subscribe(X+".setUserUniqueIdSuccess",function(e){V.log("succeeded to set RV unique user",V.LogLevels.verbose),r(),i.resolve()}),t=p.PubSub.subscribe(X+".setUserUniqueIdFailure",function(e){V.log("failed to set RV unique user",V.LogLevels.verbose),r(),be.trackEvent(an.setUserUniqueIdFailure),i.reject("Failed to set user unique id")}),V.callSDKFunction("setUserUniqueId",{userUniqueId:V.getFixedUserIdForCache(),productType:e},"setUserUniqueIdSuccess","setUserUniqueIdFailure"),i.promise()}function mi(n){if(!n)return p.Utils.returnRejectedPromise("productType is empty");if(de.mobileSDKSettings.deviceOs===m.deviceOs.ios)return p.Utils.returnResolvedPromise();var e=new v.Deferred;return n===Y&&V.isLegacy(V.featureMap.MDS[m.RV])&&(n=$),pi(n).then(function(e){if(!e||!e.userUniqueId)return V.log("UserId in "+n+"is empty. try to set default userId",V.LogLevels.verbose),qe[n]=!0,vi(n)}).always(function(){e.resolve()}),e.promise()}function bi(){ui(de.mobileSDKSettings.assetsCachePath,"http://local.ssacdn.com/users/staging/local/adunit/dist/assets/obfuscators/obfuscateV1.4bdd1f85.html").then(function(){V.log("downloadObfuscator - cache obfuscateV1 succeeded",V.LogLevels.verbose)},function(){V.log("downloadObfuscator - cache obfuscateV1 failed",V.LogLevels.verbose)})}function hi(e){if(!V.HTTPService.getIsNativeEngineExist())return!1;return V.HTTPService.GETRequest(e,{allowNative:!0,background:!0,retries:3}),!0}function Si(e){V.PixelTrackingService.firePixel(e)}function yi(e,n,t,i){var r,a,o=new v.Deferred,s=[];if(!K.isString(e)||!K.isString(n))return K.returnRejectedPromise("missing or corrupted params");r=j.subscribe(X+".postAdEventNotificationSuccess",function(e){V.log("postAdEventNotificationSuccess"+JSON.stringify(e),V.LogLevels.info),j.clearHandlers(s),o.resolve()}),s.push(r),a=j.subscribe(X+".postAdEventNotificationFailed",function(e){var n=e.errMsg?e.errMsg:"unknown reason";V.log("error calling postAdEventNotificationFailed: "+n,V.LogLevels.error),j.clearHandlers(s),o.reject(n)}),s.push(a);var c={eventName:e,dsName:t,productType:n,extData:i||{}};return V.log("Controller - Notifies SDK on Event: "+c.eventName+" in Product: "+c.productType,V.LogLevels.info),V.callSDKFunction("postAdEventNotification",c,"postAdEventNotificationSuccess","postAdEventNotificationFailed"),o.promise()}function Ci(e){var n,t=v("#ssaDialogBox");switch(e){case"template4":n={dialogText:{maxFontPixels:29,maxHeight:87,parentContainer:t},buttonText:{maxFontPixels:24,maxHeight:43,maxWidth:Ai(e).maxDialogBtnTextWidth,parentContainer:Se}};break;default:n={dialogText:{maxFontPixels:24,maxHeight:87,parentContainer:t},buttonText:{maxFontPixels:20,maxHeight:44,maxWidth:Ai(e).maxDialogBtnTextWidth,parentContainer:Se}}}return n}function Ai(e){return m.templateStyle[e]?m.templateStyle[e]:m.templateStyle.defaultTemplate}function Di(){var t="",e=v("#ssaDialogBox"),n=e[0]&&e[0].classList;return v.each(n,function(e,n){n.match(/template.*/)&&(t=n)}),t}function Ii(e,n,t,i){p.PubSub.publish(X+"."+e,[n,t,i])}function wi(){for(;0<nativeQueue.length;){var e=nativeQueue.shift();Ii(e.name,e.parameters,e.successCallback,e.errorCallback)}}function Pi(e){return V.SDKLimitations.getLimitData(e)}function Li(e,n){V.OMIDService.isSupported(e,n)&&V.OMIDService.init(I)}window.onerror=function(e,n,t,i,r){try{if(!r||!r.message)return;var a={url:n,lineNo:t,colNo:i,error:r&&r.message.substring(0,500)||""};We&&$e&&be.trackEvent(an.controllerException,{generalMessage:e},{rvnomoreoffersreason:JSON.stringify(a)}),V.log("onError handler. Exception:"+JSON.stringify(a),V.LogLevels.verbose)}catch(e){}};var Ti={adUnitGlobals:a,libsManager:e,adUnitUrl:o,LogLevels:{none:0,error:1,info:2,verbose:3},featureMap:ae,debugMsg:r.debugMsg,decideUrlProtocolAccordingToHTTPSCompliance:ti,instancesManager:l,blacklistService:d,jQuery:function(){return v},api:function(){return ti()+"//"+de.mobileSDKSettings.domain},apiWithCdn:function(){return de.mobileSDKSettings.protocol+"//"+de.mobileSDKSettings.serviceCdn},getBaseCdnUrl:function(){return de.mobileSDKSettings.protocol+"//"+de.mobileSDKSettings.cdn},getBaseServerUrl:function(){return de.mobileSDKSettings.baseServerUrl&&V.getEnv()===m.environment.production?de.mobileSDKSettings.protocol+"//"+de.mobileSDKSettings.baseServerUrl:""},getServerType:function(){return de.mobileSDKSettings.serverType||"new"},init:function(e,n){var t;return V=this,v=window.jQuery,M=Oi("../../components/CampaignsFilter.js")(p,V).factory("Controller"),q||(v.extend(de.mobileSDKSettings,e.mobileSDKSettings),v.extend(de.controllerConfig,e.controllerConfig),I=new(Oi("../Environment/EnvironmentManager"))({controllerVersion:de.mobileSDKSettings.controllerVersion,schema:de.mobileSDKSettings.protocol,cdnDomain:de.mobileSDKSettings.cdn,scdnDomain:de.mobileSDKSettings.scdn,environment:de.mobileSDKSettings.env,deviceOs:de.mobileSDKSettings.deviceOs,cdnService:de.mobileSDKSettings.serviceCdn,stagingCdnDomain:de.mobileSDKSettings.domain,domain:de.mobileSDKSettings.domain}),de.mobileSDKSettings.overrideDebug&&(de.mobileSDKSettings.debug=de.mobileSDKSettings.defaultDebug),V.APIConfigurations.init(),L=new u(de,v,p.Utils,m),P=V.AppOrientationManager,w=new f(r,m,P),bn(n),hn(),t=St(),fn(),cn(),vn(),Sn(),yn(),ln(),un(),qt(de.controllerConfig),V.log("Controller initiated",V.LogLevels.info),B.setNativeConfiguration(S.native[de.mobileSDKSettings.deviceOs]),v.when(mi(Y),mi(ee),mi(ne)).then(function(){v.when(bt(),It()).then(function(){a.setProtocol(ti()),window.queueValidMessages={},wi()},function(e){V.callSDKFunction("initController",{stage:"failed",errMsg:e})}).then(Ht).then(function(){v.when(V._getApplicationConfigurationFromServer(),gi(),mt(),t).always(function(){var e={gpi:de.mobileSDKSettings.gpi};de.mobileSDKSettings.androidIsVersion&&(e.androidIsVersion=de.mobileSDKSettings.androidIsVersion),U.updateToken(e)})}).fail(function(e){e?V.log(e,V.LogLevels.verbose):V.log("failed promise on get app config",V.LogLevels.verbose)})}),Pt(),Lt(),q=!0),q},getConfigurationHelper:function(){return L},initProducts:function(t){v.each(t.products,function(e,n){V[n].init(t[n])})},getAPIRequiredData:function(){var e=V.APIConfigurations.getCommonRequiredData(),n=V.getApiData(e),t=new v.Deferred;return n&&n!=={}?p.Utils.isDefined(n.errMsg)?t.reject(n.errMsg):t.resolve(n):t.reject("Failed to get required parameters"),t.promise()},getApiData:function(e){var n,t={};for(n in e)if(e.hasOwnProperty(n)){if(1===e[n]&&!Ct(n)&&!At(n)){t={errMsg:te.missing+n};break}Ct(n)?t[n]=Dt(n):"customParams"===n?v.extend(t,ut()):At(n)&&(t[n]=ue[n]())}return t},getSDKDataByKey:function(e){return Dt(e)},getCompatibilityService:function(){return N},runFunction:function(e,n,t){var i=ct(e);if(queueValidMessages[i.name])nativeCommunicator.runFunction(e,n,t);else{if("acknowledgeMessage"!==i.name||!window.shouldReportReady){var r,a=!0;r=K.parseJSON(i.parameters);try{K.isDefined(i.name)&&Ii(i.name,r,n,t)}catch(e){V.log("error running function:"+i.name+", error:"+e,V.LogLevels.error),a=!1}return a}nativeCommunicator.runFunction(e,n,t)}},callSDKFunction:function(e,n,t,i){if(K.isString(e)&&""!==e&&V){V.DemandUtils&&V.DemandUtils.isManualRewardedVideoIntegration()&&n&&(n=V.DemandUtils.setManualRewardedVideoTypeForNative(n));var r=K.isDefined(t)&&K.isString(t)?t:"",a=K.isDefined(i)&&K.isString(i)?i:"";V.postMessage({eventName:e,parameters:v.extend({success:r,fail:a},n)})}},callSDKService:function(e,n,t,i,r){t&&(t.functionName=n),V.callSDKFunction(e,t,i,r)},postMessage:function(e,n,t){e.prefix=_,K.isDefined(e.parameters)||(e.parameters={}),v.extend(e.parameters,{acknowledgeWith:K.isDefined(n)?n:z,declineWith:K.isDefined(t)?t:"errorTest"}),ve.postMessage(e)},acknowledgeMessage:function(e){ve.acknowledgeMessage(e)},getApplicationInfo:function(r,e){var t,i,a=v.Deferred(),o=function(e,n){j.clearHandlers([t,i]),e?a.resolve(de):a.reject(te.appInfo,n)};if(t=j.subscribe(X+".parseApplicationInfo",function(e,n,t){var i;K.isDefined(e.productType)&&e.productType!==r.productType&&e.demandSourceName!==r.demandSourceName?V.log("application info send for the wrong product",V.LogLevels.verbose):(V.log("App info received: "+JSON.stringify(e),V.LogLevels.info),delete e.productType,delete e.demandSourceName,(i=Ot(e)).didSucceed?(K.isDefined(n)&&V.callSDKFunction(n),o(!0)):(K.isDefined(t)&&V.callSDKFunction(t,{errMsg:i.errMsg}),o(!1,i.errMsg)))}),i=j.subscribe(X+".getApplicationInfoFailed",function(e){st(e),o(!1,"Failed retrieving application info")}),K.isDefined(e)&&e){var n=Ot(e);n.didSucceed?o(!0):(V.log(n.errMsg,V.LogLevels.error),o(!1,n.errMsg))}else V.callSDKFunction("getApplicationInfo",r,"parseApplicationInfo","getApplicationInfoFailed");return a.promise()},setCloseButtonState:ei,getEnv:function(){m.environment.production;return de.mobileSDKSettings.debug&&0<parseInt(de.mobileSDKSettings.debug)&&de.mobileSDKSettings.domain!==m.domainUrls.prod?de.mobileSDKSettings.domain===m.domainUrls.local?m.environment.develop:m.environment.stage:m.environment.production},getProtocol:function(){return de.mobileSDKSettings.protocol},isLegacy:function(e){var n=-1;try{var t="android"===de.mobileSDKSettings.deviceOs?e.android:e.ios;n=K.versionCompare(de.mobileSDKSettings.SDKVersion,t)}catch(e){V.log(e,V.LogLevels.error)}return V.log("isLegacy: "+(n<0)+" Feature: "+JSON.stringify(e),V.LogLevels.verbose),n<0},getFixedUserIdForCache:function(){return"UniqueUser"},setFixedUserIdForCache:vi,cacheAdUnitAssets:function(n,e){var t,i=e.assets,r=e.lastUpdateTime,a=i.length,o=new v.Deferred,s=[],c=0;for(0===a&&o.resolve(0),t=0;t<a;t++)s.push(V.cacheAsset(n,i[t],r));return v.when.apply(null,s).always(function(){var e=arguments;for(t in e)V.log("path: "+n+" res: "+e[t],3),e[t]&&c++;o.resolve(c)}),o.promise()},cacheAsset:function(n,t,e,i){var r,a,o,s=[],c=new v.Deferred;if(K.isString(t)&&(t=[t]),"device"===de.applicationSettings.preCache){var l,d={path:K.isString(n)?n:n.toString(),overrideExistingFile:i},u=-1,f=function(e){c.reject(e),j.clearHandlers(s)},g=function(e){++u>=t.length?f(e||"Index error in array assets url"):(l=t[u],d.file=E?K.changeUrlProtocol(l,m.protocol.https):l,V.log("trying to save file: "+d.file+". To path: "+decodeURIComponent(d.path),V.LogLevels.info),V.callSDKFunction("saveFile",d,"preCacheFileSuccess","preCacheFileFailed"))};K.isDefined(e)&&(d.lastUpdateTime=e.toString()),r=j.subscribe(X+".assetCached",function(e){if(!sn(["path","file"],e,"preCacheFileSuccess").didSucceed)return V.log("error calling assetCached "+JSON.stringify(e),V.LogLevels.error),void f("error calling assetCached");decodeURIComponent(e.path)===n&&l.match(e.file)&&(j.clearHandlers(s),V.log("successfully saved file: "+decodeURIComponent(e.path)+"/"+e.file,V.LogLevels.info),c.resolve(!0))}),a=j.subscribe(X+".assetCachedFailed",function(e){decodeURIComponent(e.path)===n&&l.match(e.file)&&(V.log("failed saved file: "+decodeURIComponent(e.path)+"/"+e.file,V.LogLevels.info),g("failed saved file"))}),o=j.subscribe(X+".preCacheFileFailed",function(e){decodeURIComponent(e.path)===n&&l.match(e.file)&&(V.log(e.errMsg+": "+decodeURIComponent(e.path)+"/"+e.file,V.LogLevels.error),g(e.errMsg))}),s.push(r),s.push(a),s.push(o),g()}else c.resolve(!0);return c.promise()},deleteFolder:function(e){K.isString(e)||e.toString(),V.callSDKFunction("deleteFolder",{path:e},"deleteFolderSuccess","deleteFolderFailed")},deleteAsset:function(n,t){var e,i,r=new v.Deferred,a=[];return K.isString(n)||n.toString(),K.isString(t)||t.toString(),e=j.subscribe(X+".deleteFileSuccess",function(e){if(!sn(["path","file"],e,"deleteFileSuccess").didSucceed)return V.log("error calling deleteFileSuccess "+JSON.stringify(e),V.LogLevels.error),r.reject("failed to delete file: "+e.file),void j.clearHandlers(a);decodeURIComponent(e.path)===n&&t.match(e.file)&&(j.clearHandlers(a),V.log("successfully deleted file: "+decodeURIComponent(e.path)+"/"+e.file,V.LogLevels.info),r.resolve())}),a.push(e),i=j.subscribe(X+".deleteFileFailed",function(e){if(!sn(["path","file"],e,"deleteFileFailed").didSucceed)return V.log("error calling deleteFileFailed "+JSON.stringify(e),V.LogLevels.error),r.reject("failed to delete file: "+e.file),void j.clearHandlers(a);decodeURIComponent(e.path)===n&&t.match(e.file)&&(j.clearHandlers(a),V.log("failed to delete file: "+e.file,V.LogLevels.info),r.reject("failed to delete file: "+e.file))}),a.push(i),V.callSDKFunction("deleteFile",{path:n,file:t},"deleteFileSuccess","deleteFileFailed"),r.promise()},setBackButtonState:function(e){var n=e?Tt():xe.none;V.callSDKFunction("setBackButtonState",{state:n})},addAdToLoadedCreatives:function(e){return!(!e||qn(e))&&(H.push(e),!0)},isContainerLoaded:function(e){return T.isContainerLoaded(e)},loadAdUnitUrl:function(e,n,t,i){T.createAndLoadAdFrame(e,n,t,i),V.addAdToLoadedCreatives(e)},displayAdUnitFrame:function(e){T.displayAdFrame(e,kn,Bn,En)},updateAdUnitUrl:function(e,n,t,i){T.updateFrameUrl(e,n,t,i),V.addAdToLoadedCreatives(e)},onAdLoaded:function(e){var n=function(){V.log("line[2787]: ad loaded mismatch",V.LogLevels.error),De<Ie&&(j.publish("SDKController.AdLoadError",[e]),De++)};if(e&&e.productType)if(wn(V.AdUtils.getAdId(e),e))Zn(e);else{var t={eventParam:{eName:an.mismatchAdLoadError},action:"fireEvent",productType:e.productType};e.demandSourceName&&(t.demandSourceName=e.demandSourceName),j.publish("SDKController.Analytics",[t]),V.log("mismatch from not being in loadedcreatives",3),n()}else n()},removeAdUnit:function(e){if(F.isAdDisplayed(e)){var n=ii(e);Nn();var t=!(!n||!K.isFunction(n.getNextAd))&&n.getNextAd(!0,e.inventoryId);jn(!1,t)}else wt(wn(V.AdUtils.getAdId(e),e),{preloadNextInBG:!0})},removeAdUnitFromExternal:function(e){Hn(V.AdUtils.getAdId(e)),p.PubSub.publish("SDKController.engageEnd",[e])},unloadFramesByProduct:function(e){var t,n=b.getDisplayedAdFrame();V.log("Removing all current "+e.productType+" frames"),n&&n.hasClass(ri(e).class)&&F.isDisplayed()&&(on(),jn()),v.each(v(ri(e).selector),function(e,n){t=v(n).data("id"),Hn(t),n.parentNode.removeChild(n)})},isRootFolder:function(e){return de.mobileSDKSettings.deviceOs===m.deviceOs.ios?"SSAPublisher"===e:"supersonicads"===e},getCurrentDisplayedAd:function(){return F.get()},setCurrentDisplayedAd:function(e){return F.set(e)},getCurrentDisplayedAdType:function(){return F.getDisplayedAdType()},isAdDisplayed:function(e){return F.isAdDisplayed(e)},getGlobalAppData:function(){var n,t,i,r,a=new v.Deferred;return n=j.subscribe(X+".parseGlobalData",function(e){if(r="string"==typeof e.ssaGlobalAppData?K.parseJSON(decodeURIComponent(e.ssaGlobalAppData)):e.ssaGlobalAppData,V.log("Full global app data is: "+JSON.stringify(r),V.LogLevels.verbose),!r)return a.reject("Invalid Global Data response"),void j.clearHandlers([n,t]);a.resolve(r),j.clearHandlers([n,t])}),t=j.subscribe(X+".getGlobalDataFailed",function(e){i=sn(["errMsg"],e,"getGlobalDataFailed").didSucceed?e.errMsg:sn(["errMsg"],e,"getGlobalDataFailed").errMsg,a.reject(i),j.clearHandlers([n,t])}),V.callSDKFunction("getUserData",{key:"ssaGlobalAppData"},"parseGlobalData","getGlobalDataFailed"),a.promise()},setCachePriorityArrayKey:function(n,t){return t?V.getGlobalAppData().then(function(e){return e.cachePriorityArray=e.cachePriorityArray||{},e.cachePriorityArray[n.cacheBase]=t,V.setGlobalAppData(e)}):p.Utils.returnResolvedPromise()},setGlobalAppData:function(e){var n,t,i,r=new v.Deferred;return n=j.subscribe(X+".setGlobalDataSuccess",function(){r.resolve(),j.clearHandlers([n,t])}),t=j.subscribe(X+".setGlobalDataFailed",function(e){i=sn(["errMsg"],e,"setGlobalDataFailed").didSucceed?e.errMsg:sn(["errMsg"],e,"setGlobalDataFailed").errMsg,r.reject(i),j.clearHandlers([n,t])}),V.callSDKFunction("setUserData",{key:"ssaGlobalAppData",value:JSON.stringify(e)},"setGlobalDataSuccess","setGlobalDataFailed"),r.promise()},getUserData:function(n,t){var i,r,a,o,s=new v.Deferred;return K.isDefined(t)&&!K.isDefined(n)?s.reject("Missing info to retrieve user data."):(i=j.subscribe(X+".parseUserData",function(e){return sn(["ssaUserData"],e,"parseUserData").didSucceed?(o="string"==typeof e.ssaUserData?K.parseJSON(decodeURIComponent(e.ssaUserData)):e.ssaUserData,V.log("Full user data is: "+JSON.stringify(o),V.LogLevels.verbose),o?(K.isDefined(n)&&(o=o[n]||{},K.isDefined(t)&&(o=o[t]||{})),V.log("Get user data response: "+JSON.stringify(o)+" for appKey "+n+" and userId "+t+" (if no specific user return all)",V.LogLevels.verbose),s.resolve(o)):s.reject("Invalid User Data response"),void j.clearHandlers([i,r])):(a=sn(["errMsg"],e,"parseUserData").errMsg,s.reject(a),void j.clearHandlers([i,r]))}),r=j.subscribe(X+".getUserDataFailed",function(e){a=sn(["errMsg"],e,"getUserDataFailed").didSucceed?e.errMsg:sn(["errMsg"],e,"getUserDataFailed").errMsg,s.reject(a),j.clearHandlers([i,r])}),V.callSDKFunction("getUserData",{key:"ssaUserData"},"parseUserData","getUserDataFailed")),s.promise()},setUserData:function(n,t,i){var r,a,o,s,c=new v.Deferred;return K.isDefined(n)&&K.isDefined(t)?v.when(V.getUserData()).then(function(e){s=e,K.isDefined(s[n])||(s[n]={}),K.isDefined(s[n][t])||(s[n][t]={}),i==={}?s[n][t]={}:v.extend(s[n][t],i),r=j.subscribe(X+".setUserDataSuccess",function(){c.resolve(),j.clearHandlers([r,a])}),a=j.subscribe(X+".setUserDataFailed",function(e){o=sn(["errMsg"],e,"setUserDataFailed").didSucceed?e.errMsg:sn(["errMsg"],e,"setUserDataFailed").errMsg,c.reject(o),j.clearHandlers([r,a])}),V.callSDKFunction("setUserData",{key:"ssaUserData",value:JSON.stringify(s)},"setUserDataSuccess","setUserDataFailed")},function(e){c.reject(e)}):c.reject("Missing info to set user data."),c.promise()},getConfig:function(){return de},getApplicationExternalConfig:function(){return c},isSupportedOsVersion:function(e){return null===L.getDeviceApiLevel().match(Me[e][de.mobileSDKSettings.deviceOs])},isLimitedDeviceModel:function(){if(!de.controllerConfig||-1===m.applicationsLimitations.indexOf(de.controllerConfig.applicationKey))return!1;var e=decodeURIComponent(de.mobileSDKSettings.deviceModel);return-1!==m.deviceLimitations.indexOf(e)},checkRequiredCallbackParams:function(e,n,t,i){return sn(e,n,t,i)},alert:function(e){var n,t=v("#ssaDialogText"),i=v(".dialogBox"),r=Di(),a=Ci(r),o=Ai(r),s=!1,c=v("#ssaDialogConfirmBtnText"),l=v("#ssaDialogCancelBtnText"),d=v("#ssaDialogBtns");xn("dialogBoxAboutToOpen"),i.removeAttr("style"),i.css("display","block"),(!Ce||e&&e.alwaysClose)&&(T.hideLoader(),Ln(),s=!0),Ce||T.displayContainer(e);var u=b.getDisplayedAdFrame();if(u&&p.Msg.postMessage("hideFrame","*",u[0].contentWindow),d.removeClass("singleBtn"),"object"==typeof e&&(ye.removeClass("hidden").removeAttr("style"),Se.removeClass("hidden").removeAttr("style"),K.isDefined(e.close)?(n=e.close,c.text(e.yes),l.text(e.no),Se.textWidth()>o.minDialogBtnWidth||ye.textWidth()>o.minDialogBtnWidth?(ye.css({width:o.maxDialogBtnWidth+"px",left:"20px"}),Se.css({width:o.maxDialogBtnWidth+"px",right:"20px"})):(ye.css({width:o.baseDialogBtnWidth+"px",left:"55px"}),Se.css({width:o.baseDialogBtnWidth+"px",right:"55px"})),(Se.textWidth()>o.maxDialogBtnTextWidth||ye.textWidth()>o.maxDialogBtnTextWidth||-1!==v.inArray(" ",e.yes)||-1!==v.inArray(" ",e.no))&&(c.textfill2(a.buttonText),a.buttonText.parentContainer=ye,l.textfill2(a.buttonText))):K.isDefined(e.message)?(n=e.message,K.isDefined(e.yes)&&c.text(e.yes),K.isDefined(e.no)&&l.text(e.no)):n=JSON.stringify(e),s)){d.addClass("singleBtn"),ye.addClass("hidden");var f=Se[0].offsetWidth/2;Se.css("margin-left",-1*f+"px")}t.text(n),t.textfill2(a.dialogText),i.css("visibility","visible");var g=v("#ssaDialogBoxOverlay");g.fadeIn(100),g.bind("click",function(e){e.preventDefault()}),he.fadeIn(300)},log:r.log,logEvent:function(e,n){ft(e)},openUrl:function(e,n){On(e,n)},postAdUnitEvent:function(e,n){xn(e,n)},initEventics:kt,getOfferWallConfiguration:_t,getFormattedDeviceData:ni,shouldExtendApiDataWithDebugData:Zt,extendApiDataWithDebugParams:$t,getSDKDebugParams:Xt,getNotchService:function(){return x},getIABService:function(){return U},setAllowFileAccessFromFileURLs:Yt,getDeviceId:function(){return ai(V.getConfig().mobileSDKSettings)},getSDKLimitationData:Pi,addExternalAdViewIdAndSetStatus:function(e){O.addExternalAdViewIdAndSetStatus(e)},getExternalContainer:function(){return O},onAdVisible:Rn,saveFileToCache:ui};return v.extend(Ti,{_getApplicationConfigurationFromServer:Jt,_parseReceivedApplicationConfiguration:Qt}),V=Ti,Ti}e.exports=function(e){var n=Oi("../../components/Constants.js"),t=Oi("../Cache.js"),i=Oi("../InterstitialFactory.js"),r=Oi("../OfferWall.js"),a=Oi("../RewardedAdFactory.js"),o=Oi("../BannerFactory.js"),s=Oi("../../components/HTTPService.js"),c=Oi("../../components/AdUtils.js"),l=Oi("../../components/DemandUtils.js"),d=Oi("../../components/SupplyUtils.js"),u=Oi("../../components/HybridService.js"),f=Oi("../../components/StoreKitService.js"),g=Oi("../../components/ViewsManager.js"),p=Oi("../../components/PixelTrackingService.js"),v=Oi("../../components/OpenURLService.js"),m=Oi("../../components/MOATService.js"),b=Oi("../../components/OMIDService.js"),h=Oi("../../components/RingerSwitchService.js"),S=Oi("../../components/OrientationService.js"),y=Oi("../../components/GDPRservice.js"),C=Oi("../../components/orientation/AppOrientationManager.js"),A=Oi("../../components/PermissionService"),D=Oi("./SDKLimitations"),I=Oi("../../components/APIConfigurations.js"),w=Oi("../../components/NativeLifeCycleEventsService.js"),P=Oi("../../components/LastSeenCampaignService"),L=Oi("../../components/AndroidNomediaFileHandler.js"),T=Oi("../../components/ImpressionsCounterService.js"),O=new F(e,window.jQuery,n);return O.Cache=new t(e,O),O.SDKLimitations=new D(O),O.OfferWall=new r(e,O),O.InterstitialFactory=new i(e,O),O.RewardedAdFactory=new a(e,O),O.BannerFactory=new o(e,O),O.HTTPService=new s(e,O),O.AdUtils=new c(e,O,window.jQuery),O.DemandUtils=new l(e,O,n),O.SupplyUtils=new d(O,n),O.HybridService=new u(e,O),O.StoreKitService=new f(e,O,n),O.ViewsManager=new g(e),O.PixelTrackingService=new p(O),O.OpenURLService=new v(O),O.MOATService=new m(e,O),O.OMIDService=new b(e,O,window.jQuery),O.RingerSwitchService=new h(e,O),O.OrientationService=new S(e,O,n),O.GDPRService=new y(e,O,n),O.AppOrientationManager=new C(e,O,n),O.PermissionService=new A(e,O),O.APIConfigurations=new I(O),O.NativeLifeCycleEventsService=new w(e,O,n),O.LastSeenCampaignService=new P(O,n),O.AndroidNomediaFileHandler=new L(O),O.ImpressionsCounterService=new T(n),O}},{"../../components/APIConfigurations.js":1,"../../components/AdOrientationManager.js":2,"../../components/AdUtils.js":3,"../../components/AndroidNomediaFileHandler.js":6,"../../components/BlacklistService":7,"../../components/CampaignsFilter.js":8,"../../components/Constants.js":9,"../../components/DemandUtils.js":10,"../../components/DisplayedAdManager.js":11,"../../components/ExternalConfig":12,"../../components/FeatureCompatibilityService":13,"../../components/FrameHelper.js":17,"../../components/GDPRservice.js":19,"../../components/HTTPService.js":20,"../../components/HybridService.js":21,"../../components/ImpressionsCounterService.js":23,"../../components/LastSeenCampaignService":25,"../../components/Logger.js":26,"../../components/MOATService.js":27,"../../components/NativeLifeCycleEventsConstants.js":30,"../../components/NativeLifeCycleEventsService.js":31,"../../components/NotchFactory.js":32,"../../components/OMIDService.js":35,"../../components/OpenURLService.js":37,"../../components/OrientationService.js":39,"../../components/PermissionService":41,"../../components/PixelTrackingService.js":43,"../../components/RingerSwitchService.js":46,"../../components/StoreKitService.js":47,"../../components/SupplyUtils.js":48,"../../components/ViewsManager.js":51,"../../components/containers/ContainerManager.js":52,"../../components/containers/ExternalContainer.js":55,"../../components/inAppBidding/IABService.js":57,"../../components/orientation/AppOrientationManager.js":58,"../../modules/SDKController/EventCategories":106,"../../presenter/uiConfig.js":129,"../AdUnitManager/AdUnitGlobals.js":68,"../AdUnitManager/LibsManager.js":71,"../AdUnitUrl.js":72,"../BannerFactory.js":75,"../Cache.js":76,"../Environment/EnvironmentManager":87,"../InterstitialFactory.js":93,"../OfferWall.js":94,"../ProductRouter.js":98,"../RewardedAdFactory.js":99,"../SDKInterface.js":117,"./ConfigurationHelper.js":105,"./MessageHandler":108,"./SDKLimitations":110,"./instancesManager.js":112,"./mainConfig.js":113,"./nativeConfigHandler.js":114,"./sessionConfig":115,"./videoStateHandler.js":116}],110:[function(e,n,t){n.exports=function(t){var i=" is not supported";return{getLimitData:function(e){var n={errMsg:"",didSucceed:!0};return t.isSupportedOsVersion(e)?t.isLimitedDeviceModel()&&(n.errMsg="Device"+i,n.didSucceed=!1):(n.errMsg="Operating system version "+t.getApiData({deviceOSVersion:1}).deviceOSVersion+i,n.didSucceed=!1),n}}}},{}],111:[function(e,n,t){n.exports=function(s,n,c){var l={v:function(e){return e.match(/^[0-9]+?[.]?[0-9]+?[.]?[0-9]+$/)},appOrientation:function(e){var n=e;return"portrait"===(n=n.toLowerCase())||"landscape"===n||"none"===n},connectionType:function(e){var n=decodeURIComponent(e);return"wifi"===(n=n.toLowerCase())||n.match(/^mobile\[.+\]$/)||"3g"===n||"none"===n},iphoneAppOnIpadDevice:function(e){var n=parseInt(e);return 0===n||1===n},deviceOs:function(e){return e&&""!==e},SDKVersion:function(e){return e&&""!==e},deviceOSVersion:function(e){return e&&""!==e},deviceApiLevel:function(e){return e&&""!==e},bundleId:function(e){return e&&""!==e},"deviceIds[OpenUDID]":function(e){return s.isDefined(e)},"deviceIds[IFA]":function(e){return s.isDefined(e)},"deviceIds[SERIAL]":function(e){return s.isDefined(e)},"deviceIds[AndroidID]":function(e){return s.isDefined(e)},"deviceIds[IMEI]":function(e){return s.isDefined(e)},"deviceIds[AID]":function(e){return s.isDefined(e)},deviceScreenScale:function(){return!0},"deviceScreenSize[width]":function(){return!0},"deviceScreenSize[height]":function(){return!0},diskFreeSize:function(e){var n=parseInt(e);return!isNaN(n)&&0<=n},showDeliveryLimitationsLog:function(){return!0},country:function(e){return e&&""!==e},debug:function(e){return s.isDefined(n[e])},disableCache:function(e){var n=parseInt(e);return 0===n||1===n},disableSession:function(e){var n=parseInt(e);return 0===n||1===n},applicationKey:function(e){return e&&""!==e},applicationUserId:function(e){return e&&""!==e},applicationUserGender:function(e){return"unknown"===e||"female"===e||"females"===e||"male"===e||"males"===e||"both"===e},applicationUserAgeGroup:function(e){var n=parseInt(e);return 0<=n&&n<=9},applicationUserCreationDate:function(e){return e.match(/^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$/)},maxVideoLength:function(e){var n=parseInt(e);return!isNaN(n)&&0<=n},itemCount:function(e){var n=parseInt(e);return!isNaN(n)&&0<n},minimumOfferCommission:function(e){var n=parseFloat(e);return!isNaN(n)&&0<=n},demoCampaigns:function(e){var n=parseInt(e);return 0===n||1===n},numOfCampaigns:function(e){var n=parseInt(e);return!isNaN(n)&&0<=n},campaignId:function(e){var n=parseInt(e);return!isNaN(n)&&0<n},pageSize:function(e){var n=parseInt(e);return!isNaN(n)&&0<=n},landingId:function(e){var n=parseInt(e);return!isNaN(n)&&0<n},page:function(e){var n=parseInt(e);return!isNaN(n)&&0<n},admin:function(e){var n=parseInt(e);return 0===n||1===n},useClientSideCallbacks:function(e){var n=e.toString();return"true"===n||"false"===n},unLocked:function(e){var n=e.toString();return"true"===n||"false"===n},isLimitAdTrackingEnabled:function(e){return s.isDefined(e)},placementId:function(e){var n=parseInt(e);return!isNaN(n)&&0<=n},allowArbitraryLoads:function(e){var n=e.toString();return"true"===n||"false"===n},allowArbitraryLoadsInWebContent:function(e){var n=e.toString();return"true"===n||"false"===n}};return function(e,n){var t,i,r,a=!0,o=null;for(t in e){if(s.isDefined(l[t])&&!1===l[t](e[t])){o=c.invalid+t,a=!1;break}r=e[i=t],n[i]=r}return{didSucceed:a,errMsg:o}}}},{}],112:[function(e,n,t){n.exports=function(l,f){var r,a=!1,g={},p={};g[f.RV]=[],g[f.IS]=[],g[f.BN]=[],p[f.RV]={},p[f.IS]={},p[f.BN]={};var v=e("../DemandSource/DemandEntityBuilder.js"),o=e("./ManualLoadInstancesBuilder.js");function m(e,n){for(var t=0;t<e.length;t++)if(e[t].demandSourceName===n)return t;return-1}function s(e,n){if(n&&0<n.length)for(var t=n,i=0;i<t.length;i++)t[i].instancesOrderList=[],t[i].instancesUninitializedList=[],g[e].push(t[i])}return{init:function(e,n){var t,i;a||(e&&((i=e.instancesMap)&&(i[f.sspProductNames.RewardedVideo]&&s(f.RV,i[f.sspProductNames.RewardedVideo]),i[f.sspProductNames.Interstitial]&&s(f.IS,i[f.sspProductNames.Interstitial]),i[f.sspProductNames.Banner]&&s(f.BN,i[f.sspProductNames.Banner])),(t=e.waterfallMap)&&(p[f.RV]=t[f.sspProductNames.RewardedVideo]||{},p[f.IS]=t[f.sspProductNames.Interstitial]||{},p[f.BN]=t[f.sspProductNames.Banner]||{})),r=new o(e,f),a=!0)},getManualLoadInstancesBuilder:function(){return r},createUninitializedDemandInstance:function(e,n,t){var i=g[e];if(i){for(var r,a=0;a<i.length;a++){var o=i[a],s=o&&o.instances;if(!s)break;var c=m(i[a].instancesUninitializedList,n);if(-1<c?r=i[a].instancesUninitializedList[c]:-1<s.indexOf(n)&&(r=new v({productType:e},{demandSourceName:n,demandGroupName:o.demandGroupName,demandType:f.demandSourceType.instance,isInAppBidding:t,integrationType:f.integrationType.automatic,waterfallPosition:p[e][n]}),i[a].instancesUninitializedList.push(r)),r)break}return r||(r=new v({productType:e},{demandSourceName:n,isInAppBidding:t,integrationType:f.integrationType.automatic,waterfallPosition:p[e][n]})),r}},initiateDemandInstance:function(e,n,t,i){var r,a,o,s,c,l,d,u=(o=new v({productType:r=e},{demandSourceName:a=n,demandGroupName:a,demandType:f.demandSourceType.demandSource,waterfallPosition:p[r][a]}),(s=g[r])&&s.forEach(function(e){var n=e.instances;if(n&&-1<n.indexOf(a)){var t=m(e.instancesUninitializedList,a);-1<t?o=e.instancesUninitializedList[t]:-1<(t=m(e.instancesOrderList,a))&&(o=e.instancesOrderList[t])}}),o);!function(e){var n=g[e.productType];if(n)for(var t=0;t<n.length;t++){var i=n[t],r=i&&i.instances;if(!r)break;var a=r.indexOf(e.demandSourceName);if(-1<a){var o=m(i.instancesUninitializedList,e.demandSourceName);if(-1<o&&i.instancesUninitializedList.splice(o,1),-1===m(i.instancesOrderList,e.demandSourceName))if(i.instanceOrderByActivation)i.instancesOrderList.push(e);else{var s=Math.min(i.instancesOrderList.length,a);i.instancesOrderList.splice(s,0,e)}break}}}(u),u.demandType===f.demandSourceType.instance?(u.initiationCallback=t,u.pendingInitiationCallback=i,c=n,l=!0,(d=g[e])&&d.forEach(function(e){var n=e.instances;if(n&&-1<n.indexOf(c)){var t=e.instanceOrderByActivation;l=e.instancesOrderList[0].demandSourceName===c&&(t||n[0]===c)}}),l?u.initiationCallback():u.pendingInitiationCallback()):t()},exhaustedDemandSource:function(e,n){if((!n.demandType||n.demandType===f.demandSourceType.instance)&&e&&n.demandGroupName&&n.demandSourceName&&g[e])for(var t=g[e],i=0;i<t.length;i++)if(t[i].demandGroupName&&t[i].demandGroupName===n.demandGroupName){var r=t[i].instances,a=t[i].instancesOrderList,o=m(a,n.demandSourceName);return void(0<=o&&(r.push(r.shift(n.demandSourceName)),a.splice(o,1),s=t[i],c=e,s&&s.instancesOrderList&&0<s.instancesOrderList.length&&l.Utils.isFunction(s.instancesOrderList[0].initiationCallback)&&(s.instancesOrderList[0].alreadyDispatchedInitiationCallback||(c===f.IS&&(s.instancesOrderList[0].alreadyDispatchedInitiationCallback=!0),s.instancesOrderList[0].initiationCallback()))))}var s,c}}}},{"../DemandSource/DemandEntityBuilder.js":77,"./ManualLoadInstancesBuilder.js":107}],113:[function(e,n,t){n.exports=function(){return{deviceDataRequestObject:{deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceApiLevel:0}}}},{}],114:[function(i,e,n){function t(e,n){var t=i("../../components/Constants.js");return e.subscribe(t.CB+".nativeConfigSuccess",function(e){n.log("nativeConfig update successfully.",n.LogLevels.error)}),e.subscribe(t.CB+".nativeConfigFailed",function(e){n.log("nativeConfig failed to update.",n.LogLevels.error)}),{setNativeConfiguration:function(e){e&&n.callSDKFunction("setNativeConfiguration",e,"nativeConfigSuccess","nativeConfigFailed")}}}var r;e.exports=function(e,n){return r||(r=new t(e,n)),r}},{"../../components/Constants.js":9}],115:[function(e,n,t){n.exports=function(){return{native:{ios:{supportViewControllerFromAdapter:!0,allowOrientationFromAppDelegate:!0}}}}},{}],116:[function(s,e,n){function t(e,n){var t=s("../../components/Constants.js"),i=t.videoStates,r=t.BC,a=i.none,o=n.isLegacy(n.featureMap.MDS[t.RV]);return r=o?t.BC:t.RV,e.subscribe("SDKController.AdStarted",function(){n.log("VideoStateHandler | AdStarted",n.LogLevels.verbose),a=i.play,n.callSDKFunction("onVideoStatusChanged",{status:"started",productType:r})}),e.subscribe("SDKController.AdPlaying",function(){n.log("VideoStateHandler | AdPlaying",n.LogLevels.verbose),a=i.play,n.callSDKFunction("onVideoStatusChanged",{status:"playing",productType:r})}),e.subscribe("SDKController.AdPaused",function(){n.log("VideoStateHandler | AdPaused",n.LogLevels.verbose),a=i.stop,n.callSDKFunction("onVideoStatusChanged",{status:"paused",productType:r})}),e.subscribe("SDKController.AdVideoEnded",function(){n.log("VideoStateHandler | AdVideoEnded",n.LogLevels.verbose),a=i.stop,n.callSDKFunction("onVideoStatusChanged",{status:"ended",productType:r})}),{handleOnEngageEnd:function(){n.log("VideoStateHandler | handleOnEngageEnd onVideoStatusChanged stopped from engaged end",n.LogLevels.verbose),a=i.none,n.callSDKFunction("onVideoStatusChanged",{status:"stopped",productType:r})},getState:function(){return a}}}var i;e.exports=function(e,n){return i||(i=new t(e,n)),i}},{"../../components/Constants.js":9}],117:[function(e,n,t){var o=e("./iOSSDKInterface.js"),s=e("./iOSSDKInterface_WK.js"),c=e("./androidSDKInterface.js");n.exports=function(e,n,t,i){"use strict";var r,a="undefined";switch(i=t.isLegacy(n.featureCompatibilityMap.messageSecurity)?null:i,e.deviceOs){case n.deviceOs.android:r=new c(i,t,a);break;case n.deviceOs.ios:r="wk"===e.webviewType?new s(a):new o(a);break;default:r=new o(a)}return r}},{"./androidSDKInterface.js":121,"./iOSSDKInterface.js":122,"./iOSSDKInterface_WK.js":123}],118:[function(p,e,n){function v(i){var r,a,o={},s={},t=!1,c=function(n,e){var t=null;o=r.Utils,(s=r.PubSub).init(),o.isDefined(n.mobileSDKSettings)&&(t=(a=r.SDKController).init(n,e)),i.when(t).then(function(){n.products&&i.each(n.products,function(e){o.isDefined(e.init)&&e.init(n[e])})},function(){console.log("Failed to initiate controller")})},e={init:function(e,n){return r=this,c(e,n),t=!0},log:function(e,n){a&&a.log&&a.log(e,n||a.LogLevels.error)}};return e}e.exports=function(e,n,t,i){var r=p("../components/Utils.js"),a=p("../components/PubSub.js"),o=p("../components/Msg.js"),s=p("./AdAssets.js"),c=p("./VastUtils.js"),l=n.Eventics,d=new v(e),u={};d.Utils=new r(d,n,t,i),d.PubSub=new a(d),d.Msg=new o,d.AdAssets=new s,d.VastUtils=new c(d.AdAssets);var f,g=["KuduEventicsProvider"];return f=n.productionDebug||n.SuperSonicGlobalConfig&&n.SuperSonicGlobalConfig.mobileSDKSettings&&"www.supersonicads.com"!==n.SuperSonicGlobalConfig.mobileSDKSettings.domain?(g.push("QAEventicsProvider"),1):Math.random(),n.SuperSonicGlobalConfig&&n.SuperSonicGlobalConfig.mobileSDKSettings&&n.SuperSonicGlobalConfig.mobileSDKSettings.protocol&&(u.isSecured="https:"===n.SuperSonicGlobalConfig.mobileSDKSettings.protocol),d.Eventics=l(f),d.Eventics.setProvidersHandlers(g),d.Eventics.setProvidersConfig(u),d}},{"../components/Msg.js":28,"../components/PubSub.js":44,"../components/Utils.js":49,"./AdAssets.js":65,"./VastUtils.js":119}],119:[function(e,n,t){n.exports=function(n){function t(e){if(e)return!e.controllerSpace||e.controllerSpace.viewCount}function i(e,n){return e&&(e.controllerSpace||(e.controllerSpace={}),e.controllerSpace.viewCount=n),e}function r(e){return!!e&&(0<n.extractVastSource(e).length||e.ext&&e.ext.videoData&&!0===e.ext.videoData.isVast)}return{getVastViewCount:t,setVastViewCount:i,setMaxVastCount:function(e){e&&r(e)&&"number"==typeof e.ext.vastExhaustIndex&&0<e.ext.vastExhaustIndex&&i(e,e.ext.vastExhaustIndex)},isVastCampaign:r,isThereVastCampaign:function(e){if(!e||!jQuery.isArray(e))return!1;for(var n=!1,t=0;t<e.length;t++)if(r(e[t])){n=!0;break}return n},areAllCampaignTypesAreVast:function(e){if(!e||!jQuery.isArray(e)||0===e.length)return!1;for(var n=!0,t=0;t<e.length;t++)if(!r(e[t])){n=!1;break}return n},incrementVastViewCount:function(e){return e&&r(e)?(e.controllerSpace||(e.controllerSpace={}),e.controllerSpace.viewCount=e.controllerSpace.viewCount?e.controllerSpace.viewCount+1:1,e.controllerSpace.viewCount):-1},isVastCanPlayAgain:function(e){return!!e&&r(e)&&e.ext.vastExhaustIndex&&t(e)<e.ext.vastExhaustIndex},getVastViewCountForEvent:function(e){return"number"==typeof e?e:-1}}}},{}],120:[function(r,e,n){(function(e){"use strict";var n=r("./SonicCore.js"),t=r("./SDKController/SDKController.js");var i=e.SonicCore=e.SSA_CORE=new n(e.jQuery,e,document,"undefined");i.SDKController=new t(i,"undefined"),"function"==typeof sonicAsyncInit&&sonicAsyncInit()})(window)},{"./SDKController/SDKController.js":109,"./SonicCore.js":118}],121:[function(e,n,t){function i(i,t,n){function r(e,n){var t=i.hashMessage(e,n);Android.messageHandler(e,JSON.stringify(n),t)}function a(e,n){Android[e](JSON.stringify(n))}function o(e,n){return void 0!==e&&e[n]}var s={postMessage:function(n,e){if(o(window.Android,i?"messageHandler":n))try{i?r(n,e):a(n,e)}catch(e){t.log("Error running function "+n+" error:"+JSON.stringify(e),t.LogLevels.error)}else t.log("Error calling SDK function "+n,t.LogLevels.error)}},e={postMessage:function(e){typeof e.eventName!==n&&typeof e.prefix!==n&&typeof e.parameters!==n&&("function"==typeof s[e.eventName]?s[e.eventName](e.parameters):s.postMessage(e.eventName,e.parameters))},acknowledgeMessage:function(){return!0}};return e}n.exports=i},{}],122:[function(e,n,t){function i(n){var i=function(e,n,t){var i,r=e+"://"+n+"?";jQuery.each(t,function(e,n){"object"==typeof n&&(t[e]=JSON.stringify(n))}),i=r+jQuery.param(t),a(i)},t=function(e){var n=document.createElement("IFRAME");n.setAttribute("src",e),document.documentElement.appendChild(n),n.parentNode.removeChild(n),n=null},a=function(e){0===o.length?(o.push("1"),t(e)):o.push(e)},r={postMessage:function(e,n,t){i(e,n,t)}},o=[],e={postMessage:function(e){typeof e.eventName!==n&&typeof e.prefix!==n&&typeof e.parameters!==n&&("function"==typeof r[e.eventName]?r[e.eventName](e.parameters):r.postMessage(e.prefix,e.eventName,e.parameters))},acknowledgeMessage:function(){if(0!==o.length){var e=o.shift();"1"===e&&0!==o.length&&(e=o.shift()),void 0!==e&&"1"!==e&&t(e)}}};return e}n.exports=i},{}],123:[function(e,n,t){function i(n){var i=function(e,n,t){var i,r=e+"://"+n+"?";jQuery.each(t,function(e,n){"object"==typeof n&&(t[e]=JSON.stringify(n))}),i=r+jQuery.param(t),a(i)},t=function(e){void 0!==window.webkit.messageHandlers&&void 0!==window.webkit.messageHandlers.supersonicMainMsgHandler&&window.webkit.messageHandlers.supersonicMainMsgHandler.postMessage(e)},a=function(e){0===o.length?(o.push("1"),t(e)):o.push(e)},r={postMessage:function(e,n,t){i(e,n,t)}},o=[],e={postMessage:function(e){typeof e.eventName!==n&&typeof e.prefix!==n&&typeof e.parameters!==n&&("function"==typeof r[e.eventName]?r[e.eventName](e.parameters):r.postMessage(e.prefix,e.eventName,e.parameters))},acknowledgeMessage:function(){if(0!==o.length){var e=o.shift();"1"===e&&0!==o.length&&(e=o.shift()),void 0!==e&&"1"!==e&&t(e)}}};return e}n.exports=i},{}],124:[function(e,n,t){n.exports=function(t,n,i,r){var e=!1,a=!1,o=!1,s=!0,c=r.CB+".enterBackground",l=r.CB+".enterForeground",d=r.CB+".deviceStatusChanged",u="prdTaskManager | ";return{init:function(){e||(t.PubSub.subscribe(r.taskManager+".Engaged",function(e){!t.Utils.isDefined(e.duringEngage)||e.productType!==i&&e.productType!==r.BC||(a=e.duringEngage,n.log(u+"duringEngage "+a))}),t.PubSub.subscribe(c,function(){n.log(u+c),o=!0}),t.PubSub.subscribe(l,function(){n.log(u+l),o=!1}),t.PubSub.subscribe(d,function(e){t.Utils.isDefined(e.connectionType)&&(s="none"!==e.connectionType&&"notReachable"!==e.connectionType)}),e=!0)},canEngage:function(){return!a&&s},isConnected:function(){return s},setConnection:function(e){s=e},canInitCallToApi:function(){var e=new jQuery.Deferred;return o?t.PubSub.subscribeOnce(l,function(){e.resolve()}):e.resolve(),e.promise()},getStatusMsg:function(){return"product TM - duringEngage:"+a+" appInBackground:"+o+" isConnected:"+s},getStatus:function(){return{duringEngage:a,appInBackground:o,isConnected:s}},publish:function(e,n){t.PubSub.publish(r.taskManager+"."+e,n)}}}},{}],125:[function(e,n,t){n.exports=function(n,t,i){var r="ios"===t.getConfig().mobileSDKSettings.deviceOs&&i&&"M"===i.integrationType;return r&&(t.log("PATCH | LoadAfterLoad | create listener for instance: "+JSON.stringify(i)),n.PubSub.subscribe("freeSDK5StateToAllowLoadAfterLoad",function(e){var n;n=e,t.log("PATCH | LoadAfterLoad | subscribe called for: "+JSON.stringify(i)+" , with params:"+JSON.stringify(n)),n&&i&&i.demandGroupName===n.demandGroupName&&i.productType===n.productType&&i.demandSourceName!==n.demandSourceName&&(t.log("PATCH | LoadAfterLoad | perform callSDKFunction with: "+JSON.stringify(e)),t.callSDKFunction("loadInterstitialFail",{demandSourceName:i.demandSourceName}))})),{onShowSuccess:function(e){r&&n.PubSub.publish("freeSDK5StateToAllowLoadAfterLoad",[{productType:e.productType,demandGroupName:e.demandGroupName,demandSourceName:e.demandSourceName}])}}}},{}],126:[function(e,n,t){n.exports=function(n,t){var i=e("../constants/SDKFeatureNames");return{shouldBlock:function(e){return(!t||!t.isFeatureSupportedInNativeSDK(i.storeKitDismissVCOnFinishCallback))&&0<=n.versionCompare(e,"13.2")}}}},{"../constants/SDKFeatureNames":63}],127:[function(e,n,t){n.exports=function(e,t,r){var n=0;function i(){var e=decodeURIComponent(t.deviceModel);return-1!==r.iphoneXDeviceModels.indexOf(e)}function a(){var e=t.deviceWidthDP,n=t.deviceHeightDP;return i()&&function(e,n){var t=r.iphoneXDeviceResolution;for(var i in t)if(t.hasOwnProperty(i)&&t[i].width&&t[i].height&&(e===t[i].width&&n===t[i].height||e===t[i].height&&n===t[i].width))return!0;return!1}(e,n)}function o(){var e=document.getElementById("viewport"),n="viewport-fit=cover";-1===e.content.indexOf(n)&&(e.content+=","+n)}return{hasNotch:i,onParseDeviceStatusSuccess:function(){a()&&window.addEventListener("resize",function(){(0===n||10<=n)&&(n=0,function e(){n<10&&setTimeout(function(){o(),n++,e()},100)}())})},onEngageEnd:function(){a()&&(n=0)},onSetConfig:function(e){return i()&&(n=e).settings&&n.settings.standaloneView;var n},onScreenVisible:function(){a()&&!e("body").hasClass("iphoneXAdjustPadding")&&(e("body").addClass("iphoneXAdjustPadding"),o())},className:"PatchesIphoneX"}}},{}],128:[function(e,n,t){n.exports=function(n){var t={android:/^\b[1][0-9]\b|\b[2][0]\b/,ios:/^[8|9]/},i=["6abeab6d","6863f09d","499b4845","4cbeec05","70fc4915"].concat(["6c982dc5","6c97f43d"]);return{shouldFail:function(e){return!(!e.controllerConfig||-1===i.indexOf(e.controllerConfig.applicationKey))&&null!==n.getDeviceApiLevel().match(t[e.mobileSDKSettings.deviceOs])}}}},{}],129:[function(e,n,t){n.exports={templates:{mainDefaultTemplate:'<div id="ssaLoaderWrap" class="hidden">                <div id="spin" class="container">                    <div class="spinner">                        <div class="bar1"></div>                        <div class="bar2"></div>                        <div class="bar3"></div>                        <div class="bar4"></div>                        <div class="bar5"></div>                        <div class="bar6"></div>                        <div class="bar7"></div>                        <div class="bar8"></div>                        <div class="bar9"></div>                        <div class="bar10"></div>                        <div class="bar11"></div>                        <div class="bar12"></div>                    </div>                </div>            </div>',defaultDialogBoxTemplate:'<div id="ssaDialogBoxOverlay"></div>            <div id="ssaDialogBox" class="dialogBox">            <div id="ssaDialogBoxTextContainer">            <div><p id="ssaDialogText">Are you sure you want to quit the offer?</p></div>            </div>        <footer id="ssaDialogBtns">            <a id="ssaDialogCancelBtn" class="dialogBtn"><span id="ssaDialogCancelBtnText">Cancel</span></a>            <a id="ssaDialogConfirmBtn"" class="dialogBtn"><span id="ssaDialogConfirmBtnText">OK</span></a>        </footer>        </div>',defaultNavigationTemplate:'            <div id="ssaNavigator" class="defaultNavigation">                <ul class="ssaList">                    <li><div data-edge="top|left" id="ssaNavigatorBackButton" class="ssaNavigationBtn ssaControllerButton ssaBackButton"><div class="innerWrapper"></div></div></li>                    <li><div data-edge="top|right" id="ssaNavigatorCloseButton" class="ssaNavigationBtn ssaControllerButton ssaCloseButton"><div class="innerWrapper"></div></div></li>                </ul>            </div>',loaderOWTemplate:'<div class="loaderOW hidden">        <div class="header">        </div>        <div class="progressbarWrap">            <div class="progressbar"></div>        </div>        <div class="offers">        <div class="shine"></div>        </div>    </div>',loaderOWOfferTemplate:'<div class="offer">        <div class="offerWrap">        <div class="offerImg"></div>        <div class="offerDetails">        <div>        <span class="offerText">Loading Info...</span>        </div>        <div class="offerEarn">        <div class="badge"></div>        <div class="callToAction">Loading...</div>        </div>        </div>        <div class="offerBtn"></div>        </div>        </div>'},style:{forceCloseProperties:{androidNeutral:{width:25,height:25,position:"top-right"},androidInterstitial:{width:0,height:0,position:"top-right"},androidNavigation:{width:25,height:25,position:"top-right"},iosNeutral:{width:24,height:24,position:"top-right"},iosNavigation:{width:50,height:50,position:"top-right"},disable:{width:0,height:0,position:"top-right"}},backgroundColors:{transparent:"transparent",black:"#000000",darkGrey:"#1A1A1A",semiTransparent:"rgba(0,0,0,0.7)"},iconBGConfig:{},defaultControlFrames:[{width:28,height:28,position:"top-right"},{width:30,height:30,position:"top-left"}]},settings:{}}},{}]},{},[120]);